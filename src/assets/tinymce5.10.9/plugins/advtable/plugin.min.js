/*!
 * Tiny Advanced Tables plugin
 *
 * Copyright 2010-2021 Tiny Technologies, Inc. All rights reserved.
 *
 * Version: 1.2.0-26
 */
!function(){"use strict";function n(r){return function(n){return t=typeof(e=n),(null===e?"null":"object"==t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t)===r;var e,t}}function e(e){return function(n){return typeof n===e}}function t(e){return function(n){return e===n}}function s(n){return!(null==n)}function L(){}function M(n){return function(){return n}}function j(n){return n}function r(n,e){return n===e}var I=n("string"),z=n("object"),P=n("array"),B=t(null),o=e("boolean"),u=t(void 0),_=e("function"),F=e("number");function i(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}function c(){return a}var l=M(!1),V=M(!0),a={fold:function(n,e){return n()},isSome:l,isNone:V,getOr:j,getOrThunk:f,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:M(null),getOrUndefined:M(void 0),or:j,orThunk:f,map:c,each:L,bind:c,exists:l,forall:V,filter:function(){return a},toArray:function(){return[]},toString:M("none()")};function f(n){return n()}function p(n,e){return-1<A.call(n,e)}function q(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return!0;return!1}function h(n,e){for(var t=[],r=0;r<n;r++)t.push(e(r));return t}function H(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r}function G(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)}function U(n,e){for(var t=[],r=[],o=0,u=n.length;o<u;o++){var i=n[o];(e(i,o)?t:r).push(i)}return{pass:t,fail:r}}function b(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t}function X(n,e){if(0===n.length)return[];for(var t=e(n[0]),r=[],o=[],u=0,i=n.length;u<i;u++){var c=n[u],l=e(c);l!==t&&(r.push(o),o=[]),t=l,o.push(c)}return 0!==o.length&&r.push(o),r}function m(n,t,r){return function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(n,function(n,e){r=t(r,n,e)}),r}function $(n,t,r){return G(n,function(n,e){r=t(r,n,e)}),r}function w(n,e){return function(n,e,t){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(e(u,r))return nn.some(u);if(t(u,r))break}return nn.none()}(n,e,l)}function K(n,e){return function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!P(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);D.apply(e,n[t])}return e}(H(n,e))}function y(n,e){for(var t=0,r=n.length;t<r;++t)if(!0!==e(n[t],t))return!1;return!0}function d(n){return[n]}function Q(n,e){var t=O.call(n,0);return t.sort(e),t}function v(n,e){return 0<=e&&e<n.length?nn.some(n[e]):nn.none()}function Y(n){return v(n,0)}function J(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return nn.none()}function g(n,e){for(var t=k(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}}function Z(n,t){var r=[];return g(n,function(n,e){r.push(t(n,e))}),r}function x(n){return Z(n,j)}function C(n){return k(n).length}function S(n,e){return N(n,e)?nn.from(n[e]):nn.none()}function T(n){for(var e in n)if(E.call(n,e))return;return 1}var R=function(t){function n(){return o}function e(n){return n(t)}var r=M(t),o={fold:function(n,e){return e(t)},isSome:V,isNone:l,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return R(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?o:a},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},nn={some:R,none:c,from:function(n){return null==n?a:R(n)}},O=Array.prototype.slice,A=Array.prototype.indexOf,D=Array.prototype.push,k=Object.keys,E=Object.hasOwnProperty,N=function(n,e){return E.call(n,e)};"undefined"!=typeof window||Function("return this;")();function en(n){return n.dom.nodeName.toLowerCase()}function W(n){return n.dom.nodeType}function tn(e){return function(n){return W(n)===e}}function rn(n){return 8===W(n)||"#comment"===en(n)}function on(e){return function(n){return wn(n)&&en(n)===e}}function un(n,e,t){if(!(I(t)||o(t)||F(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}function cn(n,e,t){un(n.dom,e,t)}function ln(n,e){var t=n.dom;g(e,function(n,e){un(t,e,n)})}function an(n,e){var t=n.dom.getAttribute(e);return null===t?void 0:t}function fn(n,e){return nn.from(an(n,e))}function sn(n,e){n.dom.removeAttribute(e)}function mn(n){return $(n.dom.attributes,function(n,e){return n[e.name]=e.value,n},{})}function dn(n,e){var t=an(n,e);return void 0===t||""===t?[]:t.split(" ")}function vn(n){return void 0!==n.dom.classList}function gn(n){return dn(n,"class")}function pn(n,e){return o=e,u=dn(t=n,r="class").concat([o]),cn(t,r,u.join(" ")),1;var t,r,o,u}function hn(n,e){vn(n)?n.dom.classList.add(e):pn(n,e)}function bn(n){return(vn(n)?function(n){for(var e=n.dom.classList,t=new Array(e.length),r=0;r<e.length;r++){var o=e.item(r);null!==o&&(t[r]=o)}return t}:gn)(n)}var wn=tn(1),yn=tn(3),xn=tn(9),Cn=tn(11),Sn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},Tn={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Sn(t.childNodes[0])},fromTag:function(n,e){var t=(e||document).createElement(n);return Sn(t)},fromText:function(n,e){var t=(e||document).createTextNode(n);return Sn(t)},fromDom:Sn,fromPoint:function(n,e,t){return nn.from(n.dom.elementFromPoint(e,t)).map(Sn)}},Rn=function(){return(Rn=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function On(n,e,t){if(t||2===arguments.length)for(var r,o=0,u=e.length;o<u;o++)!r&&o in e||((r=r||Array.prototype.slice.call(e,0,o))[o]=e[o]);return n.concat(r||e)}function An(t){var r,o=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return o||(o=!0,r=t.apply(null,n)),r}}function Dn(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);return t?te(r(1),r(2)):{major:0,minor:0};function r(n){return Number(e.replace(t,"$"+n))}}function kn(n,e){var t=String(e).toLowerCase();return w(n,function(n){return n.search(t)})}function En(n,e){return-1!==n.indexOf(e)}function Nn(n){return!(0<n.length)}function Wn(e){return function(n){return En(n,e)}}function Ln(n){return window.matchMedia(n).matches}function Mn(n,e){var t=n.dom;if(1!==t.nodeType)return!1;var r=t;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function jn(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount}function In(n,e){return n.dom===e.dom}function zn(n){return Tn.fromDom(n.dom.ownerDocument)}function Pn(n){return xn(n)?n:zn(n)}function Bn(n){return nn.from(n.dom.parentNode).map(Tn.fromDom)}function _n(n,e){for(var t=_(e)?e:l,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,i=Tn.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}function Fn(n){return nn.from(n.dom.previousSibling).map(Tn.fromDom)}function Vn(n){return nn.from(n.dom.nextSibling).map(Tn.fromDom)}function qn(n){return H(n.dom.childNodes,Tn.fromDom)}function Hn(n){return e=0,t=n.dom.childNodes,nn.from(t[e]).map(Tn.fromDom);var e,t}function Gn(n){var e,t=Ce(n);return Cn(e=t)&&s(e.dom.host)?nn.some(t):nn.none()}function Un(n){return Tn.fromDom(n.dom.host)}function Xn(n,e,t){return r=function(n){return Mn(n,e)},b(_n(n,t),r);var r}function $n(n,e){return t=function(n){return Mn(n,e)},b(qn(n),t);var t}function Kn(n,e){return t=e,o=void 0===(r=n)?document:r.dom,jn(o)?[]:H(o.querySelectorAll(t),Tn.fromDom);var t,r,o}function Qn(n,e,t){return{element:n,rowspan:e,colspan:t}}function Yn(n,e,t){return{element:n,cells:e,section:t}}function Jn(n,e,t){return{element:n,isNew:e,isLocked:t}}function Zn(n,e,t,r){return{element:n,cells:e,section:t,isNew:r}}var ne,ee=function(){return te(0,0)},te=function(n,e){return{major:n,minor:e}},re={nu:te,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?ee():Dn(n,t)},unknown:ee},oe=(ne=/^\s+|\s+$/g,function(n){return n.replace(ne,"")}),ue=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ie=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return En(n,"edge/")&&En(n,"chrome")&&En(n,"safari")&&En(n,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ue],search:function(n){return En(n,"chrome")&&!En(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return En(n,"msie")||En(n,"trident")}},{name:"Opera",versionRegexes:[ue,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Wn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Wn("firefox")},{name:"Safari",versionRegexes:[ue,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(En(n,"safari")||En(n,"mobile/"))&&En(n,"applewebkit")}}],ce=[{name:"Windows",search:Wn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return En(n,"iphone")||En(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Wn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Wn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Wn("linux"),versionRegexes:[]},{name:"Solaris",search:Wn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Wn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Wn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],le={browsers:M(ie),oses:M(ce)},ae="Firefox",fe=function(n){function e(n){return function(){return t===n}}var t=n.current,r=n.version;return{current:t,version:r,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(ae),isSafari:e("Safari")}},se={unknown:function(){return fe({current:void 0,version:re.unknown()})},nu:fe,edge:M("Edge"),chrome:M("Chrome"),ie:M("IE"),opera:M("Opera"),firefox:M(ae),safari:M("Safari")},me="Windows",de="Android",ve="Solaris",ge="FreeBSD",pe="ChromeOS",he=function(n){function e(n){return function(){return t===n}}var t=n.current,r=n.version;return{current:t,version:r,isWindows:e(me),isiOS:e("iOS"),isAndroid:e(de),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(ve),isFreeBSD:e(ge),isChromeOS:e(pe)}},be={unknown:function(){return he({current:void 0,version:re.unknown()})},nu:he,windows:M(me),ios:M("iOS"),android:M(de),linux:M("Linux"),osx:M("OSX"),solaris:M(ve),freebsd:M(ge),chromeos:M(pe)},we=function(n,e,t){var r,o,u,i,c,l,a,f,s,m,d,v,g=le.browsers(),p=le.oses(),h=e.bind(function(n){return r=g,J(n.brands,function(e){var t=e.brand.toLowerCase();return w(r,function(n){var e;return t===(null===(e=n.brand)||void 0===e?void 0:e.toLowerCase())}).map(function(n){return{current:n.name,version:re.nu(parseInt(e.version,10),0)}})});var r}).orThunk(function(){return kn(g,t=n).map(function(n){var e=re.detect(n.versionRegexes,t);return{current:n.name,version:e}});var t}).fold(se.unknown,se.nu),b=kn(p,r=n).map(function(n){var e=re.detect(n.versionRegexes,r);return{current:n.name,version:e}}).fold(be.unknown,be.nu);return{browser:h,os:b,deviceType:(u=h,i=n,c=t,l=(o=b).isiOS()&&!0===/ipad/i.test(i),a=o.isiOS()&&!l,f=o.isiOS()||o.isAndroid(),s=f||c("(pointer:coarse)"),m=l||!a&&f&&c("(min-device-width:768px)"),d=a||f&&!m,v=u.isSafari()&&o.isiOS()&&!1===/safari/i.test(i),{isiPad:M(l),isiPhone:M(a),isTablet:M(m),isPhone:M(d),isTouch:M(s),isAndroid:o.isAndroid,isiOS:o.isiOS,isWebView:M(v),isDesktop:M(!d&&!m&&!v)})}},ye=An(function(){return we(navigator.userAgent,nn.from(navigator.userAgentData),Ln)}),xe=Mn,Ce=_(Element.prototype.attachShadow)&&_(Node.prototype.getRootNode)?function(n){return Tn.fromDom(n.dom.getRootNode())}:Pn,Se=function(n){var e=yn(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return Gn(Tn.fromDom(e)).fold(function(){return o.body.contains(e)},(t=Se,r=Un,function(n){return t(r(n))}))},Te=function(n,e){var t=[];return G(qn(n),function(n){t=(t=e(n)?t.concat([n]):t).concat(Te(n,e))}),t},Re=function(o,u,e){function t(n){sn(n,o.selected),sn(n,o.firstSelected),sn(n,o.lastSelected)}function i(n){cn(n,o.selected,"1")}function c(n){r(n),e()}var r=function(n){var e=Kn(n,o.selectedSelector);G(e,t)};return{clearBeforeUpdate:r,clear:c,selectRange:function(n,e,t,r){c(n),G(e,i),cn(t,o.firstSelected,"1"),cn(r,o.lastSelected,"1"),u(e,t,r)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}},Oe=["tfoot","thead","tbody","colgroup"];function Ae(n,e,t){for(var r=n.dom,o=_(t)?t:l;r.parentNode;){var r=r.parentNode,u=Tn.fromDom(r);if(e(u))return nn.some(u);if(o(u))break}return nn.none()}function De(n,e,t){return Ae(n,function(n){return Mn(n,e)},t)}function ke(n,e){return t=function(n){return Mn(n,e)},w(n.dom.childNodes,function(n){return t(Tn.fromDom(n))}).map(Tn.fromDom);var t}function Ee(n,e){return t=e,o=void 0===(r=n)?document:r.dom,jn(o)?nn.none():nn.from(o.querySelector(t)).map(Tn.fromDom);var t,r,o}function Ne(n,e,t){var r,o,u,i;return r=De,i=t,Mn(o=n,u=e)?nn.some(o):_(i)&&i(o)?nn.none():r(o,u,i)}function We(n,e,t){return void 0===t&&(t=r),n.exists(function(n){return t(n,e)})}function Le(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e}function Me(n,e,t){return n.isSome()&&e.isSome()?nn.some(t(n.getOrDie(),e.getOrDie())):nn.none()}function je(n){return n.bind(j)}function Ie(n,e){return n?nn.some(e):nn.none()}function ze(n){return void 0!==n.style&&_(n.style.getPropertyValue)}function Pe(n,e,t){if(!I(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);ze(n)&&n.style.setProperty(e,t)}function Be(n,e,t){var r=n.dom;Pe(r,e,t)}function _e(n,e){var t=n.dom;g(e,function(n,e){Pe(t,e,n)})}function Fe(n,e){var t=n.dom,r=window.getComputedStyle(t).getPropertyValue(e);return""!==r||Se(n)?r:St(t,e)}function Ve(n,e){var t=n.dom,r=St(t,e);return nn.from(r).filter(function(n){return 0<n.length})}function qe(n,e){var t,r,o=n.dom;r=e,ze(t=o)&&t.style.removeProperty(r),We(fn(n,"style").map(oe),"")&&sn(n,"style")}function He(n,e,t){return void 0===t&&(t=0),fn(n,e).map(function(n){return parseInt(n,10)}).getOr(t)}function Ge(n,e){return He(n,e,1)}function Ue(n){return 1<Ge(n,"colspan")}function Xe(n,e){return Rt(n,e,V)}function $e(n,e){return function(n,e,t){if((t=void 0===t?l:t)(e))return nn.none();if(p(n,en(e)))return nn.some(e);return De(e,n.join(","),function(n){return Mn(n,"table")||t(n)})}(["td","th"],n,e)}function Ke(n){return Xe(n,"th,td")}function Qe(n){return Mn(n,"colgroup")?$n(n,"col"):K(Ot(n),function(n){return $n(n,"col")})}function Ye(n,e){return Ne(n,"table",e)}function Je(n){return Bn(n).map(function(n){var e=en(n);return p(Oe,e)?e:"tbody"}).getOr("tbody")}function Ze(n){var t,e=Xe(n,"tr"),r=On(On([],Ot(n)),e);return t=Je,H(r,function(n){if("colgroup"===en(n)){var e=H(Qe(n),function(n){var e=He(n,"span",1);return Qn(n,1,e)});return Yn(n,e,"colgroup")}e=H(Ke(n),function(n){var e=He(n,"rowspan",1),t=He(n,"colspan",1);return Qn(n,e,t)});return Yn(n,e,t(n))})}function nt(n,e,t){return o=e,u=[t],i=(r=n).cells,c=i.slice(0,o),l=i.slice(o),a=c.concat(u).concat(l),At(r,a);var r,o,u,i,c,l,a}function et(n,e){return n.cells[e]}function tt(n,e){return et(n,e).element}function rt(n){var e=U(n,function(n){return"colgroup"===n.section});return{rows:e.fail,cols:e.pass}}function ot(n){return fn(n,Dt).bind(function(n){return nn.from(n.match(/\d+/g))}).map(function(n){return function(n,e){for(var t={},r=0,o=n.length;r<o;r++){var u=n[r];t[String(u)]=e(u,r)}return t}(n,V)})}function ut(n){var f={},e=[],t={},r=[],s=Y(n).map(function(n){return n.element}).bind(Ye).bind(ot).getOr({}),i=0,m=0,d=0;return G(n,function(n){var a,o,u;"colgroup"===n.section?(o={},u=0,G(n.cells,function(t){var r=t.colspan;h(r,function(n){var e=u+n;o[e]={element:t.element,colspan:r,column:e}}),u+=r}),t=o,r=[{element:n.element,columns:x(t)}]):(a=[],G(n.cells,function(n){for(var e=0;void 0!==f[d+","+e];)e++;for(var t,r,o=(t=s,r=e.toString(),N(t,r)&&void 0!==t[r]&&null!==t[r]),u={element:n.element,rowspan:n.rowspan,colspan:n.colspan,row:d,column:e,isLocked:o},i=0;i<n.colspan;i++)for(var c=0;c<n.rowspan;c++){var l=e+i;f[d+c+","+l]=u,m=Math.max(m,l+1)}a.push(u)}),i++,e.push(Yn(n.element,a,n.section)),d++)}),{grid:{rows:i,columns:m},access:f,all:e,columns:t,colgroups:r}}function it(n,e){return e.column>=n.startCol&&e.column+e.colspan-1<=n.finishCol&&e.row>=n.startRow&&e.row+e.rowspan-1<=n.finishRow}function ct(n,e,t){var r=Et.findItem(n,e,In),o=Et.findItem(n,t,In);return r.bind(function(r){return o.map(function(n){return e=r,t=n,{startRow:Math.min(e.row,t.row),startCol:Math.min(e.column,t.column),finishRow:Math.max(e.row+e.rowspan-1,t.row+t.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,t.column+t.colspan-1)};var e,t})})}function lt(e,n,t){return ct(e,n,t).bind(function(n){return function(n,e){for(var t=!0,r=i(it,e),o=e.startRow;o<=e.finishRow;o++)for(var u=e.startCol;u<=e.finishCol;u++)t=t&&Et.getAt(n,o,u).exists(r);return t?nn.some(e):nn.none()}(e,n)})}function at(n,e,t){var r=Nt(n);return lt(r,e,t)}function ft(e,t){Bn(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})}function st(n,e){Vn(n).fold(function(){Bn(n).each(function(n){Wt(n,e)})},function(n){ft(n,e)})}function mt(e,t){Hn(e).fold(function(){Wt(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})}function dt(n,e){ft(n,e),Wt(e,n)}function vt(r,o){G(o,function(n,e){var t=0===e?r:o[e-1];st(t,n)})}function gt(e,n){G(n,function(n){Wt(e,n)})}function pt(n){n.dom.textContent="",G(qn(n),function(n){Lt(n)})}function ht(n){var e,t=qn(n);0<t.length&&(e=n,G(t,function(n){ft(e,n)})),Lt(n)}function bt(n){return Mt.get(n)}function wt(n,e){return Mt.set(n,e)}var yt,xt,Ct,St=function(n,e){return ze(n)?n.style.getPropertyValue(e):""},Tt=M(10),Rt=function(n,e,t){return K(qn(n),function(n){return Mn(n,e)?t(n)?[n]:[]:Rt(n,e,t)})},Ot=function(n){return Ye(n).fold(M([]),function(n){return $n(n,"colgroup")})},At=function(n,e){return Zn(n.element,e,n.section,n.isNew)},Dt="data-snooker-locked-cols",kt=function(n,e){var t=K(n.all,function(n){return n.cells});return b(t,e)},Et={fromTable:function(n){var e=Ze(n);return ut(e)},generate:ut,getAt:function(n,e,t){return nn.from(n.access[e+","+t])},findItem:function(n,e,t){var r=kt(n,function(n){return t(e,n.element)});return 0<r.length?nn.some(r[0]):nn.none()},filterItems:kt,justCells:function(n){return K(n.all,function(n){return n.cells})},justColumns:function(n){return x(n.columns)},hasColumns:function(n){return 0<k(n.columns).length},getColumnAt:function(n,e){return nn.from(n.columns[e])}},Nt=Et.fromTable,Wt=function(n,e){n.dom.appendChild(e.dom)},Lt=function(n){var e=n.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Mt=(yt=yn,xt="text",{get:function(n){if(!yt(n))throw new Error("Can only get "+xt+" value of a "+xt+" node");return Ct(n).getOr("")},getOption:Ct=function(n){return yt(n)?nn.from(n.dom.nodeValue):nn.none()},set:function(n,e){if(!yt(n))throw new Error("Can only set raw "+xt+" value of a "+xt+" node");n.dom.nodeValue=e}}),jt=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function It(){return{up:M({selector:De,closest:Ne,predicate:Ae,all:_n}),down:M({selector:Kn,predicate:Te}),styles:M({get:Fe,getRaw:Ve,set:Be,remove:qe}),attrs:M({get:an,set:cn,remove:sn,copyTo:function(n,e){var t=mn(n);ln(e,t)}}),insert:M({before:ft,after:st,afterAll:vt,append:Wt,appendAll:gt,prepend:mt,wrap:dt}),remove:M({unwrap:ht,remove:Lt}),create:M({nu:Tn.fromTag,clone:function(n){return Tn.fromDom(n.dom.cloneNode(!1))},text:Tn.fromText}),query:M({comparePosition:function(n,e){return n.dom.compareDocumentPosition(e.dom)},prevSibling:Fn,nextSibling:Vn}),property:M({children:qn,name:en,parent:Bn,document:function(n){return Pn(n).dom},isText:yn,isComment:rn,isElement:wn,isSpecial:function(n){var e=en(n);return p(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],e)},getLanguage:function(n){return wn(n)?fn(n,"lang"):nn.none()},getText:bt,setText:wt,isBoundary:function(n){return!!wn(n)&&("body"===en(n)||p(jt,en(n)))},isEmptyTag:function(n){return!!wn(n)&&p(["br","img","hr","input"],en(n))},isNonEditable:function(n){return wn(n)&&"false"===an(n,"contenteditable")}}),eq:In,is:xe}}function zt(n){return De(n,"table")}function Pt(n,e,t){return Ee(n,e).bind(function(r){return Ee(n,t).bind(function(e){return t=zt,mr(dr,function(n,e){return t(e)},[r,e]).map(function(n){return{first:r,last:e,table:n}});var t})})}function Bt(n,e){return 0<(t=Kn(n,e)).length?nn.some(t):nn.none();var t}function _t(u,n,e){return Pt(u,n,e).bind(function(t){function n(n){return In(u,n)}var e="thead,tfoot,tbody,table",r=De(t.first,e,n),o=De(t.last,e,n);return r.bind(function(e){return o.bind(function(n){return In(e,n)?at(t.table,t.first,t.last):nn.none()})})})}function Ft(n,e,t,r){return n.fold(e,t,r)}function Vt(n){return parseInt(n,10)}function qt(n,e){var t=n-e;return 0==t?0:0<t?1:-1}function Ht(n,e,t){return{major:n,minor:e,patch:t}}function Gt(n){var e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?Ht(Vt(e[1]),Vt(e[2]),Vt(e[3])):Ht(0,0,0)}function Ut(n,e){return!!n&&-1===function(n,e){var t=qt(n.major,e.major);if(0!==t)return t;var r=qt(n.minor,e.minor);if(0!==r)return r;var o=qt(n.patch,e.patch);return 0!==o?o:0}(Gt([n.majorVersion,n.minorVersion].join(".").split(".").slice(0,3).join(".")),Gt(e))}function Xt(n){return Tn.fromDom(n.getBody())}function $t(e){return function(n){return In(n,Xt(e))}}function Kt(n){return Tn.fromDom(n.selection.getStart())}function Qt(n){function e(n){return sn(n,"data-mce-style")}sn(n,"data-mce-style"),G(Ke(n),e),G(Qe(n),e)}function Yt(n){return Ft(n.get(),M([]),j,d)}function Jt(n){function e(n,e){return fn(n,e).exists(function(n){return 1<parseInt(n,10)})}var t=Yt(n);return 0<t.length&&y(t,function(n){return e(n,"rowspan")||e(n,"colspan")})?nn.some(t):nn.none()}function Zt(n,e,t){return{element:t,mergable:(r=e,o=Cr,Ft(n.get(),nn.none,function(e){return e.length<=1?nn.none():_t(r,o.firstSelectedSelector,o.lastSelectedSelector).map(function(n){return{bounds:n,cells:e}})},nn.none)),unmergable:Jt(n),selection:Yt(n)};var r,o}function nr(n){return{element:n,mergable:nn.none(),unmergable:nn.none(),selection:[n]}}function er(u){return function(n,e){var t,r=en(n),o="col"===r||"colgroup"===r?Ye(t=n).bind(function(n){return Bt(n,Cr.firstSelectedSelector)}).fold(M(t),function(n){return n[0]}):n;return Ne(o,u,e)}}function tr(n,e){var t=$t(e);return Ye(n,t)}function rr(n,e){return Tr(n).bind(function(n){return Ye(n,e)})}function or(s,u){function m(n){s.focus()}function o(i,c,l,a,f){Tr(Kt(s)).each(function(u){tr(u,s).each(function(t){function n(n,e){return Et.findItem(r,n,In).map(function(n){return n[e]})}var r=Et.fromTable(t),e=i.orThunk(function(){return n(u,"row")}),o=c.orThunk(function(){return n(u,"column")});je(Me(e,o,function(n,e){return Et.getAt(r,n,e).map(function(n){return n.element})})).bind(function(n){var e=nr(n);return l(t,e,Ie(a,u),!0,f)}).each(m)})})}return{selection:function(r,o){Tr(Kt(s)).each(function(t){tr(t,s).each(function(n){var e=Zt(u,n,t);r(n,e,nn.none(),!0,o).each(m)})})},row:function(n,e,t,r){return o(nn.some(n),nn.none(),e,t,r)},column:function(n,e,t,r){return o(nn.none(),nn.some(n),e,t,r)},table:function(r,n,e,o,u,i){var t=Et.fromTable(r),c=Et.getAt(t,n,e).map(function(n){return n.element}),l=Tr(Kt(s)),a=l.bind(function(n){return Et.findItem(t,n,In)}).isSome();c.bind(function(n){var e=nr(n),t=a&&u?l:nn.none();return o(r,e,t,a,i)}).each(m)}}}function ur(n,e){return{element:n,offset:e}}function ir(n,e){return(n.property().isText(e)?n.property().getText(e):n.property().children(e)).length}var cr,lr,ar,fr=function(r,o,n,e){var t=o(r,n);return m(e,function(n,e){var t=o(r,e);return sr(r,n,t)},t)},sr=function(e,n,t){return n.bind(function(n){return t.filter(i(e.eq,n))})},mr=function(n,e,t){return 0<t.length?fr(n,e,t[0],t.slice(1)):nn.none()},dr=It(),vr=function(i){if(!P(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return G(i,function(n,r){var e=k(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],u=n[o];if(void 0!==t[o])throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!P(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=t.length;if(e!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+e);return{fold:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+n.length);return n[r].apply(null,t)},match:function(n){var e=k(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!y(c,function(n){return p(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},gr=vr([{none:[]},{multiple:["elements"]},{single:["element"]}]),pr=gr.none,hr=gr.multiple,br=gr.single,wr="data-mce-selected",yr="data-mce-first-selected",xr="data-mce-last-selected",Cr={selected:wr,selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:yr,firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:xr,lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},Sr=er("th,td,caption"),Tr=er("th,td"),Rr=function(e,n,t){return e.property().isText(n)&&0===e.property().getText(n).trim().length||e.property().isComment(n)?t(n).bind(function(n){return Rr(e,n,t).orThunk(function(){return nn.some(n)})}):nn.none()},Or=function(n,e){var t=Rr(n,e,n.query().prevSibling).getOr(e);if(n.property().isText(t))return ur(t,ir(n,t));var r=n.property().children(t);return 0<r.length?Or(n,r[r.length-1]):ur(t,ir(n,t))},Ar=Or,Dr=It(),kr={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},Er=(ar=["Infinity",(cr="[0-9]+")+"\\."+Nr(cr)+Nr(lr="[eE][+-]?[0-9]+"),"\\."+cr+Nr(lr),cr+Nr(lr)].join("|"),new RegExp("^("+("[+-]?(?:"+ar+")")+")(.*)$"));function Nr(n){return"(?:"+n+")?"}function Wr(n,o){return nn.from(Er.exec(n)).bind(function(n){var e,t=Number(n[1]),r=n[2];return e=r,q(o,function(n){return q(kr[n],function(n){return e===n})})?nn.some({value:t,unit:r}):nn.none()})}function Lr(r,o){function n(n){var e=o(n);if(e<=0||null===e){var t=Fe(n,r);return parseFloat(t)||0}return e}function u(o,n){return $(n,function(n,e){var t=Fe(o,e),r=void 0===t?0:parseInt(t,10);return isNaN(r)?n:n+r},0)}return{set:function(n,e){if(!F(e)&&!e.match(/^[0-9]+$/))throw new Error(r+".set accepts only positive integer values. Value was "+e);var t=n.dom;ze(t)&&(t.style[r]=e+"px")},get:n,getOuter:n,aggregate:u,max:function(n,e,t){var r=u(n,t);return r<e?e-r:0}}}function Mr(n){return Uu.getOuter(n)}function jr(n){return Xu.get(n)}function Ir(n){return Xu.getOuter(n)}function zr(n,e,t){return r=Fe(n,e),o=t,u=parseFloat(r),isNaN(u)?o:u;var r,o,u}function Pr(n){return(r=ye().browser).isIE()||r.isEdge()?(t=(e=n).dom.getBoundingClientRect().width,"border-box"===Fe(e,"box-sizing")?t:t-zr(e,"padding-left",0)-zr(e,"padding-right",0)-(zr(e,"border-left-width",0)+zr(e,"border-right-width",0))):zr(n,"width",jr(n));var e,t,r}function Br(n,e){Be(n,"width",e+"px")}function _r(n,e){Be(n,"width",e+"%")}function Fr(n){return Ve(n,"width").fold(function(){return nn.from(an(n,"width"))},function(n){return nn.some(n)})}function Vr(n,e){return n/e.pixelWidth()*100}function qr(e,t){return Fr(e).fold(function(){var n=jr(e);return Vr(n,t)},function(n){return function(n,e,t){var r=$u.exec(e);if(null!==r)return parseFloat(r[1]);var o=Pr(n);return Vr(o,t)}(e,n,t)})}function Hr(e,t){return Fr(e).fold(function(){return Pr(e)},function(n){return function(n,e,t){var r=Ku.exec(e);if(null!==r)return parseInt(r[1],10);var o=$u.exec(e);return null===o?Pr(n):parseFloat(o[1])/100*t.pixelWidth()}(e,n,t)})}function Gr(n,e,t){Be(n,"width",e+t)}function Ur(t,r){1===Ge(t,"colspan")&&Fr(t).bind(function(n){return Wr(n,["fixed","relative","empty"])}).each(function(n){var e=n.value/2;Gr(t,e,n.unit),Gr(r,e,n.unit)})}function Xr(n){return"tr"===en(n)||Zu(n)}function $r(n){return{element:n,colspan:He(n,"colspan",1),rowspan:He(n,"rowspan",1)}}function Kr(n){return H(n,M(0))}function Qr(i){return function(n,e,t,r){if(i(t)){var o=Math.max(r,n[e]-Math.abs(t)),u=Math.abs(o-n[e]);return 0<=t?u:-u}return t}}function Yr(){function i(n,e,t,r,o){var u,i,c,l,a=ti(n,0<=r?t:e,r,o);return i=t+1,c=[a,-a],(l=Kr)((u=n).slice(0,e)).concat(c).concat(l(u.slice(i)))}return{resizeTable:function(n,e,t){t&&n(e)},clampTableDelta:function(n,e,t,r,o){if(o){if(0<=t)return t;var u=$(n,function(n,e){return n+e-r},0);return Math.max(-u,t)}return ei(n,e,t,r)},calcLeftEdgeDeltas:i,calcMiddleDeltas:function(n,e,t,r,o,u){return i(n,t,r,o,u)},calcRightEdgeDeltas:function(n,e,t,r,o,u){if(u)return Kr(n);var i=r/n.length;return H(n,M(i))},calcRedestributedWidths:function(n,e,t,r){return{delta:0,newSizes:n}}}}function Jr(n,e){return Tn.fromDom(n.dom.cloneNode(e))}function Zr(n,e){var t=Tn.fromTag(e),r=mn(n);return ln(t,r),t}function no(n,e){var t=Zr(n,e),r=qn(Jr(n,!0));return gt(t,r),t}function eo(n,e,t){return Jn(t(n.element,e),!0,n.isLocked)}function to(n){var e=n;return{get:function(){return e},set:function(n){e=n}}}function ro(t,r){void 0===r&&(r=V);var n=t.grid,e=h(n.columns,j),o=h(n.rows,j);return H(e,function(e){return oi(function(){return K(o,function(n){return Et.getAt(t,n,e).filter(function(n){return n.column===e}).toArray()})},function(n){return 1===n.colspan&&r(n.element)},function(){return Et.getAt(t,0,e)})})}function oo(r,o){if(o<0||o>=r.length-1)return nn.none();var n=r[o].fold(function(){var n,e,t=(n=r.slice(0,o),(e=O.call(n,0)).reverse(),e);return J(t,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return nn.some({value:n,delta:0})}),e=r[o+1].fold(function(){var n=r.slice(o+1);return J(n,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return nn.some({value:n,delta:1})});return n.bind(function(t){return e.map(function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e})})}function uo(n,e){return void 0!==n?n:void 0!==e?e:0}function io(n){var e=n.dom.ownerDocument,t=e.body,r=e.defaultView,o=e.documentElement;if(t===n.dom)return ci(t.offsetLeft,t.offsetTop);var u=uo(null==r?void 0:r.pageYOffset,o.scrollTop),i=uo(null==r?void 0:r.pageXOffset,o.scrollLeft),c=uo(o.clientTop,t.clientTop),l=uo(o.clientLeft,t.clientLeft);return li(n).translate(i-l,u-c)}function co(n,e){return{row:n,y:e}}function lo(n,e){return{col:n,x:e}}function ao(n){return io(n).left+Ir(n)}function fo(n){return io(n).left}function so(n,e){return lo(n,fo(e))}function mo(n,e){return lo(n,ao(e))}function vo(n){return io(n).top}function go(n,e){return co(n,vo(e))}function po(n,e){return co(n,vo(e)+Mr(e))}function ho(t,e,r){if(0===r.length)return[];var n=H(r.slice(1),function(n,e){return n.map(function(n){return t(e,n)})}),o=r[r.length-1].map(function(n){return e(r.length-1,n)});return n.concat([o])}function bo(n,e){return Ve(n,e).isSome()}function wo(n,e,t,r,o,u){return n.filter(r).fold(function(){return u(oo(t,e))},function(n){return o(n)})}function yo(n,e,i,c,l){var t,a=ro(n,function(n){return bo(n,"width")}),r=Et.hasColumns(n)?H(Et.justColumns(n),function(n){return nn.from(n.element)}):a,f=[nn.some(mi(e))].concat(H(si(a,e),function(n){return n.map(function(n){return n.x})})),s=(t=Ue,function(n){return!t(n)});return H(r,function(n,u){return wo(n,u,f,s,function(n){if(!di(r=n)||bo(r,"width"))return i(n,l);var e,t,r,o=(e=a[u],t=j,null!=e?t(e):nn.none());return wo(o,u,f,s,function(n){return c(nn.some(jr(n)))},c)},c)})}function xo(n,e,t){return yo(n,e,Hr,function(n){return n.getOrThunk(t.minCellWidth)},t)}function Co(t){function n(){return jr(t)}var e=M(0);return{width:n,pixelWidth:n,getWidths:function(n,e){return xo(n,t,e)},getCellDelta:e,singleColumnWidth:M([0]),minCellWidth:e,setElementWidth:L,adjustTableWidth:L,isRelative:!0,label:"none"}}function So(n,r){var o=to(parseFloat(n)),u=to(jr(r));return{width:o.get,pixelWidth:u.get,getWidths:function(n,e){return yo(n,r,qr,function(n){return n.fold(function(){return t.minCellWidth()},function(n){return n/t.pixelWidth()*100})},t=e);var t},getCellDelta:function(n){return n/u.get()*100},singleColumnWidth:function(n,e){return[100-n]},minCellWidth:function(){return Tt()/u.get()*100},setElementWidth:_r,adjustTableWidth:function(n){var e=o.get(),t=e+n/100*e;_r(r,t),o.set(t),u.set(jr(r))},isRelative:!0,label:"percent"}}function To(n,t){var r=to(n),o=r.get;return{width:o,pixelWidth:o,getWidths:function(n,e){return xo(n,t,e)},getCellDelta:j,singleColumnWidth:function(n,e){return[Math.max(Tt(),n+e)-n]},minCellWidth:Tt,setElementWidth:Br,adjustTableWidth:function(n){var e=o()+n;Br(t,e),r.set(e)},isRelative:!1,label:"pixel"}}function Ro(n,e,t,r){t===r?sn(n,e):cn(n,e,t)}function Oo(n,e,t){var r;r=$n(n,e),v(r,r.length-1).fold(function(){return mt(n,t)},function(n){return st(n,t)})}function Ao(c,n){function l(n){return H(n,function(n){n.isNew&&r.push(n.element);var e=n.element;return pt(e),G(n.cells,function(n){n.isNew&&o.push(n.element),Ro(n.element,"colspan",n.colspan,1),Ro(n.element,"rowspan",n.rowspan,1),Wt(e,n.element)}),e})}function a(n){return K(n,function(n){return H(n.cells,function(n){return Ro(n.element,"span",n.colspan,1),n.element})})}function t(n,e){var t,r,o,u=(o=ke(t=c,r=e).getOrThunk(function(){var n=Tn.fromTag(r,zn(t).dom);return"thead"===r?Oo(t,"caption,colgroup",n):"colgroup"===r?Oo(t,"caption",n):Wt(t,n),n}),pt(o),o),i=("colgroup"===e?a:l)(n);gt(u,i)}function e(n,e){0<n.length?t(n,e):ke(c,e).each(Lt)}var r=[],o=[],u=[],i=[],f=[],s=[];return G(n,function(n){switch(n.section){case"thead":u.push(n);break;case"tbody":i.push(n);break;case"tfoot":f.push(n);break;case"colgroup":s.push(n)}}),e(s,"colgroup"),e(u,"thead"),e(i,"tbody"),e(f,"tfoot"),{newRows:r,newCells:o}}function Do(t,n,r){var o=t.origin();G(n,function(n){n.each(function(n){var e=r(o,n);hn(e,pi),Wt(t.parent(),e)})})}function ko(n,e,a,f){Do(n,e,function(n,e){var t,r,o,u,i,c,l=(t=e.col,r=e.x-n.left,o=a.top-n.top,u=7,i=f,c=Tn.fromTag("div"),_e(c,{position:"absolute",left:r-u/2+"px",top:o+"px",height:i+"px",width:u+"px"}),ln(c,{"data-column":t,role:"presentation"}),c);return hn(l,bi),l})}function Eo(n,e,a,f){Do(n,e,function(n,e){var t,r,o,u,i,c,l=(t=e.row,r=a.left-n.left,o=e.y-n.top,u=f,i=7,c=Tn.fromTag("div"),_e(c,{position:"absolute",left:r+"px",top:o-i/2+"px",height:i+"px",width:u+"px"}),ln(c,{"data-row":t,role:"presentation"}),c);return hn(l,hi),l})}function No(n,e,t,r,o){var u,i=io(t),c=e.isResizable,l=0<r.length?ai(r,t):[],a=0<l.length?(u=c,K(n.all,function(n,e){return u(n.element)?[e]:[]})):[],f=b(l,function(n,e){return q(a,function(n){return e===n})});Eo(e,f,i,Ir(t));var s,m,d,v=0<o.length?si(o,t):[],g=0<v.length?(m=c,d=[],h((s=n).grid.columns,function(n){Et.getColumnAt(s,n).map(function(n){return n.element}).forall(m)&&d.push(n)}),b(d,function(e){var n=Et.filterItems(s,function(n){return n.column===e});return y(n,function(n){return m(n.element)})})):[],p=b(v,function(n,e){return q(g,function(n){return e===n})});ko(e,p,i,Mr(t))}function Wo(n,e){var t,r,o,u,i,c,l,a;t=Kn(n.parent(),"."+pi),G(t,Lt),n.isResizable(e)&&(r=Et.fromTable(e),c=(i=r).grid,l=h(c.rows,j),a=h(c.columns,j),o=H(l,function(e){return oi(function(){return K(a,function(n){return Et.getAt(i,e,n).filter(function(n){return n.row===e}).fold(M([]),function(n){return[n]})})},function(n){return 1===n.rowspan},function(){return Et.getAt(i,e,0)})}),u=ro(r),No(r,n,e,o,u))}function Lo(n,e){if(0===n.length)return 0;var t=n[0];return function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return nn.some(t);return nn.none()}(n,function(n){return!e(t.element,n.element)}).getOr(n.length)}function Mo(n,e,t,r){var o,u=n[e].cells.slice(t),i=Lo(u,r),c=(o=t,H(n,function(n){return et(n,o)}).slice(e));return{colspan:i,rowspan:Lo(c,r)}}function jo(o,u){var i=H(o,function(n){return H(n.cells,l)});return H(o,function(n,r){var e=K(n.cells,function(n,e){if(!1!==i[r][e])return[];var t=Mo(o,r,e,u);return function(n,e,t,r){for(var o=n;o<n+t;o++)for(var u=e;u<e+r;u++)i[o][u]=!0}(r,e,t.rowspan,t.colspan),[{element:n.element,rowspan:t.rowspan,colspan:t.colspan,isNew:n.isNew}]});return{element:n.element,cells:e,section:n.section,isNew:n.isNew}})}function Io(n,e){return function(n,e,t){var r=[];G(n.colgroups,function(n){var e=H(n.columns,function(n){return Jn(n.element,t,!1)});r.push(Zn(n.element,e,"colgroup",t))});for(var o=0;o<n.grid.rows;o++){for(var u=[],i=0;i<n.grid.columns;i++){var c=Et.getAt(n,o,i).map(function(n){return Jn(n.element,t,n.isLocked)}).getOrThunk(function(){return Jn(e.gap(),!0,!1)});u.push(c)}var l=n.all[o],a=Zn(l.element,u,l.section,t);r.push(a)}return r}(n,e,!1)}function zo(n,e){return J(n.all,function(n){return w(n.cells,function(n){return In(e,n.element)})})}function Po(e,n,t){var r=H(n.selection,function(n){return $e(n).bind(function(n){return zo(e,n)}).filter(t)}),o=Le(r);return Ie(0<o.length,o)}function Bo(s,e,c,m,d){return function(o,u,n,l,i){var a=Et.fromTable(u),f=nn.from(null==i?void 0:i.section).getOrThunk(ri);return e(a,n).map(function(n){var e,t,r,o,u=Io(a,l),i=s(u,n,In,d(l),f),c=(e=i.grid,t=$(rt(e).rows,function(t,n){return G(n.cells,function(n,e){n.isLocked&&(t[e]=!0)}),t},{}),r=Z(t,function(n,e){return parseInt(e,10)}),Q(r));return{info:n,grid:(o=i.grid,jo(o,In)),cursor:i.cursor,lockedColumns:c}}).bind(function(n){var e=Ao(u,n.grid),t=nn.from(null==i?void 0:i.sizing).getOrThunk(function(){return vi(u)}),r=nn.from(null==i?void 0:i.resize).getOrThunk(Yr);return c(u,n.grid,n.info,{sizing:t,resize:r,section:f}),m(u),Wo(o,u),sn(u,Dt),0<n.lockedColumns.length&&cn(u,Dt,n.lockedColumns.join(",")),nn.some({cursor:n.cursor,newRows:e.newRows,newCells:e.newCells})})}}function _o(e,n){return $e(n.element).bind(function(n){return zo(e,n)})}function Fo(n,e){return Po(n,e,V)}function Vo(e,n){return y(n,function(n){return zo(e,n).exists(function(n){return!n.isLocked})})}function qo(n){return Mt.getOption(n).filter(function(n){return 0!==n.trim().length||-1<n.indexOf("\xa0")}).isSome()}function Ho(n){return qo(n)||p(wi,en(n))}function Go(n){return o=Ho,(u=function(n){for(var e=0;e<n.childNodes.length;e++){var t=Tn.fromDom(n.childNodes[e]);if(o(t))return nn.some(t);var r=u(n.childNodes[e]);if(r.isSome())return r}return nn.none()})(n.dom);var o,u}function Uo(n,e,t){var r=no(n,e);return g(t,function(n,e){null===n?sn(r,e):cn(r,e,n)}),r}function Xo(r,o,u){return Go(r).map(function(n){var e=u.join(","),t=Xn(n,e,function(n){return In(n,r)});return m(t,function(n,e){var t=Jr(e,!1);return sn(t,"contenteditable"),Wt(n,t),t},o)}).getOr(o)}function $o(i,c,l){function a(n,e){var t,r,o;t=n.element,r=t.dom,o=e.dom,ze(r)&&ze(o)&&(o.style.cssText=r.style.cssText),qe(e,"height"),1!==n.colspan&&qe(e,"width")}var e,n,t;return{col:function(n){var e=Tn.fromTag(en(n.element),c.dom);return a(n,e),i(n.element,e),e},colgroup:function(){return Tn.fromTag("colgroup",t.dom)},row:function(){return Tn.fromTag("tr",n.dom)},cell:function(n){var r,o,e=Tn.fromTag(en(n.element),c.dom),t=l.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=0<t.length?Xo(n.element,e,t):e;return Wt(u,Tn.fromTag("br")),a(n,e),r=n.element,o=e,g(yi,function(e,t){return fn(r,t).filter(function(n){return p(e,n)}).each(function(n){return cn(o,t,n)})}),i(n.element,e),e},replace:Uo,gap:(e=n=t=c,function(){var n=Tn.fromTag("td",e.dom);return Wt(n,Tn.fromTag("br",e.dom)),n})}}function Ko(n){return Et.fromTable(n).grid}function Qo(n,e){return void 0===e&&(e=!1),!ye().browser.isIE()&&Se(n)?n.dom.isContentEditable:Ne(n,"[contenteditable]").fold(M(e),function(n){return"true"===xi(n)})}function Yo(n,r,o,u,i){return H(n,function(n){var e=0<r&&r<n.cells.length&&u(tt(n,r-1),tt(n,r)),t=function(n,e,t,r,o,u,i){if("colgroup"!==t&&r)return et(n,e);var c=et(n,o);return Jn(i(c.element,u),!0,!1)}(n,r,n.section,e,o,u,i);return nt(n,r,t)})}function Jo(n,e,r,o,u){var t,i,c=n.slice(0),l=(i=e,0===(t=n).length?Si.none():1===t.length?Si.only(0):0===i?Si.left(0,1):i===t.length-1?Si.right(i-1,i):0<i&&i<t.length-1?Si.middle(i-1,i,i+1):Si.none()),a=M(H(c,M(0)));return l.fold(a,function(n){return o.singleColumnWidth(c[n],r)},function(n,e){return u.calcLeftEdgeDeltas(c,n,e,r,o.minCellWidth(),o.isRelative)},function(n,e,t){return u.calcMiddleDeltas(c,n,e,t,r,o.minCellWidth(),o.isRelative)},function(n,e){return u.calcRightEdgeDeltas(c,n,e,r,o.minCellWidth(),o.isRelative)})}function Zo(n,e){return Et.hasColumns(n)?(o=e,u=Et.justColumns(n),H(u,function(n,e){return{element:n.element,width:o[e],colspan:n.colspan}})):(t=e,r=Et.justCells(n),H(r,function(n){var e=function(n,e,t){for(var r=0,o=n;o<e;o++)r+=void 0!==t[o]?t[o]:0;return r}(n.column,n.column+n.colspan,t);return{element:n.element,width:e,colspan:n.colspan}}));var t,r,o,u}function nu(n,e,t){var r=Zo(n,e);G(r,function(n){t.setElementWidth(n.element,n.width)})}function eu(n){return $(n,function(n,e){return q(n,function(n){return n.column===e.column})?n:n.concat([e])},[]).sort(function(n,e){return n.column-e.column})}function tu(n){return Qo(n,!0)}function ru(n,e,t){var r,o,u=rt(n).rows;return nn.from(null===(o=null===(r=u[e])||void 0===r?void 0:r.cells[t])||void 0===o?void 0:o.element).filter(tu).orThunk(function(){return J(u,function(n){return J(n.cells,function(n){var e=n.element;return Ie(tu(e),e)})})})}function ou(n,e,t){return{grid:n,cursor:ru(n,e,t)}}function uu(n,e,t,r){return o=t,u=r.sizing,i=r.resize,c=Et.generate(e),l=u.getWidths(c,u),a=u.pixelWidth(),f=i.calcRedestributedWidths(l,a,o.pixelDelta,u.isRelative),s=f.newSizes,m=f.delta,nu(c,s,u),void u.adjustTableWidth(m);var o,u,i,c,l,a,f,s,m}function iu(n,e){return q(e,function(n){return 0===n.column&&n.isLocked})}function cu(e,n){return q(n,function(n){return n.column+n.colspan>=e.grid.columns&&n.isLocked})}function lu(n,e){var t=ro(n),r=eu(e);return $(r,function(n,e){return n+t[e.column].map(Ir).getOr(0)},0)}function au(n,e){var t,r,o=zn(n).dom,u=Tn.fromDom(o.createDocumentFragment()),i=(t=e,(r=(o||document).createElement("div")).innerHTML=t,qn(Tn.fromDom(r)));gt(u,i),pt(n),Wt(n,u)}function fu(n){return n.dom.textContent}function su(n){var e=H(n,function(n){return o="thead"===(e=n).section,u=We(Ai(e.cells),"th"),(o||u?{type:"header",subType:(r=u,(t=o)&&r?"sectionCells":t?"section":"cells")}:"tfoot"===e.section?{type:"footer"}:{type:"body"}).type;var e,t,r,o,u}),t=p(e,"header"),r=p(e,"footer");if(t||r){var o=p(e,"body");return!t||o||r?t||o||!r?nn.none():nn.some("footer"):nn.some("header")}return nn.some("body")}function mu(n,e,t){return{value:e+1}}function du(n,e,t){for(var r="A".charCodeAt(0),o=[],u=e;0<=u;)o.push(String.fromCharCode(r+u%26)),u=Math.floor(u/26)-1;return{value:o.reverse().join("")}}function vu(n){return n.getParam("advtable_value_series",{numeric:{title:"Numeric",update:!0,resizable:!1,generator:mu},alpha:{title:"Alpha",update:!0,resizable:!1,generator:du}})}function gu(n){var e=parseFloat(n);return isNaN(e)?nn.none():nn.some(e)}function pu(n,e){return n<e?-1:e<n?1:0}function hu(n,e){return Me(gu(n),gu(e),pu).getOrThunk(function(){return n.localeCompare(e)})}function bu(p,u,h){function b(r,n,e,o){return e.filter(function(n){return Se(n)&&E(n)}).or(n.cursor).fold(function(){var n=Ke(r);return Y(n).filter(Se).map(function(n){var e=p.dom.createRng();return e.selectNode(n.dom),o&&(u.clear(r),p.selection.setRng(e),cn(n,"data-mce-selected","1")),e})},function(n){var e=p.dom.createRng(),t=Ar(Dr,n);return e.setStart(t.element.dom,t.offset),e.setEnd(t.element.dom,t.offset),o&&(u.clear(r),p.selection.setRng(e)),nn.some(e)})}function t(m,d,v,g){return function(r,n,o,u,i){void 0===i&&(i=!1);var e,t,c,l,a=(e=h().resizeHandler.lazyWire(),t=e.parent(),c=e.view(),l=e.origin(),_(t.dom)?{origin:M(Rn(Rn({},l),{left:l.left(),top:l.top()})),parent:M(Rn(Rn({},t),{dom:t.dom()})),view:M(Rn(Rn({},c),{dom:c.dom()})),isResizable:V}:e),f=Tn.fromDom(p.getDoc()),s=$o(v,f,k);return d(r)?m(a,r,n,s).bind(function(n){G(n.newRows,function(n){var e;e=n.dom,p.fire("newrow",{node:e})}),G(n.newCells,function(n){var e;e=n.dom,p.fire("newcell",{node:e})});var e,t=b(r,n,o,u);return Se(r)&&(Qt(r),i||(e=r.dom,p.fire("TableModified",Rn(Rn({},g),{table:e})))),t.map(function(n){return{rng:n,effect:g}})}):nn.none()}}function r(n,e,t){var r,o,u=rt(n).rows;return nn.from(null===(o=null===(r=u[e])||void 0===r?void 0:r.cells[t])||void 0===o?void 0:o.element).filter(E).orThunk(function(){return J(u,function(n){return J(n.cells,function(n){var e=n.element;return Ie(E(e),e)})})})}function l(n,e,t){return{grid:n,cursor:r(n,e,t)}}function f(n,r,o,u){var e=X(n,function(n){return n.section}),t=H(e,function(n){return X(n,function(n){return en(et(n,r).element)})});return K(t,function(n){return K(n,function(n){return"th"===en(et(n[0],r).element)?n:(e=H(n,function(n){var e=et(n,r);return{row:n,text:nn.from(fu(e.element)).getOr("")}}),t=Q(e,function(n,e){var t=o(n.text,e.text);return u?t:-1*t}),H(t,function(n){return n.row}));var e,t})})}function s(n,e,i,c){var t=n[e].cells,r=H(t,function(n){return nn.from(fu(n.element)).getOr("")}),l=on("th"),o=H(n,function(n){var e=H(n.cells,function(n,e){return{cell:n,column:e,reference:t[e],referenceText:r[e]}});return Rn(Rn({},n),{zippedCells:e})});return H(o,function(n){var e=X(n.zippedCells,function(n){return en(n.reference.element)}),t=K(e,function(n){if(l(n[0].reference.element))return H(n,function(n){return n.cell});var e=U(n,function(n){return n.cell.isLocked}),t=e.pass,r=e.fail,o=Q(r,function(n,e){var t=i(n.referenceText,e.referenceText);return c?t:-1*t}),u=$(t,function(n,e){var t=e.column,r=n.slice(0,t),o=n.slice(t);return r.concat([e]).concat(o)},o);return H(u,function(n){return n.cell})});return Zn(n.element,t,n.section,n.isNew)})}function m(n,e,t,r,o){var u=n.slice(0,e),i=n.slice(e,t+1);return{beforeRows:u,afterRows:n.slice(t+1,n.length),selectionGridBefore:i.map(function(n){return Rn(Rn({},n),{cells:n.cells.slice(0,r)})}),selectionGrid:i.map(function(n){return Rn(Rn({},n),{cells:n.cells.slice(r,o+1)})}),selectionGridAfter:i.map(function(n){return Rn(Rn({},n),{cells:n.cells.slice(o+1,n.cells.length)})})}}function d(o,n){var e=H(n,function(n,e){var t=o.selectionGridBefore[e].cells,r=o.selectionGridAfter[e].cells;return Rn(Rn({},n),{cells:t.concat(n.cells).concat(r)})});return o.beforeRows.concat(e).concat(o.afterRows)}function a(n,e,t,r,o,u,i,c){var l=m(n,t,r,o,u),a=f(l.selectionGrid,e-o,i,c);return d(l,a)}function v(n,e,t,r,o,u,i,c){var l=m(n,t,r,o,u),a=s(l.selectionGrid,e-t,i,c);return d(l,a)}function g(n){return $(n,function(n,e){return q(n,function(n){return n.row===e.row})?n:n.concat([e])},[]).sort(function(n,e){return n.row-e.row})}function w(n){return $(n,function(n,e){return q(n,function(n){return n.column===e.column})?n:n.concat([e])},[]).sort(function(n,e){return n.column-e.column})}function y(n){return $(n,function(n,e){return q(n,function(n){return In(n.element,e.element)})?n:n.concat([e])},[])}function x(u){var n=z(u.attributes)?Z(u.attributes,function(e,t){return B(e)?function(n){return sn(n,t)}:function(n){return cn(n,t,e)}}):[],e=function(n,e){if(P(n)){for(var t=0,r=n.length;t<r;++t)if(!e(n[t]))return!1;return!0}return!1}(u.classes,I)?H(u.classes,function(e){return function(n){return hn(n,e)}}):[];return On(On(On([],n),e),[function(n){var e,t=fu(n)||"",r=(e=u.value,F(e)?String(e):I(e)?e:void 0),o=I(r)?r:t;Nn(o)?au(n,"<br>"):n.dom.textContent=o}])}function C(i,n,c,l,a,f,s,m){var d;G(n,function(n,e){var t=n.element,r={sectionType:f(e),cellType:en(t),getRowType:s(e),getColType:m(e),classes:bn(t),prev:null==d?void 0:d.raw,direction:c},o=i(r,l(e),a(e)),u=x(o);G(u,function(n){return n(t)}),d=o})}function e(n,e,t,r,o){var u=a(n,o,0,n.length,o,o,t,r);return l(u,e[0].row,e[0].column)}function o(n,e,t,r,o){var u=g(e),i=w(e),c=a(n,o,u[0].row,u[u.length-1].row,i[0].column,i[i.length-1].column,t,r);return l(c,e[0].row,e[0].column)}function i(n,e,t,r,o){var u=N(n,o,t,r);return l(u,e.row,e.column)}function c(n,e,t,r,o){var u=v(n,o,o,o,0,n[e[0].row].cells.length,t,r);return l(u,e[0].row,e[0].column)}function S(n,e,t,r,o){var u=g(e),i=w(e),c=v(n,o,u[0].row,u[u.length-1].row,i[0].column,i[i.length-1].column,t,r);return l(c,e[0].row,e[0].column)}function T(n,e,t,r,o){var u=W(n,o,t,r);return l(u,e.row,e.column)}function R(n,e,t,r){var o=rt(n).rows,u=H(o,function(n){return et(n,r)}),i=y(u),c=An(function(){return Ai(i).getOr("")});return C(t,i,"column",j,M(r),function(n){return o[n].section},function(e){return An(function(){var n=o[e];return su([{cells:n.cells,section:n.section}]).getOr("")})},function(n){return c}),l(n,e.row,e.column)}function O(n,e,t,r){var o=rt(n).rows,u=o[r],i=y(u.cells),c=An(function(){return su([{cells:u.cells,section:u.section}]).getOr("")});return C(t,i,"row",M(r),j,function(n){return u.section},function(n){return c},function(e){return An(function(){var n=H(o,function(n){return et(n,e)});return Ai(n).getOr("")})}),l(n,e.row,e.column)}function A(o,u,i,c,l){return function(n,e,t,r){return Bo(function(n,e){return o(n,e,u,i,c)},l,L,L,ni)(n,e,t,r)}}function D(o,u,i,c){return function(n,e,t,r){return Bo(function(n,e){return o(n,e,u,i)},c,L,L,ni)(n,e,t,r)}}var n,k=(n=p.getParam("table_clone_elements"),I(n)?nn.some(n.split(/[ ,]/)):Array.isArray(n)?nn.some(n):nn.none()),E=function(n){return Qo(n,!0)},N=f,W=s;return{sortColumnRowsAsc:function(n){return t(A(e,hu,!0,n,Fo),V,L,ki)},sortColumnRowsDesc:function(n){return t(A(e,hu,!1,n,Fo),V,L,ki)},sortSelectionRowsAsc:function(n){return t(A(o,hu,!0,n,Fo),V,L,ki)},sortSelectionRowsDesc:function(n){return t(A(o,hu,!1,n,Fo),V,L,ki)},sortTableRowsAsc:function(n){return t(A(i,hu,!0,n,_o),V,L,ki)},sortTableRowsDesc:function(n){return t(A(i,hu,!1,n,_o),V,L,ki)},sortRowColumnsAsc:function(n){return t(A(c,hu,!0,n,Fo),V,L,ki)},sortRowColumnsDesc:function(n){return t(A(c,hu,!1,n,Fo),V,L,ki)},sortSelectionColumnsAsc:function(n){return t(A(S,hu,!0,n,Fo),V,L,ki)},sortSelectionColumnsDesc:function(n){return t(A(S,hu,!1,n,Fo),V,L,ki)},sortTableColumnsAsc:function(n){return t(A(T,hu,!0,n,_o),V,L,ki)},sortTableColumnsDesc:function(n){return t(A(T,hu,!1,n,_o),V,L,ki)},insertColumnBefore:t(Ti,V,Ur,ki),deleteColumn:t(Ri,function(n){return!1==("table"===en(Xt(p)))||1<Ko(n).columns},L,ki),populateColumn:function(n,e){return t(D(R,e,n,_o),V,L,Di)},populateRow:function(n,e){return t(D(O,e,n,_o),V,L,Di)}}}function wu(n){return fn(n,Ei).map(function(n){return K(n.split(","),function(n){var e=parseInt(n,10);return isNaN(e)?[]:[e]})}).getOr([])}function yu(n,e){return cn(n,Ei,Q(e).join(",")),0}function xu(n,e){var t=wu(n);p(t,e)||yu(n,t.concat([e]))}function Cu(n,e){var t=wu(n);yu(n,b(t,function(n){return e!==n}))}function Su(n){return fn(n,Ni)}function Tu(n,e){return We(Su(n).map(function(n){return n.toLowerCase()}),e.toLowerCase())}function Ru(n){return e=Ni,!(!(t=n.dom)||!t.hasAttribute)&&t.hasAttribute(e);var e,t}function Ou(n){var e,t,r,o,u,i,c,l,a,f,s,m=vi(n),d=Et.fromTable(n),v=Et.getAt(d,0,0).bind(function(n){return Wr(Fe(n.element,"width"),["fixed"])}).map(function(n){return 28-n.value}).getOr(0);e=v,t=0,r=Yr(),o=m,u=Et.fromTable(n),i=o.getCellDelta(e),c=o.getWidths(u,o),l=t===u.grid.columns-1,a=r.clampTableDelta(c,t,i,o.minCellWidth(),l),f=Jo(c,t,a,o,r),s=H(f,function(n,e){return n+c[e]}),nu(u,s,o),r.resizeTable(o.adjustTableWidth,a,l)}function Au(n,e,t,r,o){var u,i,c;i=function(){t.column(0,e.insertColumnBefore,!0,!0),Ou(n),Wi(n,e,t,r,o)},(c=q(wu(u=n),function(n){return 0===n}))&&Cu(u,0),i(),c&&xu(u,1)}function Du(n,e,t){Cu(n,0),sn(n,Ni),t.column(0,e.deleteColumn,!0,!0)}function ku(n,a){var f=function(n){var e,t=[];return u(n)?t:("thead"===(e=n).name||"tbody"===e.name||"tfoot"===e.name?t.push.apply(t,f(n.firstChild)):"tr"===n.name&&t.push(n),t.concat(f(n.next)))};n.parser.addAttributeFilter(Ni,function(n){for(var e,t=0,r=n;t<r.length;t++){var o=r[t];if("table"===o.name){var u=o.attr(Ni);if(!(!1!==(null===(e=a[u])||void 0===e?void 0:e.resizable)))for(var i=0,c=f(o.firstChild);i<c.length;i++){var l=c[i];s(l.firstChild)&&l.firstChild.attr("data-mce-resize","false")}}}})}function Eu(o,u,i,c){function l(){return rr(Kt(o),$t(o))}function r(t,r){void 0===r&&(r=V);var n=Su(t),e=n.bind(function(n){return S(c,n)});Me(n,e,function(n,e){1===Et.fromTable(t).grid.columns?l().exists(function(n){return In(t,n)})?o.execCommand("mceTableDelete"):o.undoManager.transact(function(){Lt(t)}):!0===e.update&&r()&&Wi(t,u,i,n,e)})}o.on("TableModified",function(n){var e=Tn.fromDom(n.table);r(e,function(){return!1!==n.structure})}),o.on("PreInit",function(){ku(o,c)}),o.on("init",function(){function t(){var n=Tr(Kt(o),$t(o));return o.selection.isCollapsed()&&n.exists(function(n){return o.dom.isEmpty(n.dom)})}o.on("ExecCommand",function(n){var e=n.command.toLowerCase();"delete"!==e&&"forwarddelete"!==e||!t()||l().each(r)},!0),o.on("keyup",function(n){var e=n.keyCode;8!==e&&46!==e||!t()||l().each(r)})})}function Nu(t){return function(n){var e=n.getData();n.close(),t.undoManager.transact(function(){t.execCommand("mceSortTableAdvanced",!1,e),t.focus(),t.addVisual()})}}function Wu(c,u){function t(n){var r,e;return{type:"selectbox",name:"roworcol",label:"column"===n?"Column":"Row",items:"column"===n?function(){var r=f.get().getOrDie("state must be present"),n=r.limit?r.finishCol+1-r.startCol:r.columns;return h(n,function(n){var e=r.limit?r.startCol:0,t=function(n){for(var e=n,t="";0<Math.floor(e);)--e,t+=String.fromCharCode("A".charCodeAt(0)+e%26),e/=26;return t.split("").reverse().join("")}(n+e+1);return{text:c.translate(["Column {0}",t]),value:""+(n+e)}})}():(r=f.get().getOrDie("state must be present"),e=r.limit?r.finishRow+1-r.startRow:r.rows,h(e,function(n){var e=r.limit?r.startRow:0,t=(n+e+1).toString();return{text:c.translate(["Row {0}",t]),value:""+(n+e)}}))}}function l(n){return{title:"Advanced Sort",size:"normal",body:{type:"panel",items:[{type:"grid",columns:2,items:[r,t(e=n),{type:"selectbox",name:"sort",label:"Sort",items:["column"===e?{text:"Column",value:"column"}:{text:"Row",value:"row"},{text:"Selection",value:"selection"},{text:"Table",value:"table"}]},o]}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"sort",text:"Sort",primary:!0}]};var e}function a(){f.set(nn.none())}var r={type:"selectbox",name:"sortby",label:"Sort by",items:[{text:"Column",value:"column"},{text:"Row",value:"row"}]},f=to(nn.none()),o={type:"selectbox",name:"order",label:"Order",items:[{text:"Ascending",value:"ascending"},{text:"Descending",value:"descending"}]},s=function(n,e){var t,r,o,u,i;"sortby"===e.name&&(t=n.getData(),r=f.get().getOrDie("state must be present"),o={roworcol:"column"===t.sortby?""+r.startCol:""+r.startRow},u=Rn(Rn({},t),o),i=Rn(Rn({},l(t.sortby)),{onChange:s,onClose:a,onSubmit:Nu(c),initialData:u}),n.redial(i),n.focus("sortby"))};Tr(Kt(c)).each(function(o){tr(o,c).each(function(n){function t(n){f.set(nn.some(n));var e={sortby:"column",roworcol:""+n.startCol,sort:"column",order:"ascending"},t=Rn(Rn({},l("column")),{onChange:s,onClose:a,onSubmit:Nu(c),initialData:e});c.windowManager.open(t)}var e=Zt(u,n,o),r=Ko(n);e.mergable.fold(function(){at(n,o,o).each(function(n){var e=Rn(Rn(Rn({},n),r),{limit:!1});t(e)})},function(n){var e=Rn(Rn(Rn({},n.bounds),r),{limit:!0});t(e)})})})}function Lu(o,i,n,c,u){function l(n){return"selection"===n}function a(n){return"ascending"===n}function t(n){var e,t,r,o,u=parseInt(n.roworcol,10);"column"===n.sortby?(o=u,"column"===(r=n).sort?a(r.order)?c.selection(i.sortColumnRowsAsc(o)):c.selection(i.sortColumnRowsDesc(o)):l(r.sort)?a(r.order)?c.selection(i.sortSelectionRowsAsc(o)):c.selection(i.sortSelectionRowsDesc(o)):a(r.order)?c.selection(i.sortTableRowsAsc(o)):c.selection(i.sortTableRowsDesc(o))):(t=u,"row"===(e=n).sort?a(e.order)?c.selection(i.sortRowColumnsAsc(t)):c.selection(i.sortRowColumnsDesc(t)):l(e.sort)?a(e.order)?c.selection(i.sortSelectionColumnsAsc(t)):c.selection(i.sortSelectionColumnsDesc(t)):a(e.order)?c.selection(i.sortTableColumnsAsc(t)):c.selection(i.sortTableColumnsDesc(t)))}function e(){return Tr(Kt(o),$t(o)).bind(function(e){return tr(e,o).bind(function(n){return at(n,e,e)})})}function r(){return e().map(function(n){return n.startCol})}function f(){return e().map(function(n){return n.startRow})}o.addCommand("mceSortTableByColumnAsc",function(){r().each(function(n){c.selection(i.sortTableRowsAsc(n))})}),o.addCommand("mceSortTableByColumnDesc",function(){r().each(function(n){c.selection(i.sortTableRowsDesc(n))})}),o.addCommand("mceSortTableByRowAsc",function(){f().each(function(n){c.selection(i.sortTableColumnsAsc(n))})}),o.addCommand("mceSortTableByRowDesc",function(){f().each(function(n){c.selection(i.sortTableColumnsDesc(n))})}),o.addCommand("mceSortTableAdvanced",function(n,e){return t(e)}),o.addCommand("mceAdvancedTableSort",function(){return Wu(o,n)}),Ut(tinymce,"5.9.1")||o.addCommand("mceTableToggleSeries",function(n,e){var t=nn.from(e.name).filter(I),r=rr(Kt(o),$t(o));Me(t,r,function(e,t){Tu(t,e)?Du(t,i,c):S(u,e).each(function(n){(Ru(t)?Wi:Au)(t,i,c,e,n)})})})}function Mu(n,r){function e(){return Sr(Tn.fromDom(n.selection.getEnd()),$t(n))}function t(){return Sr(Kt(n),$t(n)).bind(function(t){return je(Me(Ye(t),e().bind(Ye),function(n,e){return In(n,e)?s(t)?nn.some(nr(t)):nn.some(Zt(r,n,t)):nn.none()}))})}function o(i){return Ye(i.element).map(function(n){var e,t,r=Et.fromTable(n),o=Fo(r,i).getOr([]),u=$(o,function(n,e){return e.isLocked&&(n.onAny=!0,0===e.column?n.onFirst=!0:e.column+e.colspan>=r.grid.columns&&(n.onLast=!0)),n},{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:(t=r,i.mergable.filter(function(n){return Vo(t,n.cells)}).isSome()),unmergeable:(e=r,i.unmergable.filter(function(n){return Vo(e,n)}).isSome()),locked:u}})}function u(){l.set(An(t)()),f=l.get().bind(o),G(a.get(),function(n){return n()})}function i(e){return e(),a.set(a.get().concat([e])),function(){a.set(b(a.get(),function(n){return n!==e}))}}function c(e,t){return i(function(){return l.get().fold(function(){e.setDisabled(!0)},function(n){e.setDisabled(t(n))})})}var l=to(nn.none()),a=to([]),f=nn.none(),s=on("caption");return n.on("NodeChange ExecCommand TableSelectorChange",u),{onSetupTable:function(n){return c(n,function(n){return!1})},onSetupCellOrRow:function(n){return c(n,function(n){return s(n.element)})},onSetupColumn:function(t){return function(n){return c(n,function(n){return s(n.element)||(e=t,f.exists(function(n){return n.locked[e]}));var e})}},onSetupCellOrRowToggle:function(o){return function(n){return e=n,t=function(n){return s(n.element)},r=o,i(function(){return l.get().fold(function(){e.setDisabled(!0),e.setActive(!1)},function(n){e.setDisabled(t(n)),e.setActive(r(n))})});var e,t,r}},resetTargets:u,targets:function(){return l.get()}}}function ju(n){return rr(Kt(n),$t(n))}function Iu(n,e){n.execCommand("mceTableToggleSeries",!1,e)}function zu(n,e,t){return e.onSetupCellOrRowToggle(function(){return e=t,ju(n).exists(function(n){return Nn(e)?!Ru(n):Tu(n,e)});var e})}function Pu(e,n){return{type:"togglemenuitem",text:"None",onAction:function(){ju(e).bind(Su).each(function(n){Iu(e,{name:n})})},onSetup:zu(e,n,"")}}function Bu(n,e,t,r,o){return{type:"togglemenuitem",text:t,value:r,icon:o,onAction:function(){return Iu(n,{name:r})},onSetup:zu(n,e,r)}}function _u(r,o,n){return Z(n,function(n,e){var t=nn.from(n.title).getOrThunk(function(){return""===(n=e)?"":n.charAt(0).toUpperCase()+n.substring(1);var n});return Bu(r,o,t,e)})}function Fu(t,n,r){function e(n,e){return function(){return t.execCommand(n,!1,e)}}var o=r.onSetupCellOrRow,u=[{type:"menuitem",text:"Sort table by column ascending",onAction:e("mceSortTableByColumnAsc"),onSetup:o},{type:"menuitem",text:"Sort table by column descending",onAction:e("mceSortTableByColumnDesc"),onSetup:o},{type:"separator"},{type:"menuitem",text:"Advanced sort...",onAction:function(){return Wu(t,n)},onSetup:o}];t.ui.registry.addNestedMenuItem("advtablesort",{type:"nestedmenuitem",text:"Sort",getSubmenuItems:M(u)});var i,c=vu(t);1===C(c)?(i=k(c)[0],t.ui.registry.addToggleMenuItem("advtablerownumbering",Bu(t,r,"Row numbering",i,"table-row-numbering"))):T(c)||t.ui.registry.addNestedMenuItem("advtablerownumbering",{type:"nestedmenuitem",text:"Row numbering",icon:"table-row-numbering",getSubmenuItems:function(){var n=Pu(t,r),e=_u(t,r,c);return[n].concat(e)}})}var Vu,qu,Hu,Gu,Uu=Lr("height",function(n){var e=n.dom;return Se(n)?e.getBoundingClientRect().height:e.offsetHeight}),Xu=Lr("width",function(n){return n.dom.offsetWidth}),$u=/(\d+(\.\d+)?)%/,Ku=/(\d+(\.\d+)?)px|em/,Qu=M($u),Yu=M(Ku),Ju=on("col"),Zu=on("colgroup"),ni=function(o,u){void 0===u&&(u=$r);function r(n){if(Xr(n))return Zu((t={element:n}).element)?o.colgroup(t):o.row(t);var e,t,r=(e=u(n),Ju(e.element)?o.col(e):o.cell(e));return i=nn.some({item:n,replacement:r}),r}var i=nn.none();return{getOrInit:function(e,t){return i.fold(function(){return r(e)},function(n){return t(e,n.item)?n.replacement:r(e)})}}},ei=Qr(function(n){return n<0}),ti=Qr(V),ri=(on("th"),function(){return{transformRow:j,transformCell:eo}}),oi=function(n,e,t){var r=n();return w(r,e).orThunk(function(){return nn.from(r[0]).orThunk(t)}).map(function(n){return n.element})},ui=function(n){return"rtl"===Fe(n,"direction")?"rtl":"ltr"},ii=function(t,r){return{left:t,top:r,translate:function(n,e){return ii(t+n,r+e)}}},ci=ii,li=function(n){var e,t=n.dom,r=t.ownerDocument.body;return r===t?ci(r.offsetLeft,r.offsetTop):Se(n)?(e=t.getBoundingClientRect(),ci(e.left,e.top)):ci(0,0)},ai=function(n){return ho(go,po,n)},fi=(Vu={delta:j,edge:fo,positions:function(n){return ho(so,mo,n)}},qu={delta:function(n){return-n},edge:ao,positions:function(n){return ho(mo,so,n)}},function(n){return"rtl"===ui(n)?qu:Vu}),si=function(n,e){return fi(e).positions(n,e)},mi=function(n){return fi(n).edge(n)},di=on("col"),vi=function(e){return Fr(e).fold(function(){return Co(e)},function(n){return function(n,e){var t=Qu().exec(e);if(null!==t)return So(t[1],n);var r=Yu().exec(e);if(null!==r){var o=parseInt(r[1],10);return To(o,n)}var u=jr(n);return To(u,n)}(e,n)})},gi=(Hu="ephox-snooker".replace(/\./g,"-"),{resolve:function(n){return Hu+"-"+n}}).resolve,pi=gi("resizer-bar"),hi=gi("resizer-rows"),bi=gi("resizer-cols"),wi=["img","br"],yi={scope:["row","col"]},xi=function(n){return n.dom.contentEditable},Ci=vr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Si=Rn({},Ci),Ti=Bo(function(n,e,t,r){var o=e.detail,u=o.column,i=o.column,c=Yo(n,i,u,t,r.getOrInit);return ou(c,o.row,i)},function(e,n){return _o(e,n).filter(function(n){return!(Gu?iu:cu)(e,[n])}).map(function(n){return{detail:n,pixelDelta:lu(e,[n])}})},uu,L,ni),Ri=Bo(function(n,e,t,r){var o,u,i=eu(e.details),c=(o=n,u=H(i,function(n){return n.column}),K(o,function(n){var e=n.cells,t=m(u,function(n,e){return 0<=e&&e<n.length?n.slice(0,e).concat(n.slice(e+1)):n},e);return 0<t.length?[Zn(n.element,t,n.section,n.isNew)]:[]})),l=0<c.length?c[0].cells.length-1:0;return ou(c,i[0].row,Math.min(i[0].column,l))},function(e,n){return Po(e,n,function(n){return!n.isLocked}).map(function(n){return{details:n,pixelDelta:-lu(e,n)}})},uu,function(n){0===Ke(n).length&&Lt(n)},ni),Oi=on("th"),Ai=function(n){var e=b(n,function(n){return Oi(n.element)});return 0===e.length?nn.some("td"):e.length===n.length?nn.some("th"):nn.none()},Di={structure:!(Gu=!0),style:!0},ki={structure:!0,style:!1},Ei="data-snooker-locked-cols",Ni="data-snooker-col-series",Wi=function(n,e,t,r,o){t.table(n,0,0,e.populateColumn(0,function(n,e,t){var r=o.generator(n,e,t);return{raw:r,value:r.value,classes:r.classes,attributes:Rn(Rn({contenteditable:"false"},r.attributes),{"data-mce-resize":!1===o.resizable?"false":null})}}),!0,!0),cn(n,Ni,r),xu(n,0)};tinymce.PluginManager.requireLangPack("advtable","ar,bg_BG,ca,cs,da,de,el,es,eu,fa,fi,fr_FR,he_IL,hr,hu_HU,id,it,ja,kk,ko_KR,nb_NO,nl,pl,pt_BR,pt_PT,ro,ru,sk,sl_SI,sv_SE,th_TH,tr,uk,zh_CN,zh_TW"),tinymce.PluginManager.add("advtable",function(n){var e,t,r,o,u,i,c,l,a,f,s,m,d,v,g;return Ut(tinymce,"5.1.2")?console.error("Please use Advanced Tables with TinyMCE 5.1.2 or later."):(v="table",g=n.getParam("plugins","","string"),p(g.split(/[ ,]/),v)?(e=Re(Cr,L,L),t=bu(n,e,function(){return n.plugins.table}),s=function(){return Xt(n)},m=function(){return Tr(Kt(n),$t(n))},d=Cr.selectedSelector,o=Mu(n,r={get:function(){return Bt(s(),d).fold(function(){return m().fold(pr,br)},function(n){return hr(n)})}}),u=or(n,r),i=vu(n),Lu(n,t,r,u,i),Fu(n,r,o),l=o,f=vu(c=n),1===C(f)?(a=k(f)[0],c.ui.registry.addToggleButton("advtablerownumbering",{type:"togglebutton",tooltip:"Row numbering",icon:"table-row-numbering",onAction:function(){return Iu(c,{name:a})},onSetup:zu(c,l,a)})):T(f)||c.ui.registry.addMenuButton("advtablerownumbering",{type:"menubutton",icon:"table-row-numbering",tooltip:"Row numbering",fetch:function(n){var e=Pu(c,l),t=_u(c,l,f);return n([e].concat(t))},onSetup:l.onSetupCellOrRow}),Ut(tinymce,"5.9.1")||Eu(n,t,u,i)):console.log("Please use the Advanced Tables Plugin together with the Tables plugin.")),{}})}();