/*!
 * Tiny Comments plugin
 *
 * Copyright 2010-2021 Tiny Technologies, Inc. All rights reserved.
 *
 * Version: 2.4.0-121
 */
!function(){"use strict";function h(){}function i(t,o){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(o.apply(null,n))}}function y(n){return function(){return n}}function f(n){return n}function d(o){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=r.concat(n);return o.apply(null,t)}}function u(n){return function(){throw new Error(n)}}var s=y(!1),v=y(!0),_=y("dismiss.popups"),l=y("reposition.popups"),n=function(){return c},c={fold:function(n,e){return n()},is:s,isSome:s,isNone:v,getOr:o,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:y(null),getOrUndefined:y(void 0),or:o,orThunk:t,map:n,each:h,bind:n,exists:s,forall:v,filter:n,equals:e,equals_:e,toArray:function(){return[]},toString:y("none()")};function e(n){return n.isNone()}function t(n){return n()}function o(n){return n}function r(n){if(null===n)return"null";if(void 0===n)return"undefined";var e=typeof n;return"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}function a(r){return j(function(n,e){if(n.length!==e.length)return!1;for(var t=n.length,o=0;o<t;o++)if(!r.eq(n[o],e[o]))return!1;return!0})}function m(n,t){return o=a(n),r=function(n){return e=n,n=t,Array.prototype.slice.call(e).sort(n);var e},j(function(n,e){return o.eq(r(n),r(e))});var o,r}function g(n){return!(null==n)}function w(n,e){return n=n,e=e,-1<J.call(n,e)}function p(n,e){for(var t=0,o=n.length;t<o;t++){if(e(n[t],t))return!0}return!1}function x(n,e){for(var t=n.length,o=new Array(t),r=0;r<t;r++){var i=n[r];o[r]=e(i,r)}return o}function O(n,e){for(var t=0,o=n.length;t<o;t++){e(n[t],t)}}function S(n,e){for(var t=[],o=0,r=n.length;o<r;o++){var i=n[o];e(i,o)&&t.push(i)}return t}function b(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--){e(n[t],t)}}(n,function(n){t=e(t,n)}),t}function E(n,e,t){return O(n,function(n){t=e(t,n)}),t}function C(n,e){return function(n,e,t){for(var o=0,r=n.length;o<r;o++){var i=n[o];if(e(i,o))return P.some(i);if(t(i,o))break}return P.none()}(n,e,s)}function k(n,e){for(var t=0,o=n.length;t<o;t++){if(e(n[t],t))return P.some(t)}return P.none()}function T(n){for(var e=[],t=0,o=n.length;t<o;++t){if(!G(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);$.apply(e,n[t])}return e}function M(n,e){return T(x(n,e))}function R(n,e){for(var t=0,o=n.length;t<o;++t){if(!0!==e(n[t],t))return!1}return!0}function A(n){return(n=X.call(n,0)).reverse(),n}function D(n,e){return S(n,function(n){return!w(e,n)})}function F(n){return 0===n.length?P.none():P.some(n[0])}function N(n,e){for(var t=0;t<n.length;t++){var o=e(n[t],t);if(o.isSome())return o}return P.none()}var B=function(t){function n(){return r}function e(n){return n(t)}var o=y(t),r={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:v,isNone:s,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(n){return B(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?r:c},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(s,function(n){return e(t,n)})}};return r},P={some:B,none:n,from:function(n){return null==n?c:B(n)}},H=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},I={fromHtml:function(n,e){e=(e||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return H(e.childNodes[0])},fromTag:function(n,e){n=(e||document).createElement(n);return H(n)},fromText:function(n,e){n=(e||document).createTextNode(n);return H(n)},fromDom:H,fromPoint:function(n,e,t){return P.from(n.dom.elementFromPoint(e,t)).map(H)}},j=function(n){return{eq:n}},V=j(function(n,e){return n===e}),L=j(function(n,e){if(n===e)return!0;var c,t=r(n);return t===r(e)&&(-1!==["undefined","boolean","number","string","function","xml","null"].indexOf(t)?n===e:"array"===t?a(L).eq(n,e):"object"===t&&(c=L,j(function(n,e){var t=Object.keys(n),o=Object.keys(e);if(!m(V).eq(t,o))return!1;for(var r=t.length,i=0;i<r;i++){var u=t[i];if(!c.eq(n[u],e[u]))return!1}return!0}).eq(n,e)))}),W=function(t){return function(n){return n=typeof(e=n),(null===e?"null":"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n)===t;var e}},U=function(e){return function(n){return typeof n===e}},z=W("string"),q=W("object"),G=W("array"),Y=U("boolean"),K=U("function"),Q=U("number"),X=Array.prototype.slice,J=Array.prototype.indexOf,$=Array.prototype.push,Z=function(){return(Z=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}).apply(this,arguments)};function nn(n,e){var t={};for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t}function en(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var o=Array(n),r=0,e=0;e<t;e++)for(var i=arguments[e],u=0,c=i.length;u<c;u++,r++)o[r]=i[u];return o}function tn(t){var o,r=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r||(r=!0,o=t.apply(null,n)),o}}function on(n,e){var t=String(e).toLowerCase();return C(n,function(n){return n.search(t)})}function rn(n,e){return-1!==n.indexOf(e)}function un(n){return window.matchMedia(n).matches}function cn(n,e){if(1!==(n=n.dom).nodeType)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function an(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount}function sn(n,e){return n.dom===e.dom}function fn(n){return n.dom.nodeName.toLowerCase()}function ln(n){return I.fromDom(n.dom.ownerDocument)}function dn(n){return ne(n)?n:ln(n)}function mn(n){return I.fromDom(dn(n).dom.defaultView)}function gn(n){return P.from(n.dom.parentNode).map(I.fromDom)}function pn(n){return x(n.dom.childNodes,I.fromDom)}function vn(n,e){return n=n.dom.childNodes,P.from(n[e]).map(I.fromDom)}function hn(n){return vn(n,0)}function bn(n){return n=ie(n),ee(n)?P.some(n):P.none()}function yn(n){return I.fromDom(n.dom.host)}function _n(n){function e(){return n.stopPropagation()}function t(){return n.preventDefault()}var o=I.fromDom(function(n){if(re()&&g(n.target)){var e=I.fromDom(n.target);if($n(e)&&ue(e)&&n.composed&&n.composedPath){e=n.composedPath();if(e)return F(e)}}return P.from(n.target)}(n).getOr(n.target)),r=i(t,e);return{target:o,x:n.clientX,y:n.clientY,stop:e,prevent:t,kill:r,raw:n}}function wn(n,e,t,o,r){var i,u,o=(i=t,u=o,function(n){i(n)&&u(_n(n))});return n.dom.addEventListener(e,o,r),{unbind:d(ce,n,e,o,r)}}function xn(n,e,t){return wn(n,e,ae,t,!1)}function On(n,e,t){return wn(n,e,ae,t,!0)}function Sn(e,t){gn(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})}function En(e,t){hn(e).fold(function(){se(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})}var Cn,kn,Tn=function(){return Mn(0,0)},Mn=function(n,e){return{major:n,minor:e}},Rn={nu:Mn,detect:function(n,e){e=String(e).toLowerCase();return 0===n.length?Tn():function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var o=n[t];if(o.test(e))return o}}(n,e);if(!t)return{major:0,minor:0};n=function(n){return Number(e.replace(t,"$"+n))};return Mn(n(1),n(2))}(n,e)},unknown:Tn},An=function(n,t){return on(n,t).map(function(n){var e=Rn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Dn=function(n,t){return on(n,t).map(function(n){var e=Rn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Fn=(Cn=/^\s+|\s+$/g,function(n){return n.replace(Cn,"")}),Nn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Bn=function(e){return function(n){return rn(n,e)}},Pn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return rn(n,"edge/")&&rn(n,"chrome")&&rn(n,"safari")&&rn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Nn],search:function(n){return rn(n,"chrome")&&!rn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return rn(n,"msie")||rn(n,"trident")}},{name:"Opera",versionRegexes:[Nn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Bn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Bn("firefox")},{name:"Safari",versionRegexes:[Nn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(rn(n,"safari")||rn(n,"mobile/"))&&rn(n,"applewebkit")}}],Hn=[{name:"Windows",search:Bn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return rn(n,"iphone")||rn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Bn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Bn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Bn("linux"),versionRegexes:[]},{name:"Solaris",search:Bn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Bn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Bn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],In={browsers:y(Pn),oses:y(Hn)},jn="Firefox",Vn=function(n){var e=n.current,t=n.version,n=function(n){return function(){return e===n}};return{current:e,version:t,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(jn),isSafari:n("Safari")}},Ln={unknown:function(){return Vn({current:void 0,version:Rn.unknown()})},nu:Vn,edge:y("Edge"),chrome:y("Chrome"),ie:y("IE"),opera:y("Opera"),firefox:y(jn),safari:y("Safari")},Wn="Windows",Un="Android",zn="Solaris",qn="FreeBSD",Gn="ChromeOS",Yn=function(n){var e=n.current,t=n.version,n=function(n){return function(){return e===n}};return{current:e,version:t,isWindows:n(Wn),isiOS:n("iOS"),isAndroid:n(Un),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(zn),isFreeBSD:n(qn),isChromeOS:n(Gn)}},Kn={unknown:function(){return Yn({current:void 0,version:Rn.unknown()})},nu:Yn,windows:y(Wn),ios:y("iOS"),android:y(Un),linux:y("Linux"),osx:y("OSX"),solaris:y(zn),freebsd:y(qn),chromeos:y(Gn)},Qn=function(n,e){var t,o,r=In.browsers(),i=In.oses(),u=An(r,n).fold(Ln.unknown,Ln.nu),c=Dn(i,n).fold(Kn.unknown,Kn.nu);return{browser:u,os:c,deviceType:(t=u,o=n,r=e,u=(i=c).isiOS()&&!0===/ipad/i.test(o),n=i.isiOS()&&!u,e=i.isiOS()||i.isAndroid(),c=e||r("(pointer:coarse)"),r=u||!n&&e&&r("(min-device-width:768px)"),e=n||e&&!r,t=t.isSafari()&&i.isiOS()&&!1===/safari/i.test(o),o=!e&&!r&&!t,{isiPad:y(u),isiPhone:y(n),isTablet:y(r),isPhone:y(e),isTouch:y(c),isAndroid:i.isAndroid,isiOS:i.isiOS,isWebView:y(t),isDesktop:y(o)})}},Xn=tn(function(){return Qn(navigator.userAgent,un)}),Jn=("undefined"!=typeof window||Function("return this;")(),function(e){return function(n){return n.dom.nodeType===e}}),$n=Jn(1),Zn=Jn(3),ne=Jn(9),ee=Jn(11),te=gn,oe=K(Element.prototype.attachShadow)&&K(Node.prototype.getRootNode),re=y(oe),ie=oe?function(n){return I.fromDom(n.dom.getRootNode())}:dn,ue=function(n){return g(n.dom.shadowRoot)},ce=function(n,e,t,o){n.dom.removeEventListener(e,t,o)},ae=v,se=function(n,e){n.dom.appendChild(e.dom)};(oc=kn=kn||{})[oc.Modern=0]="Modern",oc[oc.Silver=1]="Silver";function fe(n){var e=n;return{get:function(){return e},set:function(n){e=n}}}var le,de,me,ge,pe={},ve={exports:pe};de=pe,me=ve,ge=le=void 0,function(n){"object"==typeof de&&void 0!==me?me.exports=n():"function"==typeof le&&le.amd?le([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function o(r,i,u){function c(e,n){if(!i[e]){if(!r[e]){var t="function"==typeof ge&&ge;if(!n&&t)return t(e,!0);if(a)return a(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}t=i[e]={exports:{}},r[e][0].call(t.exports,function(n){return c(r[e][1][n]||n)},t,t.exports,o,r,i,u)}return i[e].exports}for(var a="function"==typeof ge&&ge,n=0;n<u.length;n++)c(u[n]);return c}({1:[function(n,e,t){var o,r,e=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function c(e){if(o===setTimeout)return setTimeout(e,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(n){try{return o.call(null,e,0)}catch(n){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(n){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(n){r=u}}();var a,s=[],f=!1,l=-1;function d(){f&&a&&(f=!1,a.length?s=a.concat(s):l=-1,s.length&&m())}function m(){if(!f){var n=c(d);f=!0;for(var e=s.length;e;){for(a=s,s=[];++l<e;)a&&a[l].run();l=-1,e=s.length}a=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(n){try{return r.call(null,e)}catch(n){return r.call(this,e)}}}(n)}}function g(n,e){this.fun=n,this.array=e}function p(){}e.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];s.push(new g(n,e)),1!==s.length||f||c(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.prependListener=p,e.prependOnceListener=p,e.listeners=function(n){return[]},e.binding=function(n){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(n){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],2:[function(n,l,e){(function(e){function o(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(n,this)}function r(t,o){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var n,e=1===t._state?o.onFulfilled:o.onRejected;if(null!==e){try{n=e(t._value)}catch(n){return void c(o.promise,n)}u(o.promise,n)}else(1===t._state?u:c)(o.promise,t._value)})):t._deferreds.push(o)}function u(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof i)return e._state=3,e._value=n,void a(e);if("function"==typeof t)return void f((o=t,r=n,function(){o.apply(r,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var o,r}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)r(n,n._deferreds[e]);n._deferreds=null}function s(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function f(n,e){var t=!1;try{n(function(n){t||(t=!0,u(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){if(t)return;t=!0,c(e,n)}}var n,t;n=this,t=setTimeout,i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var t=new this.constructor(o);return r(this,new s(n,e,t)),t},i.all=function(n){var c=Array.prototype.slice.call(n);return new i(function(r,i){if(0===c.length)return r([]);var u=c.length;for(var n=0;n<c.length;n++)!function e(t,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var o=n.then;if("function"==typeof o)return void o.call(n,function(n){e(t,n)},i)}c[t]=n,0==--u&&r(c)}catch(n){i(n)}}(n,c[n])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(t){return new i(function(n,e){e(t)})},i.race=function(r){return new i(function(n,e){for(var t=0,o=r.length;t<o;t++)r[t].then(n,e)})},i._immediateFn="function"==typeof e?function(n){e(n)}:function(n){t(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==l&&l.exports?l.exports=i:n.Promise||(n.Promise=i)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,s){(function(n,e){var o=a("process/browser.js").nextTick,t=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function c(n,e){this._id=n,this._clearFn=e}s.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},s.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},s._unrefActive=s.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},s.setImmediate="function"==typeof n?n:function(n){var e=u++,t=!(arguments.length<2)&&r.call(arguments,1);return i[e]=!0,o(function(){i[e]&&(t?n.apply(null,t):n.call(null),s.clearImmediate(e))}),e},s.clearImmediate="function"==typeof e?e:function(n){delete i[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var o=n("promise-polyfill"),n="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:n.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)});function he(n){setTimeout(function(){throw n},0)}function be(n){return Ye(We(n))}function ye(n,t){return Ze(n,function(n,e){return{k:e,v:t(n,e)}})}function _e(n,e){var t,o,r,i,u={};return t=e,i=u,o=function(n,e){i[e]=n},r=h,$e(n,function(n,e){(t(n,e)?o:r)(n,e)}),u}function we(n,e){return tt(n,e)&&void 0!==n[e]&&null!==n[e]}function xe(n,e,t){if(!(z(t)||Y(t)||Q(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}function Oe(n,e,t){xe(n.dom,e,t)}function Se(n,e){return null===(e=n.dom.getAttribute(e))?void 0:e}function Ee(n,e){return P.from(Se(n,e))}function Ce(n,e){return!(!(n=n.dom)||!n.hasAttribute)&&n.hasAttribute(e)}function ke(n,e){n.dom.removeAttribute(e)}function Te(n,e){return void 0===(e=Se(n,e))||""===e?[]:e.split(" ")}function Me(n){return void 0!==n.dom.classList}function Re(n,e){return function(n,e,t){t=Te(n,e).concat([t]);return Oe(n,e,t.join(" ")),!0}(n,"class",e)}function Ae(n,e){return o=e,0<(n=S(Te(t=n,e="class"),function(n){return n!==o})).length?Oe(t,e,n.join(" ")):ke(t,e),0;var t,o}function De(n,e){Me(n)?n.dom.classList.add(e):Re(n,e)}function Fe(n){0===(Me(n)?n.dom.classList:Te(n,"class")).length&&ke(n,"class")}function Ne(n,e){Me(n)?n.dom.classList.remove(e):Ae(n,e),Fe(n)}function Be(n,e){return Me(n)&&n.dom.classList.contains(e)}function Pe(n,e){return function(n,e){e=void 0===e?document:e.dom;return an(e)?[]:x(e.querySelectorAll(n),I.fromDom)}(e,n)}var He,Ie=ve.exports.boltExport,je=function(n){var t=P.none(),e=[],o=function(n){r()?u(n):e.push(n)},r=function(){return t.isSome()},i=function(n){O(n,u)},u=function(e){t.each(function(n){setTimeout(function(){e(n)},0)})};return n(function(n){r()||(t=P.some(n),i(e),e=[])}),{get:o,map:function(t){return je(function(e){o(function(n){e(t(n))})})},isReady:r}},Ve={nu:je,pure:function(e){return je(function(n){n(e)})}},Le=function(t){function n(n){t().then(n,he)}return{map:function(n){return Le(function(){return t().then(n)})},bind:function(e){return Le(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return Le(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return Ve.nu(n)},toCached:function(){var n=null;return Le(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},We=function(n){return Le(function(){return new Ie(n)})},Ue=function(n){return Le(function(){return Ie.resolve(n)})},ze=function(t){return{is:function(n){return t===n},isValue:v,isError:s,getOr:y(t),getOrThunk:y(t),getOrDie:y(t),or:function(n){return ze(t)},orThunk:function(n){return ze(t)},fold:function(n,e){return e(t)},map:function(n){return ze(n(t))},mapError:function(n){return ze(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return P.some(t)}}},qe=function(t){return{is:s,isValue:s,isError:v,getOr:f,getOrThunk:function(n){return n()},getOrDie:function(){return u(String(t))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return qe(t)},mapError:function(n){return qe(n(t))},each:h,bind:function(n){return qe(t)},exists:s,forall:v,toOptional:P.none}},Ge={value:ze,error:qe,fromOption:function(n,e){return n.fold(function(){return qe(e)},ze)}},Ye=function(i){return Z(Z({},i),{toCached:function(){return Ye(i.toCached())},bindFuture:function(e){return Ye(i.bind(function(n){return n.fold(function(n){return Ue(Ge.error(n))},function(n){return e(n)})}))},bindResult:function(e){return Ye(i.map(function(n){return n.bind(e)}))},mapResult:function(e){return Ye(i.map(function(n){return n.map(e)}))},mapError:function(e){return Ye(i.map(function(n){return n.mapError(e)}))},foldResult:function(e,t){return i.map(function(n){return n.fold(e,t)})},withTimeout:function(n,r){return Ye(We(function(e){var t=!1,o=setTimeout(function(){t=!0,e(Ge.error(r()))},n);i.get(function(n){t||(clearTimeout(o),e(n))})}))}})},Ke=function(n){return Ye(Ue(Ge.value(n)))},Qe={nu:be,wrap:Ye,pure:Ke,value:Ke,error:function(n){return Ye(Ue(Ge.error(n)))},fromResult:function(n){return Ye(Ue(n))},fromFuture:function(n){return Ye(n.map(Ge.value))},fromPromise:function(n){return be(function(e){n.then(function(n){e(Ge.value(n))},function(n){e(Ge.error(n))})})}},Xe=Object.keys,Je=Object.hasOwnProperty,$e=function(n,e){for(var t=Xe(n),o=0,r=t.length;o<r;o++){var i=t[o];e(n[i],i)}},Ze=function(n,t){var o={};return $e(n,function(n,e){e=t(n,e);o[e.k]=e.v}),o},nt=function(n,t){var o=[];return $e(n,function(n,e){o.push(t(n,e))}),o},et=function(n,e){return tt(n,e)?P.from(n[e]):P.none()},tt=function(n,e){return Je.call(n,e)},ot=function(n){var e=Zn(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var t,o,r=e.ownerDocument;return bn(I.fromDom(e)).fold(function(){return r.body.contains(e)},(t=ot,o=yn,function(n){return t(o(n))}))},rt=y("tox-comment--active"),it=y("data-mce-annotation"),ut=y("tinycomments");(rc=He=He||{})[rc.Change=0]="Change",rc[rc.NoChange=1]="NoChange";function ct(e,i,t,u){function o(n,e){t.notificationManager.open({text:n,type:"error"}),e&&console.error(n,e)}function c(n,e){return{view:{type:"splash"},grabFocus:function(){return 1===n||e}}}function r(n,r){i.set(n),i.get().fold(function(){return Qe.pure({response:He.Change,update:c(r,u.hasFocus())})},function(n){return e.lookup({conversationUid:n}).foldResult(function(){return Ge.value({response:He.Change,update:c(r,u.hasFocus())})},function(e){var n,t,o=i.get().forall(function(n){return n!==e.conversation.uid});return Ge.value(o?{response:He.NoChange}:{response:He.Change,update:(n=r,t=u.hasFocus(),{view:{type:"comments",conversation:e.conversation},grabFocus:function(){return t||w([1,3,4],n)}})})})}).get(function(n){return n.fold(function(n){o("An error occurred reading the conversation. See the Console for details.",n)},function(n){n.response===He.Change&&(u.update(n.update),l())})})}function a(){var n="."+rt(),e=I.fromDom(t.getBody()),n=Pe(e,n);O(n,function(n){Ne(n,rt())})}function s(n){f.set(n),u.setReadonly(n)}var f=fe(!1),l=function(){var n,e;return s(i.get().isNone()&&(n=t.selection.getRng(),e=Pe(I.fromDom(n.commonAncestorContainer),"["+it()+'="'+ut()+'"]'),p(e,d(function(n,e,t){e=e.createRange();return e.selectNode(t.dom),e.compareBoundaryPoints(window.Range.END_TO_START,n)<0&&0<e.compareBoundaryPoints(window.Range.START_TO_END,n)},n,t.getDoc())))),f.get()};return{refreshSidebar:r,refreshView:function(n){n.fold(function(){a(),r(P.none(),0)},function(n){var e=n.uid,n=n.nodes;n=n,a(),O(n,function(n){De(n,rt())}),r(P.some(e),0)})},setReadonly:s,showError:o,refreshReadonly:l}}var at;(ic=at=at||{})[ic.Error=0]="Error",ic[ic.Value=1]="Value";function st(n,e,t){return n.stype===at.Error?e(n.serror):t(n.svalue)}function ft(n){return{stype:at.Value,svalue:n}}function lt(n){return{stype:at.Error,serror:n}}function dt(n){return Do.defaultedThunk(y(n))}function mt(n,e){var t={};return t[n]=e,t}function gt(n){return e={},O(n,function(n){e[n.key]=n.value}),e;var e}function pt(n,e){var t,o,r;return 0<(r=(t=[],o=[],O(n,function(n){n.fold(function(n){t.push(n)},function(n){o.push(n)})}),{errors:t,values:o})).errors.length?(n=r.errors,Ge.error(T(n))):(e=e,0===(r=r.values).length?Ge.value(e):Ge.value(Ro(e,Ao.apply(void 0,r))))}function vt(n){return i(xo,T)(n)}function ht(n){return q(n)&&100<Xe(n).length?" removed due to size":JSON.stringify(n,null,2)}function bt(n,e){return xo([{path:n,getErrorInfo:e}])}function yt(t,o,r){return et(o,r).fold(function(){return n=r,e=o,bt(t,function(){return'Could not find valid *strict* value for "'+n+'" in '+ht(e)});var n,e},_o)}function _t(n,e,t){return e=et(n,e).fold(function(){return t(n)},f),_o(e)}function wt(u,c,n,a){return n.fold(function(t,e,n,o){function r(n){return n=o.extract(u.concat([t]),a,n),Eo(n,function(n){return mt(e,a(n))})}function i(n){return n.fold(function(){var n=mt(e,a(P.none()));return _o(n)},function(n){n=o.extract(u.concat([t]),a,n);return Eo(n,function(n){return mt(e,a(P.some(n)))})})}return n.fold(function(){return Oo(yt(u,c,t),r)},function(n){return Oo(_t(c,t,n),r)},function(){return Oo(_o(et(c,t)),i)},function(n){return Oo(function(e,n,t){n=et(e,n).map(function(n){return!0===n?t(e):n});return _o(n)}(c,t,n),i)},function(n){var e=n(c),n=Eo(_t(c,t,y({})),function(n){return Ro(e,n)});return Oo(n,r)})},function(n,e){e=e(c);return _o(mt(n,a(e)))})}function xt(o){return{extract:function(t,n,e){return So(o(e,n),function(n){return e=n,bt(t,function(){return e});var e})},toString:function(){return"val"}}}function Ot(n){var i=Lo(n),u=b(n,function(e,n){return n.fold(function(n){return Ro(e,Ho(n,!0))},y(e))},{});return{extract:function(n,e,t){var o,r=Y(t)?[]:Xe(_e(t,function(n){return null!=n})),r=S(r,function(n){return!we(u,n)});return 0===r.length?i.extract(n,e,t):(o=r,bt(n,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:i.toString}}function St(t,r){function i(n,e){return r=xt(t),function(t,o,n){n=x(n,function(n,e){return r.extract(t.concat(["["+e+"]"]),o,n)});return jo(n)}(n,f,e);var r}return{extract:function(e,t,o){var n=Xe(o),n=i(e,n);return Oo(n,function(n){n=x(n,function(n){return Vo.field(n,n,Fo(),r)});return Lo(n).extract(e,t,o)})},toString:function(){return"setOf("+r.toString()+")"}}}function Et(t,e,o,r,i){return et(r,i).fold(function(){return n=r,e=i,bt(t,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+ht(n)});var n,e},function(n){return n.extract(t.concat(["branch: "+i]),e,o)})}function Ct(r,i){return{extract:function(e,t,o){return et(o,r).fold(function(){return n=r,bt(e,function(){return'Choice schema did not contain choice key: "'+n+'"'});var n},function(n){return Et(e,t,o,i,n)})},toString:function(){return"chooseOn("+r+"). Possible values: "+Xe(i)}}}function kt(e){return xt(function(n){return e(n).fold(xo,_o)})}function Tt(n,e,t){return yo(function(n,e,t,o){t=e.extract([n],t,o);return Co(t,function(n){return{input:o,errors:n}})}(n,e,f,t))}function Mt(n){return n.fold(function(n){throw new Error(Yo(n))},f)}function Rt(n,e,t){return Mt(Tt(n,e,t))}function At(n,e){return Ct(n,ye(e,Lo))}function Dt(n){return zo(n,n,Fo(),Wo())}function Ft(n,e){return zo(n,n,Fo(),e)}function Nt(n,e){return zo(n,n,Fo(),Lo(e))}function Bt(n){return zo(n,n,No(),Wo())}function Pt(n,e){return zo(n,n,No(),e)}function Ht(n,e){return Pt(n,Lo(e))}function It(n,e){return Pt(n,Ot(e))}function jt(n,e){return zo(n,n,dt(e),Wo())}function Vt(n,e,t){return zo(n,n,dt(e),t)}function Lt(n,e){return Uo(n,e)}function Wt(n){return K(n)?n:s}function Ut(n,e){return sn(n.element,e.event.target)}function zt(n){if(!we(n,"can")&&!we(n,"abort")&&!we(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return Rt("Extracting event.handler",Ot([jt("can",v),jt("abort",s),jt("run",h)]),n)}function qt(t){var e,o,r,i,n=(o=function(n){return n.can},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return E(e,function(n,e){return n&&o(e).apply(void 0,t)},!0)}),u=(r=e=t,i=function(n){return n.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return E(r,function(n,e){return n||i(e).apply(void 0,t)},!1)});return zt({can:n,abort:u,run:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];O(t,function(n){n.run.apply(void 0,e)})}})}function Gt(n,e){Dr(n,n.element,e,{})}function Yt(n,e,t){Dr(n,n.element,e,t)}function Kt(n){Gt(n,yr())}function Qt(n,e,t){Dr(n,e,t,{})}function Xt(n,e){return{key:n,value:zt({run:e})}}function Jt(n){return function(t){return{key:n,value:zt({run:function(n,e){Ut(n,e)&&t(n,e)}})}}}function $t(n){return Xt(n,function(n,e){e.cut()})}function Zt(n,e){var t=n.toString(),o=t.indexOf(")")+1,r=t.indexOf("("),i=t.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:Ir(i)}},n}function no(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}}function eo(t,o,r){return Pr(function(n,e){r(n,t,o)})}function to(r,i,u){var n,e,t,o,c,a;return n=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var o=[t].concat(n);return t.config({name:y(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(n){var e=Array.prototype.slice.call(o,1);return i.apply(void 0,[t,n.config,n.state].concat(e))})},e=u,o=(t=i).toString(),c=o.indexOf(")")+1,t=o.indexOf("("),a=o.substring(t+1,c-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:e,parameters:Ir(a.slice(0,1).concat(a.slice(3)))}},n}function oo(n){return{key:n,value:void 0}}function ro(n){var e,t,o,r,i,u=Rt("Creating behaviour: "+n.name,Lr,n);return e=u.fields,t=u.name,o=u.active,r=u.apis,i=u.extra,n=u.state,u=Ot(e),e=Ht(t,[It("config",e)]),jr(u,e,t,o,r,i,n)}function io(n,e){return{key:n,value:{config:{},me:function(n,e){e=Fr(e);return ro({fields:[Dt("enabled")],name:n,active:{events:y(e)}})}(n,e),configAsRaw:y({}),initialConfig:{},state:Zo}}}function uo(n){return n.dom.focus()}function co(n){return void 0===n&&(n=I.fromDom(document)),P.from(n.dom.activeElement).map(I.fromDom)}function ao(e){return co(ie(e)).filter(function(n){return e.dom.contains(n.dom)})}function so(e,n){O(n,function(n){se(e,n)})}function fo(n){n.dom.textContent="",O(pn(n),function(n){zr(n)})}function lo(n){return n.dom.innerHTML}function mo(n,e){var t=ln(n).dom,o=I.fromDom(t.createDocumentFragment()),t=function(n,e){e=(e||document).createElement("div");return e.innerHTML=n,pn(I.fromDom(e))}(e,t);so(o,t),fo(n),se(n,o)}function go(n){return e=n,n=!1,I.fromDom(e.dom.cloneNode(n));var e}function po(n){var e=go(n);return n=e,e=I.fromTag("div"),n=I.fromDom(n.dom.cloneNode(!0)),se(e,n),lo(e)}var vo,ho,bo=function(n){return n.fold(lt,ft)},yo=function(n){return st(n,Ge.error,Ge.value)},_o=ft,wo=function(n){var e=[],t=[];return O(n,function(n){st(n,function(n){return t.push(n)},function(n){return e.push(n)})}),{values:e,errors:t}},xo=lt,Oo=function(n,e){return n.stype===at.Value?e(n.svalue):n},So=function(n,e){return n.stype===at.Error?e(n.serror):n},Eo=function(n,e){return n.stype===at.Value?{stype:at.Value,svalue:e(n.svalue)}:n},Co=function(n,e){return n.stype===at.Error?{stype:at.Error,serror:e(n.serror)}:n},ko=function(u){if(!G(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var c=[],t={};return O(u,function(n,o){var e=Xe(n);if(1!==e.length)throw new Error("one and only one name per case");var r=e[0],i=n[r];if(void 0!==t[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!G(i))throw new Error("case arguments must be an array");c.push(r),t[r]=function(){var n=arguments.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+n);for(var t=new Array(n),e=0;e<t.length;e++)t[e]=arguments[e];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[o].apply(null,t)},match:function(n){var e=Xe(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!R(c,function(n){return w(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[r].apply(null,t)},log:function(n){console.log(n,{constructors:c,constructor:r,params:t})}}}}),t},To=Object.prototype.hasOwnProperty,Mo=function(u){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},o=0;o<n.length;o++){var r,i=n[o];for(r in i)To.call(i,r)&&(t[r]=u(t[r],i[r]))}return t}},Ro=Mo(function(n,e){return q(n)&&q(e)?Ro(n,e):e}),Ao=Mo(function(n,e){return e}),Do=ko([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Fo=Do.strict,No=Do.asOption,Bo=Do.defaultedThunk,Po=(Do.asDefaultedOptionThunk,Do.mergeWithThunk),Ho=(ko([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),mt),Io=function(n,e){n=wo(n);return 0<n.errors.length?vt(n.errors):(n=n.values,e=e,0<n.length?_o(Ro(e,Ao.apply(void 0,n))):_o(e))},jo=function(n){n=wo(n);return 0<n.errors.length?vt(n.errors):_o(n.values)},Vo=ko([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Lo=function(o){return{extract:function(n,e,t){return function(e,t,n,o){n=x(n,function(n){return wt(e,t,n,o)});return Io(n,{})}(n,t,o,e)},toString:function(){return"obj{\n"+x(o,function(n){return n.fold(function(n,e,t,o){return n+" -> "+o.toString()},function(n,e){return"state("+n+")"})}).join("\n")+"}"}}},Wo=y(xt(_o)),Uo=Vo.state,zo=Vo.field,qo=xt(_o),Go=function(e,n){return St(function(n){return bo(e(n))},n)},Yo=function(n){return"Errors: \n"+function(n){n=10<n.length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n;return x(n,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})}(n.errors).join("\n")+"\n\nInput object: "+ht(n.input)},Ko=y(qo),Qo=function(t,o){return xt(function(n){var e=typeof n;return t(n)?_o(n):xo("Expected type: "+o+" but got: "+e)})},Xo=Qo(Y,"boolean"),Jo=Qo(K,"function"),$o=function(n){return Ft(n,Jo)},Zo={init:function(){return nr({readState:function(){return"No State required"}})}},nr=function(n){return n},er=function(n,e,t){var o=e(n),r=Wt(t);return o.orThunk(function(){return r(n)?P.none():function(n,e,t){for(var o=n.dom,r=Wt(t);o.parentNode;){o=o.parentNode;var i=I.fromDom(o),u=e(i);if(u.isSome())return u;if(r(i))break}return P.none()}(n,e,r)})},tr=y,or=tr("touchstart"),rr=tr("touchmove"),ir=tr("touchend"),ur=tr("mousedown"),cr=tr("mouseover"),ar=tr("keydown"),sr=tr("keyup"),fr=tr("input"),lr=tr("click"),dr=tr("transitionend"),mr=function(n){return y("alloy."+n)},gr={tap:mr("tap")},pr=mr("focus"),vr=mr("blur.post"),hr=mr("paste.post"),br=mr("receive"),yr=mr("execute"),_r=mr("focus.item"),wr=gr.tap,xr=mr("longpress"),Or=mr("sandbox.close"),Sr=mr("system.init"),Er=mr("system.attached"),Cr=mr("system.detached"),kr=mr("system.dismissRequested"),Tr=mr("system.repositionRequested"),Mr=mr("focusmanager.shifted"),Rr=mr("highlight"),Ar=mr("dehighlight"),Dr=function(n,e,t,o){o=Z({target:e},o);n.getSystem().triggerEvent(t,e,o)},Fr=gt,Nr=Jt(Er()),Br=Jt(Cr()),Pr=Jt(Sr()),Hr=(vo=yr(),function(n){return Xt(vo,n)}),Ir=function(n){return x(n,function(n){return o=t="/*",t=(e=e=n).length-t.length,""===o||e.length>=o.length&&e.substr(t,t+o.length)===o?n.substring(0,n.length-"/*".length):n;var e,t,o})},jr=function(t,n,o,r,e,i,u){function c(n){return we(n,o)?n[o]():P.none()}var e=ye(e,function(n,e){return to(o,n,e)}),i=ye(i,Zt),a=Z(Z(Z({},i),e),{revoke:d(oo,o),config:function(n){var e=Rt(o+"-config",t,n);return{key:o,value:{config:e,me:a,configAsRaw:tn(function(){return Rt(o+"-config",t,n)}),initialConfig:n,state:u}}},schema:function(){return n},exhibit:function(n,t){return c(n).bind(function(e){return et(r,"exhibit").map(function(n){return n(t,e.config,e.state)})}).getOr(no({}))},name:function(){return o},handlers:function(n){return c(n).map(function(n){return et(r,"events").getOr(function(){return{}})(n.config,n.state)}).getOr({})}});return a},Vr=gt,Lr=Ot([Dt("fields"),Dt("name"),jt("active",{}),jt("apis",{}),jt("state",Zo),jt("extra",{})]),Wr=Ot([Dt("branchKey"),Dt("branches"),Dt("name"),jt("active",{}),jt("apis",{}),jt("state",Zo),jt("extra",{})]),Ur=y(void 0),zr=function(n){n=n.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},qr="unknown";(uc=ho=ho||{})[uc.STOP=0]="STOP",uc[uc.NORMAL=1]="NORMAL",uc[uc.LOGGING=2]="LOGGING";function Gr(e,n,t){var o,r,i,u;switch(et(Kr.get(),e).orThunk(function(){var n=Xe(Kr.get());return N(n,function(n){return-1<e.indexOf(n)?P.some(Kr.get()[n]):P.none()})}).getOr(ho.NORMAL)){case ho.NORMAL:return t(Xr());case ho.LOGGING:n=(o=e,r=n,i=[],u=(new Date).getTime(),{logEventCut:function(n,e,t){i.push({outcome:"cut",target:e,purpose:t})},logEventStopped:function(n,e,t){i.push({outcome:"stopped",target:e,purpose:t})},logNoParent:function(n,e,t){i.push({outcome:"no-parent",target:e,purpose:t})},logEventNoHandlers:function(n,e){i.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,t){i.push({outcome:"response",purpose:t,target:e})},write:function(){var n=(new Date).getTime();w(["mousemove","mouseover","mouseout",Sr()],o)||console.log(o,{event:o,time:n-u,target:r.dom,sequence:x(i,function(n){return w(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+po(n.target)+")":n.outcome})})}}),t=t(n);return n.write(),t;case ho.STOP:return!0}}function Yr(n){return n.cHandler}var Kr=fe({}),Qr=["alloy/data/Fields","alloy/debugging/Debugging"],Xr=y({logEventCut:h,logEventStopped:h,logNoParent:h,logEventNoHandlers:h,logEventResponse:h,write:h}),Jr=function(n,e){return{cHandler:d.apply(void 0,[n.handler].concat(e)),purpose:n.purpose}};function $r(n,e,t,o,r){return n(t,o)?P.some(t):K(r)&&r(t)?P.none():e(t,o,r)}function Zr(n,e,t){for(var o=n.dom,r=K(t)?t:s;o.parentNode;){o=o.parentNode;var i=I.fromDom(o);if(e(i))return P.some(i);if(r(i))break}return P.none()}function ni(n,e,t){return $r(function(n,e){return e(n)},Zr,n,e,t)}function ei(n,e,t){return Zr(n,function(n){return cn(n,e)},t)}function ti(n,e){return function(n,e){e=void 0===e?document:e.dom;return an(e)?P.none():P.from(e.querySelector(n)).map(I.fromDom)}(e,n)}function oi(n,e,t){return $r(cn,ei,n,e,t)}var ri=[8],ii=[9],ui=[13],ci=[27],ai=[32],si=[37],fi=[38],li=[39],di=[40];function mi(n){return void 0===(n=n.raw).touches||1!==n.touches.length?P.none():P.some(n.touches[0])}function gi(t){var o,r,i,u=fe(P.none()),c=fe(!1),a=(o=function(n){t.triggerEvent(xr(),n),c.set(!0)},r=400,i=null,{cancel:function(){null!==i&&(clearTimeout(i),i=null)},schedule:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];i=setTimeout(function(){o.apply(null,n),i=null},r)}}),s=gt([{key:or(),value:function(e){return mi(e).each(function(n){a.cancel();n={x:n.clientX,y:n.clientY,target:e.target};a.schedule(e),c.set(!1),u.set(P.some(n))}),P.none()}},{key:rr(),value:function(n){return a.cancel(),mi(n).each(function(o){u.get().each(function(n){var e,t;e=o,t=n,n=Math.abs(e.clientX-t.x),t=Math.abs(e.clientY-t.y),(5<n||5<t)&&u.set(P.none())})}),P.none()}},{key:ir(),value:function(e){a.cancel();return u.get().filter(function(n){return sn(n.target,e.target)}).map(function(n){return c.get()?(e.prevent(),!1):t.triggerEvent(wr(),e)})}}]);return{fireIfReady:function(e,n){return et(s,n).bind(function(n){return n(e)})}}}function pi(n){var e;return n.raw.which===ri[0]&&!w(["input","textarea"],fn(n.target))&&(n=n.target,!oi(n,'[contenteditable="true"]',e).isSome())}function vi(){return Xn().browser.isFirefox()}function hi(e,n){var t,o=Rt("Getting GUI events settings",xi,n),r=gi(o),i=x(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return xn(e,n,function(e){r.fireIfReady(e,n).each(function(n){n&&e.kill()}),o.triggerEvent(n,e)&&e.kill()})}),u=fe(P.none()),c=xn(e,"paste",function(e){r.fireIfReady(e,"paste").each(function(n){n&&e.kill()}),o.triggerEvent("paste",e)&&e.kill(),u.set(P.some(setTimeout(function(){o.triggerEvent(hr(),e)},0)))}),a=xn(e,"keydown",function(n){o.triggerEvent("keydown",n)?n.kill():!0===o.stopBackspace&&pi(n)&&n.prevent()}),s=(t=e,n=function(n){o.triggerEvent("focusin",n)&&n.kill()},vi()?On(t,"focus",n):xn(t,"focusin",n)),f=fe(P.none()),l=(t=e,n=function(n){o.triggerEvent("focusout",n)&&n.kill(),f.set(P.some(setTimeout(function(){o.triggerEvent(vr(),n)},0)))},vi()?On(t,"blur",n):xn(t,"focusout",n));return{unbind:function(){O(i,function(n){n.unbind()}),a.unbind(),s.unbind(),l.unbind(),c.unbind(),u.get().each(clearTimeout),f.get().each(clearTimeout)}}}function bi(n,e){return e=et(n,"target").getOr(e),fe(e)}function yi(n,o,e,t,r,i){var u,c,n=n(o,t),a=(e=e,r=r,u=fe(!1),c=fe(!1),{stop:function(){u.set(!0)},cut:function(){c.set(!0)},isStopped:u.get,isCut:c.get,event:e,setSource:r.set,getSource:r.get});return n.fold(function(){return i.logEventNoHandlers(o,t),Oi.complete()},function(e){var t=e.descHandler;return Yr(t)(a),a.isStopped()?(i.logEventStopped(o,e.element,t.purpose),Oi.stopped()):a.isCut()?(i.logEventCut(o,e.element,t.purpose),Oi.complete()):gn(e.element).fold(function(){return i.logNoParent(o,e.element,t.purpose),Oi.complete()},function(n){return i.logEventResponse(o,e.element,t.purpose),Oi.resume(n)})})}function _i(n,e,t){var o,r=(e=e,o=fe(!1),{stop:function(){o.set(!0)},cut:h,isStopped:o.get,isCut:s,event:e,setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")});return O(n,function(n){n=n.descHandler;Yr(n)(r)}),r.isStopped()}function wi(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++Ci+String(e)}var xi=Ot([$o("triggerEvent"),jt("stopBackspace",!0)]),Oi=ko([{stopped:[]},{resume:["element"]},{complete:[]}]),Si=function(e,t,o,n,r,i){return yi(e,t,o,n,r,i).fold(function(){return!0},function(n){return Si(e,t,o,n,r,i)},function(){return!1})},Ei=function(n,e,t,o,r){var i=bi(t,o);return Si(n,e,t,o,i,r)},Ci=0,ki=y("alloy-id-"),Ti=y("data-alloy-id"),Mi=ki(),Ri=Ti(),Ai=function(n,e){Object.defineProperty(n.dom,Ri,{value:e,writable:!0})},Di=function(n){n=$n(n)?n.dom[Ri]:null;return P.from(n)},Fi=wi,Ni=function(n,e){return{element:n,descHandler:e}},Bi=function(n,e){return{id:n,descHandler:e}};function Pi(){var i={};return{registerId:function(o,r,n){$e(n,function(n,e){var t=void 0!==i[e]?i[e]:{};t[r]=Jr(n,o),i[e]=t})},unregisterId:function(t){$e(i,function(n,e){n.hasOwnProperty(t)&&delete n[t]})},filterByType:function(n){return et(i,n).map(function(n){return nt(n,function(n,e){return Bi(e,n)})}).getOr([])},find:function(n,e,t){var r=et(i,e);return er(t,function(n){return t=r,Di(o=n).fold(function(){return P.none()},function(e){return t.bind(function(n){return et(n,e)}).map(function(n){return Ni(o,n)})});var t,o},n)}}}function Hi(){function o(n){var e=n.element;return Di(e).fold(function(){return function(n,e){n=wi(Mi+n);return Ai(e,n),n}("uid-",n.element)},function(n){return n})}var r=Pi(),i={},u=function(n){Di(n.element).each(function(n){delete i[n],r.unregisterId(n)})};return{find:function(n,e,t){return r.find(n,e,t)},filter:function(n){return r.filterByType(n)},register:function(n){var e=o(n);we(i,e)&&function(n,e){var t=i[e];if(t!==n)throw new Error('The tagId "'+e+'" is already used by: '+po(t.element)+"\nCannot use it for: "+po(n.element)+"\nThe conflicting element is"+(ot(t.element)?" ":" not ")+"already in the DOM");u(n)}(n,e);var t=[n];r.registerId(t,e,n.events),i[e]=n},unregister:u,getById:function(n){return et(i,n)}}}function Ii(e){function n(n){return function(){throw new Error("The component must be in a context to send: "+n+(e?"\n"+po(e().element)+" is not in context.":""))}}return{debugInfo:y("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:s}}function ji(n){return Ho(Pu,n)}function Vi(o){return n=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return o.apply(void 0,en([n.getApis(),n],e))},t=(e=o).toString(),r=t.indexOf(")")+1,e=t.indexOf("("),i=t.substring(e+1,r-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Ir(i.slice(1))}},n;var n,e,t,r,i}function Li(n,r){var i={};return $e(n,function(n,o){$e(n,function(n,e){var t=et(i,e).getOr([]);i[e]=t.concat([r(o,n)])})}),i}function Wi(e,n,t,o){var r=Z({},n);function i(n){return b(n,function(n,e){return Z(Z({},e.modification),n)},{})}O(t,function(n){r[n.name()]=n.exhibit(e,o)});var u=Li(r,function(n,e){return{name:n,modification:e}}),n=b(u.classes,function(n,e){return e.modification.concat(n)},[]),t=i(u.attributes),u=i(u.styles);return no({classes:n,attributes:t,styles:u})}function Ui(r,i,n,u){try{var e=function(n,e){n=X.call(n,0);return n.sort(e),n}(n,function(n,e){var t=n[i],o=e[i],n=u.indexOf(t),e=u.indexOf(o);if(-1===n)throw new Error("The ordering for "+r+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(u,null,2));if(-1===e)throw new Error("The ordering for "+r+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(u,null,2));return n<e?-1:e<n?1:0});return Ge.value(e)}catch(n){return Ge.error([n])}}function zi(n,e){return{name:n,handler:e}}function qi(n,e,t){var o,r,e=Z(Z({},t),(o=n,r={},O(e,function(n){r[n.name()]=n.handlers(o)}),r));return Li(e,zi)}function Gi(n){var r=K(n=n)?{can:y(!0),abort:y(!1),run:n}:n;return function(n,e){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];n=[n,e].concat(t);r.abort.apply(void 0,n)?e.stop():r.can.apply(void 0,n)&&r.run.apply(void 0,n)}}function Yi(n,e,t){return(e=e[t])?Ui("Event: "+t,"name",n,e).map(function(n){n=x(n,function(n){return n.handler});return qt(n)}):(t=t,n=n,Ge.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(x(n,function(n){return n.name}),null,2)]))}function Ki(n){var e;return Tt("custom.definition",Lo([zo("dom","dom",Fo(),Lo([Dt("tag"),jt("styles",{}),jt("classes",[]),jt("attributes",{}),Bt("value"),Bt("innerHtml")])),Dt("components"),Dt("uid"),jt("events",{}),jt("apis",{}),zo("eventOrder","eventOrder",((e={})[yr()]=["disabling",Iu,"toggling","typeaheadevents"],e[pr()]=[Iu,"focusing","keying"],e[Sr()]=[Iu,"disabling","toggling","representing"],e[fr()]=[Iu,"representing","streaming","invalidating"],e[Cr()]=[Iu,"representing","item-events","tooltipping"],e[ur()]=["focusing",Iu,"item-type-events"],e[or()]=["focusing",Iu,"item-type-events"],e[cr()]=["item-type-events","tooltipping"],e[br()]=["receiving","reflecting","tooltipping"],e=e,Do.mergeWithThunk(y(e))),Ko()),Bt("domModification")]),n)}function Qi(e,n){O(n,function(n){De(e,n)})}function Xi(e,n){O(n,function(n){Ne(e,n)})}function Ji(n){return void 0!==n.style&&K(n.style.getPropertyValue)}function $i(n,e,t){if(!z(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);Ji(n)&&n.style.setProperty(e,t)}function Zi(n,e){Ji(n)&&n.style.removeProperty(e)}function nu(n,e,t){n=n.dom,$i(n,e,t)}function eu(n,e){var t=n.dom;$e(e,function(n,e){$i(t,e,n)})}function tu(n,e){var t=n.dom;$e(e,function(n,e){n.fold(function(){Zi(t,e)},function(n){$i(t,e,n)})})}function ou(n,e){var t=n.dom,o=window.getComputedStyle(t).getPropertyValue(e);return""!==o||ot(n)?o:ju(t,e)}function ru(n,e){return n=n.dom,e=ju(n,e),P.from(e).filter(function(n){return 0<n.length})}function iu(n,e){var t=n.dom;Zi(t,e),Ee(n,"style").map(Fn).is("")&&ke(n,"style")}function uu(n){return n.dom.value}function cu(n,e){if(void 0===e)throw new Error("Value.set was undefined");n.dom.value=e}function au(n){var e,t,o=I.fromTag(n.tag);e=o,r=n.attributes,t=e.dom,$e(r,function(n,e){xe(t,e,n)}),Qi(o,n.classes),eu(o,n.styles),n.innerHtml.each(function(n){return mo(o,n)});var r=n.domChildren;return so(o,r),n.value.each(function(n){cu(o,n)}),n.uid,Ai(o,n.uid),o}function su(n,e){return t=n,e=x(n=e,function(n){return Ht(n.name(),[Dt("config"),jt("state",Zo)])}),e=Tt("component.behaviours",Lo(e),t.behaviours).fold(function(n){throw new Error(Yo(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))},function(n){return n}),{list:n,data:ye(e,function(n){var e=n.map(function(n){return{config:n.config,state:n.state.init(n.config)}});return function(){return e}})};var t}function fu(n){var e,t=(e=et(t=n,"behaviours").getOr({}),t=S(Xe(e),function(n){return void 0!==e[n]}),x(t,function(n){return e[n].me}));return su(n,t)}function lu(n,e,t){var o,r=Z(Z({},(o=n).dom),{uid:o.uid,domChildren:x(o.components,function(n){return n.element})}),n={"alloy.base.modification":o=n.domModification.fold(function(){return no({})},no)};return o=o=0<e.length?Wi(t,n,e,r):o,Z(Z({},r=r),{attributes:Z(Z({},r.attributes),o.attributes),styles:Z(Z({},r.styles),o.styles),classes:r.classes.concat(o.classes)})}function du(n,e,t){var o={"alloy.base.behaviour":n.events};return function(n,e,t,o){o=qi(n,t,o);return Hu(o,e)}(t,n.eventOrder,e,o).getOrDie()}function mu(n){var t,e,o,r,i,u,c,a=(s=Nu(n)).events,s=function(n){n=et(n,"components").getOr([]);return x(n,Wu)}(n=nn(s,["events"])),a=Z(Z({},n),{events:Z(Z({},Fu),a),components:s});return Ge.value((e=fe(Bu),o=Mt(Ki(t=a)),s=fu(t),a=s.list,r=s.data,s=lu(o,a,r),i=au(s),a=du(o,a,r),u=fe(o.components),c={getSystem:e.get,config:function(n){var e=r;return(K(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(n){return K(r[n.name()])},spec:t,readState:function(n){return r[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},getApis:function(){return o.apis},connect:function(n){e.set(n)},disconnect:function(){e.set(Ii(f))},element:i,syncComponents:function(){var n=pn(i),n=M(n,function(n){return e.get().getByDom(n).fold(function(){return[]},function(n){return[n]})});u.set(n)},components:u.get,events:a}));function f(){return c}}function gu(n){return n.dump}function pu(n,e){return Z(Z({},n.dump),Vr(e))}function vu(){return Nt("markers",[Dt("backgroundMenu")].concat(Yu()).concat(Ku()))}function hu(n,e,t){return function(){var n=new Error;if(void 0===n.stack)return;n=n.stack.split("\n");C(n,function(e){return 0<e.indexOf("alloy")&&!p(Qr,function(n){return-1<e.indexOf(n)})}).getOr(qr)}(),zo(e,e,t,kt(function(t){return Ge.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)})}))}function bu(n,e){return Lt(n,y(e))}function yu(n){return Lt(n,f)}function _u(n){return tt(n,"uiType")}function wu(n,e,t,o){return _u(t)&&t.uiType===Ju?(i=t,u=o,(r=n).exists(function(n){return n!==i.owner})?$u.single(!0,y(i)):et(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+Xe(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(n){return n.replace()})):$u.single(!1,y(t));var r,i,u}function xu(e,t,n,o){var r,i,u,o=ye(o,function(n,e){return o=n,r=!1,{name:y(t=e),required:function(){return o.fold(function(n,e){return n},function(n,e){return n})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+t);return r=!0,o}};var t,o,r}),n=(r=e,i=t,u=o,M(n,function(n){return Zu(r,i,n,u)}));return $e(o,function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+e.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),n}function Ou(n){function e(n){return n.name}return n.fold(e,e,e,e)}function Su(n,e,t,o){return Ro(e.defaults(n,t,o),t,{uid:n.partUids[e.name]},e.overrides(n,t,o))}function Eu(r,n){var e={};return O(n,function(n){n.fold(P.some,P.none,P.some,P.some).each(function(t){var o=ac(r,t.pname);e[t.name]=function(n){var e=Rt("Part: "+t.name+" in "+r,Lo(t.schema),n);return Z(Z({},o),{config:n,validated:e})}})}),e}function Cu(n,e,t){return o=e,i={},r={},O(t,function(n){n.fold(function(o){i[o.pname]=nc(!0,function(n,e,t){return o.factory.sketch(Su(n,o,e,t))})},function(n){var e=o.parts[n.name];r[n.name]=y(n.factory.sketch(Su(o,n,e[cc()]),e))},function(o){i[o.pname]=nc(!1,function(n,e,t){return o.factory.sketch(Su(n,o,e,t))})},function(r){i[r.pname]=ec(!0,function(e,n,t){var o=e[r.name];return x(o,function(n){return r.factory.sketch(Ro(r.defaults(e,n,t),n,r.overrides(e,n)))})})})}),{internals:y(i),externals:y(r)};var o,i,r}function ku(n,e,t){return xu(P.some(n),e,e.components,t)}function Tu(e,n){return n=x(n,Ou),gt(x(n,function(n){return{key:n,value:e+"-"+n}}))}function Mu(e){return zo("partUids","partUids",Po(function(n){return Tu(n.uid,e)}),Ko())}function Ru(n,e,t,o,r){return r=r,r=(0<(o=o).length?[Nt("parts",o)]:[]).concat([Dt("uid"),jt("dom",{}),jt("components",[]),yu("originalSpec"),jt("debug.sketcher",{})]).concat(r),Rt(n+" [SpecSchema]",Ot(r.concat(e)),t)}function Au(n,e,t,o,r){var i=sc(r),u=M(t,function(n){return n.fold(P.none,P.some,P.none,P.none).map(function(n){return Nt(n.name,n.schema.concat([yu(cc())]))}).toArray()}),r=Mu(t),r=Ru(n,e,i,u,[r]),t=Cu(0,r,t);return o(r,ku(n,r,t.internals()),i,t.externals())}var Du=Fr([{key:pr(),value:zt({can:function(n,e){var t=e.event,o=t.originator,r=t.target;return e=r,!(sn(t=o,n.element)&&!sn(t,e))||(console.warn(pr()+" did not get interpreted by the desired target. \nOriginator: "+po(o)+"\nTarget: "+po(r)+"\nCheck the "+pr()+" event handlers"),!1)}})}]),Fu=Object.freeze({__proto__:null,events:Du}),Nu=f,Bu=Ii(),Pu=wi("alloy-premade"),Hu=function(n,r){n=nt(n,function(t,o){return(1===t.length?Ge.value(t[0].handler):Yi(t,r,o)).map(function(n){var e=Gi(n),n=1<t.length?S(r[o],function(e){return p(t,function(n){return n.name===e})}).join(" > "):t[0].name;return Ho(o,{handler:e,purpose:n})})});return pt(n,{})},Iu="alloy.base.behaviour",ju=function(n,e){return Ji(n)?n.style.getPropertyValue(e):""},Vu=function(n){var e=Rt("external.component",Ot([Dt("element"),Bt("uid")]),n),t=fe(Ii());e.uid.each(function(n){Ai(e.element,n)});var o={getSystem:t.get,config:P.none,hasConfigured:s,connect:function(n){t.set(n)},disconnect:function(){t.set(Ii(function(){return o}))},getApis:function(){return{}},element:e.element,spec:n,readState:y("No state"),syncComponents:h,components:y([]),events:{}};return ji(o)},Lu=Fi,Wu=function(e){return et(e,Pu).fold(function(){var n=e.hasOwnProperty("uid")?e:Z({uid:Lu("")},e);return mu(n).getOrDie()},function(n){return n})},Uu=ji,zu=function(o,n){return e=o,t={},n=x(n,function(n){return e=n.name(),t="Cannot configure "+n.name()+" for "+o,zo(e,e,No(),xt(function(n){return xo("The field: "+e+" is forbidden. "+t)}));var e,t}).concat([Lt("dump",f)]),Vt(e,t,Lo(n));var e,t},qu=zu,Gu=pu,Yu=y([Dt("menu"),Dt("selectedMenu")]),Ku=y([Dt("item"),Dt("selectedItem")]),Qu=(y(Lo(Ku().concat(Yu()))),y(Lo(Ku()))),Xu=Nt("initSize",[Dt("numColumns"),Dt("numRows")]),n=function(n){return hu(0,n,dt(h))},W=function(n){return hu(0,n,dt(P.none))},U=function(n){return hu(0,n,Fo())},Nn=function(n){return hu(0,n,Fo())},Bn=y(Xu),Ju="placeholder",$u=ko([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Zu=function(o,r,i,u){return wu(o,0,i,u).fold(function(n,e){var t=_u(i)?e(r,i.config,i.validated):e(r),e=et(t,"components").getOr([]),e=M(e,function(n){return Zu(o,r,n,u)});return[Z(Z({},t),{components:e})]},function(n,e){if(_u(i)){var t=e(r,i.config,i.validated);return i.validated.preprocess.getOr(f)(t)}return e(r)})},nc=$u.single,ec=$u.multiple,tc=y(Ju),Pn=ko([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Hn=jt("factory",{sketch:f}),Jn=jt("schema",[]),oe=Dt("name"),oc=zo("pname","pname",Bo(function(n){return"<alloy."+wi(n.name)+">"}),Ko()),pe=Uo("schema",function(){return[Bt("preprocess")]}),ve=jt("defaults",y({})),Ke=jt("overrides",y({})),rc=Lo([Hn,Jn,oe,oc,ve,Ke]),ic=Lo([Hn,Jn,oe,ve,Ke]),Mo=Lo([Hn,Jn,oe,oc,ve,Ke]),qo=Lo([Hn,pe,oe,Dt("unit"),oc,ve,Ke]),Qo=function(e,t){return function(n){n=Rt("Converting part type",t,n);return e(n)}},tr=Qo(Pn.required,rc),gr=Qo(Pn.external,ic),mr=Qo(Pn.optional,Mo),uc=Qo(Pn.group,qo),cc=y("entirety"),ac=function(n,e){return{uiType:tc(),owner:n,name:e}},sc=function(n){return tt(n,"uid")?n:Z(Z({},n),{uid:Fi("uid")})};function fc(n,e){se(n.element,e.element)}function lc(e,n){var t,o=e.components();O((t=e).components(),function(n){return zr(n.element)}),fo(t.element),t.syncComponents(),o=D(o,n),O(o,function(n){xc(n),e.getSystem().removeFromWorld(n)}),O(n,function(n){n.getSystem().isConnected()?fc(e,n):(e.getSystem().addToWorld(n),fc(e,n),ot(e.element)&&Oc(n)),e.syncComponents()})}function dc(n,e){Sc(n,e,se)}function mc(n){xc(n),zr(n.element),n.getSystem().removeFromWorld(n)}function gc(e){var n=gn(e.element).bind(function(n){return e.getSystem().getByDom(n).toOptional()});mc(e),n.each(function(n){n.syncComponents()})}function pc(n){var e=n.components();O(e,mc),fo(n.element),n.syncComponents()}function vc(t){function o(e){return gn(t.element).fold(function(){return!0},function(n){return sn(e,n)})}function a(n,e){return i.find(o,n,e)}function r(e){var n=i.filter(br());O(n,function(n){n=n.descHandler;Yr(n)(e)})}var i=Hi(),n=hi(t.element,{triggerEvent:function(t,o){return Gr(t,o.target,function(n){return e=n,Ei(a,t,n=o,n.target,e);var e})}}),u={debugInfo:y("real"),triggerEvent:function(e,t,o){Gr(e,t,function(n){return Ei(a,e,o,t,n)})},triggerFocus:function(u,c){Di(u).fold(function(){uo(u)},function(n){Gr(pr(),u,function(n){var e,t,o,r,i;return e=a,t=pr(),i=n,n=bi(o={originator:c,kill:h,prevent:h,target:u},r=u),yi(e,t,o,r,n,i),!1})})},triggerEscape:function(n,e){u.triggerEvent("keydown",n.element,e.event)},getByUid:function(n){return g(n)},getByDom:function(n){return p(n)},build:Wu,addToGui:function(n){s(n)},removeFromGui:function(n){f(n)},addToWorld:function(n){e(n)},removeFromWorld:function(n){c(n)},broadcast:function(n){l(n)},broadcastOn:function(n,e){d(n,e)},broadcastEvent:function(n,e){m(n,e)},isConnected:v},e=function(n){n.connect(u),Zn(n.element)||(i.register(n),O(n.components(),e),u.triggerEvent(Sr(),n.element,{target:n.element}))},c=function(n){Zn(n.element)||(O(n.components(),c),i.unregister(n)),n.disconnect()},s=function(n){dc(t,n)},f=function(n){gc(n)},l=function(n){r({universal:!0,data:n})},d=function(n,e){r({universal:!1,channels:n,data:e})},m=function(n,e){n=i.filter(n);return _i(n,e)},g=function(n){return i.getById(n).fold(function(){return Ge.error(new Error('Could not find component with uid: "'+n+'" in system.'))},Ge.value)},p=function(n){n=Di(n).getOr("not found");return g(n)};return e(t),{root:t,element:t.element,destroy:function(){n.unbind(),zr(t.element)},add:s,remove:f,getByUid:g,getByDom:p,addToWorld:e,removeFromWorld:c,broadcast:l,broadcastOn:d,broadcastEvent:m}}function hc(n){var e=void 0!==n.uid&&we(n,"uid")?n.uid:Fi("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOptional()},asSpec:function(){return Z(Z({},n),{uid:e})}}}function bc(n,e){return void 0!==n?n:void 0!==e?e:0}function yc(n){var e=(i=n.dom.ownerDocument).body,t=i.defaultView,o=i.documentElement;if(e===n.dom)return Cc(e.offsetLeft,e.offsetTop);var r=bc(null==t?void 0:t.pageYOffset,o.scrollTop),i=bc(null==t?void 0:t.pageXOffset,o.scrollLeft),t=bc(o.clientTop,e.clientTop),e=bc(o.clientLeft,e.clientLeft);return kc(n).translate(i-e,r-t)}var _c=Ot([Dt("name"),Dt("factory"),Dt("configFields"),jt("apis",{}),jt("extraApis",{})]),wc=Ot([Dt("name"),Dt("factory"),Dt("configFields"),Dt("partFields"),jt("apis",{}),jt("extraApis",{})]),ki=function(n){var e=Rt("Sketcher for "+n.name,_c,n),t=ye(e.apis,Vi),n=ye(e.extraApis,Zt);return Z(Z({name:e.name,configFields:e.configFields,sketch:function(n){return function(n,e,t,o){o=sc(o);return t(Ru(n,e,o,[],[]),o)}(e.name,e.configFields,e.factory,n)}},t),n)},Ti=function(n){var e=Rt("Sketcher for "+n.name,wc,n),t=Eu(e.name,e.partFields),o=ye(e.apis,Vi),n=ye(e.extraApis,Zt);return Z(Z({name:e.name,partFields:e.partFields,configFields:e.configFields,sketch:function(n){return Au(e.name,e.configFields,e.partFields,e.factory,n)},parts:t},o),n)},xc=(ki({name:"Container",factory:function(n){var e=n.dom,t=e.attributes,e=nn(e,["attributes"]);return{uid:n.uid,dom:Z({tag:"div",attributes:Z({role:"presentation"},t)},e),components:n.components,behaviours:gu(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[jt("components",[]),zu("containerBehaviours",[]),jt("events",{}),jt("domModification",{}),jt("eventOrder",{})]}),function(n){Gt(n,Cr());n=n.components();O(n,xc)}),Oc=function(n){var e=n.components();O(e,Oc),Gt(n,Er())},Sc=function(n,e,t){n.getSystem().addToWorld(e),t(n.element,e.element),ot(n.element)&&Oc(e),n.syncComponents()},Du=Object.freeze({__proto__:null,exhibit:function(n,e){return no({classes:[],styles:e.useFixed()?{}:{position:"relative"}})}}),Ec=function(t,o){return{left:t,top:o,translate:function(n,e){return Ec(t+n,o+e)}}},Cc=Ec,kc=function(n){var e=n.dom,t=e.ownerDocument.body;return t===e?Cc(t.offsetLeft,t.offsetTop):ot(n)?function(n){n=n.getBoundingClientRect();return Cc(n.left,n.top)}(e):Cc(0,0)};function Tc(t,o){function n(n){var e=o(n);if(e<=0||null===e){n=ou(n,t);return parseFloat(n)||0}return e}function r(t,n){return E(n,function(n,e){e=ou(t,e),e=void 0===e?0:parseInt(e,10);return isNaN(e)?n:n+e},0)}return{set:function(n,e){if(!Q(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);n=n.dom;Ji(n)&&(n.style[t]=e+"px")},get:n,getOuter:n,aggregate:r,max:function(n,e,t){t=r(n,t);return t<e?e-t:0}}}function Mc(n){return ka.get(n)}function Rc(n){return ka.getOuter(n)}function Ac(n){return Ta.get(n)}function Dc(n){return Ta.getOuter(n)}function Fc(n){var n=(e=void 0!==n?n.dom:document).body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop;return Cc(n,e)}function Nc(n,e,t,o){return{x:n,y:e,width:t,height:o,right:n+t,bottom:e+o}}function Bc(n){var t=void 0===n?window:n,n=t.document,o=Fc(I.fromDom(n));return function(n){n=void 0===n?window:n;return P.from(n.visualViewport)}(t).fold(function(){var n=t.document.documentElement,e=n.clientWidth,n=n.clientHeight;return Nc(o.left,o.top,e,n)},function(n){return Nc(Math.max(n.pageLeft,o.left),Math.max(n.pageTop,o.top),n.width,n.height)})}function Pc(t){var n=I.fromDom(document),o=Fc(n);return function(n,e){n=e.owner(n),n=Ma(e,n);return P.some(n)}(t,Ra).fold(d(yc,t),function(n){var e=kc(t),n=b(n,function(n,e){e=kc(e);return{left:n.left+e.left,top:n.top+e.top}},{left:0,top:0});return Cc(n.left+e.left+o.left,n.top+e.top+o.top)})}function Hc(n,e,t,o){return{x:n,y:e,width:t,height:o,right:n+t,bottom:e+o}}function Ic(n){var e=yc(n),t=Dc(n),n=Rc(n);return Hc(e.left,e.top,t,n)}function jc(){return Bc(window)}function Vc(n,t){var o=ie(t),e=co(o).bind(function(e){function n(n){return sn(e,n)}var o,r;return n(t)?P.some(t):(o=n,(r=function(n){for(var e=0;e<n.childNodes.length;e++){var t=I.fromDom(n.childNodes[e]);if(o(t))return P.some(t);t=r(n.childNodes[e]);if(t.isSome())return t}return P.none()})(t.dom))}),n=n(t);return e.each(function(e){co(o).filter(function(n){return sn(n,e)}).fold(function(){uo(e)},h)}),n}function Lc(n,e,t,o,r){return{position:n,left:e,top:t,right:o,bottom:r}}function Wc(n,e){function t(n){return n+"px"}tu(n,{position:P.some(e.position),left:e.left.map(t),top:e.top.map(t),right:e.right.map(t),bottom:e.bottom.map(t)})}function Uc(n,e,t,o,r,i){var u=e.x-t,c=e.y-o,a=r-(u+e.width),s=i-(c+e.height),f=P.some(u),l=P.some(c),d=P.some(a),m=P.some(s),g=P.none();return t=e.direction,o=function(){return Lc(n,f,l,g,g)},r=function(){return Lc(n,g,l,d,g)},i=function(){return Lc(n,f,g,g,m)},u=function(){return Lc(n,g,g,d,m)},c=function(){return Lc(n,f,l,g,g)},a=function(){return Lc(n,f,g,g,m)},s=function(){return Lc(n,f,l,g,g)},e=function(){return Lc(n,g,l,d,g)},t.fold(o,r,i,u,c,a,s,e)}function zc(n,e){var t=d(Pc,e),o=n.fold(t,t,function(){var n=Fc();return Pc(e).translate(-n.left,-n.top)}),n=Dc(e),t=Rc(e);return Hc(o.left,o.top,n,t)}function qc(n,e,t,o){return o<(e=n+e)?t:e<t?o:e}function Gc(n,e,t){return Math.min(Math.max(n,e),t)}function Yc(e,t){return function(n,e){for(var t={},o=0,r=n.length;o<r;o++){var i=n[o];t[String(i)]=e(i,o)}return t}(["left","right","top","bottom"],function(n){return et(t,n).map(function(n){return function(n,e){switch(e){case 1:return n.x;case 0:return n.x+n.width;case 2:return n.y;case 3:return n.y+n.height}}(e,n)})})}function Kc(n,r,i){function e(e,t){var o="top"===e||"bottom"===e?i.top:i.left;return et(r,e).bind(f).bind(function(n){return"left"===e||"top"===e?t<=n?P.some(n):P.none():n<=t?P.some(n):P.none()}).map(function(n){return n+o}).getOr(t)}var t=e("left",n.x),o=e("top",n.y),u=e("right",n.right),n=e("bottom",n.bottom);return Hc(t,o,u-t,n-o)}function Qc(n,e,t,o){var r=n.x,i=n.y,u=n.bubble.offset,c=u.left,a=u.top,s=(h=Kc(o,n.boundsRestriction,u)).y,f=h.bottom,l=h.x,d=h.right,m=(h=(m=r+c,p=b=i+a,g=e,v=t,u=(o=h).x,i=o.y,a=o.width,r=o.height,c=i<=p,t=(e=u<=m)&&c,h=m+g<=u+a&&p+v<=i+r,u=Math.abs(Math.min(g,e?u+a-m:u-(m+g))),i=Math.abs(Math.min(v,c?i+r-p:i-(p+v))),g=Math.max(o.x,o.right-g),v=Math.max(o.y,o.bottom-v),{originInBounds:t,sizeInBounds:h,limitX:Gc(m,o.x,g),limitY:Gc(p,o.y,v),deltaW:u,deltaH:i})).originInBounds,g=h.sizeInBounds,p=h.limitX,v=h.deltaW,i=y((o=h.limitY)+(u=h.deltaH)-s),h=y(f-o),h=(s=n.direction,h=f=h,i=i,s.fold(f,f,i,i,f,i,h,h)),l=y(p+v-l),d=y(d-p),b={x:p,y:o,width:v,height:u,maxHeight:h,maxWidth:(o=n.direction,d=h=d,l=l,o.fold(h,l,h,l,d,d,h,l)),direction:n.direction,classes:{on:n.bubble.classesOn,off:n.bubble.classesOff},label:n.label,candidateYforTest:b};return m&&g?Wa.fit(b):Wa.nofit(b,v,u)}function Xc(n,e,t,u,c){function o(n,o,r,i){return n=n(e,t,u),Qc(n,a,s,c).fold(Wa.fit,function(n,e,t){return i<t||r<e?Wa.nofit(n,e,t):Wa.nofit(o,r,i)})}var a=t.width,s=t.height;return E(n,function(n,e){e=d(o,e);return n.fold(Wa.fit,e)},Wa.nofit({x:e.x,y:e.y,width:t.width,height:t.height,maxHeight:t.height,maxWidth:t.width,direction:Aa(),classes:{on:[],off:[]},label:"none",candidateYforTest:e.y},-1,-1)).fold(f,f)}function Jc(n,e,t,o){return iu(e,"max-height"),iu(e,"max-width"),e={width:Dc(e=e),height:Rc(e)},Xc(o.preference,n,e,t,o.bounds)}function $c(n,e,t){var r;Wc(n,(t=t.origin,r=e,t.fold(function(){return Lc("absolute",P.some(r.x),P.some(r.y),P.none(),P.none())},function(n,e,t,o){return Uc("absolute",r,n,e,t,o)},function(n,e,t,o){return Uc("fixed",r,n,e,t,o)})))}function Zc(n,e){!function(n,e){e=ka.max(n,e,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);nu(n,"max-height",e+"px")}(n,Math.floor(e))}function na(n,e,t){return void 0===n[e]?t:n[e]}function ea(n,e,t,o,r,i){var u,c=na(i,"maxHeightFunction",Ua()),a=na(i,"maxWidthFunction",h),i=n.anchorBox,n=n.origin,a={bounds:(u=n,r.fold(function(){return u.fold(jc,jc,Hc)},function(t){return u.fold(t,t,function(){var n=t(),e=ja(u,n.x,n.y);return Hc(e.left,e.top,n.width,n.height)})})),origin:n,preference:o,maxHeightFunction:c,maxWidthFunction:a};za(i,e,t,a)}function ta(n,e,t){function r(n){return et(t,n).getOr([])}function o(n,e,t){var o=D(qa,t);return{offset:Cc(n,e),classesOn:M(t,r),classesOff:M(o,r)}}return{southeast:function(){return o(-n,e,["top","alignLeft"])},southwest:function(){return o(n,e,["top","alignRight"])},south:function(){return o(-n/2,e,["top","alignCentre"])},northeast:function(){return o(-n,-e,["bottom","alignLeft"])},northwest:function(){return o(n,-e,["bottom","alignRight"])},north:function(){return o(-n/2,-e,["bottom","alignCentre"])},east:function(){return o(n,-e/2,["valignCentre","left"])},west:function(){return o(-n,-e/2,["valignCentre","right"])},innerNorthwest:function(){return o(-n,e,["top","alignRight"])},innerNortheast:function(){return o(n,e,["top","alignLeft"])},innerNorth:function(){return o(-n/2,e,["top","alignCentre"])},innerSouthwest:function(){return o(-n,-e,["bottom","alignRight"])},innerSoutheast:function(){return o(n,-e,["bottom","alignLeft"])},innerSouth:function(){return o(-n/2,-e,["bottom","alignCentre"])},innerWest:function(){return o(n,-e/2,["valignCentre","right"])},innerEast:function(){return o(-n,-e/2,["valignCentre","left"])}}}function oa(){return ta(0,0,{})}function ra(n,e,t,o,r,i){return{x:n,y:e,bubble:t,direction:o,boundsRestriction:r,label:i}}function ia(n,e){return n.x+n.width/2-e.width/2}function ua(n,e){return n.x+n.width-e.width}function ca(n,e){return n.y-e.height}function aa(n){return n.y+n.height}function sa(n,e){return n.y+n.height/2-e.height/2}function fa(n,e,t){return ra(n.x,aa(n),t.southeast(),Aa(),Yc(n,{left:1,top:3}),"layout-se")}function la(n,e,t){return ra(ua(n,e),aa(n),t.southwest(),Da(),Yc(n,{right:0,top:3}),"layout-sw")}function da(n,e,t){return ra(n.x,ca(n,e),t.northeast(),Fa(),Yc(n,{left:1,bottom:2}),"layout-ne")}function ma(n,e,t){return ra(ua(n,e),ca(n,e),t.northwest(),Na(),Yc(n,{right:0,bottom:2}),"layout-nw")}function ga(n,e,t){return ra(ia(n,e),ca(n,e),t.north(),Pa(),Yc(n,{bottom:2}),"layout-n")}function pa(n,e,t){return ra(ia(n,e),aa(n),t.south(),Ba(),Yc(n,{top:3}),"layout-s")}function va(n,e,t){return ra((o=n).x+o.width,sa(n,e),t.east(),Ha(),Yc(n,{left:0}),"layout-e");var o}function ha(n,e,t){return ra((o=e,n.x-o.width),sa(n,e),t.west(),Ia(),Yc(n,{right:1}),"layout-w");var o}function ba(){return[fa,la,da,ma,pa,ga,va,ha]}function ya(){return[la,fa,ma,da,pa,ga,va,ha]}function _a(){return[da,ma,fa,la,ga,pa]}function wa(){return[ma,da,la,fa,ga,pa]}function xa(){return[fa,la,da,ma,pa,ga]}function Oa(){return[la,fa,ma,da,pa,ga]}function Sa(e,t){return function(n){return"rtl"===Ga(n)?t:e}}function Ea(n,e,t){return ni(n,e,t).isSome()}var Ca,ka=Tc("height",function(n){var e=n.dom;return ot(n)?e.getBoundingClientRect().height:e.offsetHeight}),Ta=Tc("width",function(n){return n.dom.offsetWidth}),Ma=function(t,n){return t.view(n).fold(y([]),function(n){var e=t.owner(n),e=Ma(t,e);return[n].concat(e)})},Ra=Object.freeze({__proto__:null,view:function(n){return(n.dom===document?P.none():P.from(null===(n=n.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(I.fromDom)},owner:ln}),Xu=ko([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Aa=Xu.southeast,Da=Xu.southwest,Fa=Xu.northeast,Na=Xu.northwest,Ba=Xu.south,Pa=Xu.north,Ha=Xu.east,Ia=Xu.west,Bo=ko([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),ja=function(n,e,t){var o=Cc(e,t);return n.fold(y(o),y(o),function(){var n=Fc();return o.translate(-n.left,-n.top)})},Va=(Bo.none,Bo.relative),La=Bo.fixed,Wa=ko([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Ua=y(function(n,e){Zc(n,e),eu(n,{"overflow-x":"hidden","overflow-y":"auto"})}),za=function(n,e,t,o){var r=Jc(n,e,t,o);$c(e,r,o),function(n,e){e=e.classes;Xi(n,e.off),Qi(n,e.on)}(e,r),n=e,t=r,(0,o.maxHeightFunction)(n,t.maxHeight),e=e,r=r,(0,o.maxWidthFunction)(e,r.maxWidth)},qa=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Ga=function(n){return"rtl"===ou(n,"direction")?"rtl":"ltr"};(Jn=Ca=Ca||{}).TopToBottom="toptobottom",Jn.BottomToTop="bottomtotop";function Ya(n){return Ea(n,function(n){return $n(n)&&Se(n,"data-alloy-vertical-dir")===Ca.BottomToTop})}function Ka(e,n,t,o,r,i,u){var c=u.map(Ya).getOr(!1),a=n.layouts.map(function(n){return n.onLtr(e)}),u=n.layouts.map(function(n){return n.onRtl(e)}),t=c?n.layouts.bind(function(n){return n.onBottomLtr.map(function(n){return n(e)})}).or(a).getOr(r):a.getOr(t),o=c?n.layouts.bind(function(n){return n.onBottomRtl.map(function(n){return n(e)})}).or(u).getOr(i):u.getOr(o);return Sa(t,o)(e)}function Qa(n,e,t){var o,r,n=n.document.createRange();return o=n,e.fold(function(n){o.setStartBefore(n.dom)},function(n,e){o.setStart(n.dom,e)},function(n){o.setStartAfter(n.dom)}),r=n,t.fold(function(n){r.setEndBefore(n.dom)},function(n,e){r.setEnd(n.dom,e)},function(n){r.setEndAfter(n.dom)}),n}function Xa(n,e,t,o,r){return(n=n.document.createRange()).setStart(e.dom,t),n.setEnd(o.dom,r),n}function Ja(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}}function $a(n,e,t){return e(I.fromDom(t.startContainer),t.startOffset,I.fromDom(t.endContainer),t.endOffset)}function Za(n,e){var r,t,e=(r=n,e.match({domRange:function(n){return{ltr:y(n),rtl:P.none}},relative:function(n,e){return{ltr:tn(function(){return Qa(r,n,e)}),rtl:tn(function(){return P.some(Qa(r,e,n))})}},exact:function(n,e,t,o){return{ltr:tn(function(){return Xa(r,n,e,t,o)}),rtl:tn(function(){return P.some(Xa(r,t,o,n,e))})}}}));return(t=(e=e).ltr()).collapsed?e.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return rs.rtl(I.fromDom(n.endContainer),n.endOffset,I.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return $a(0,rs.ltr,t)}):$a(0,rs.ltr,t)}var Hn=function(){return Ht("layouts",[Dt("onLtr"),Dt("onRtl"),Bt("onBottomLtr"),Bt("onBottomRtl")])},pe=[Dt("hotspot"),Bt("bubble"),jt("overrides",{}),Hn(),bu("placement",function(n,e,t){var o=e.hotspot,o=zc(t,o.element),n=Ka(n.element,e,xa(),Oa(),_a(),wa(),P.some(e.hotspot.element));return P.some({anchorBox:o,bubble:e.bubble.getOr(oa()),overrides:e.overrides,layouts:n,placer:P.none()})})],oe=[Dt("x"),Dt("y"),jt("height",0),jt("width",0),jt("bubble",oa()),jt("overrides",{}),Hn(),bu("placement",function(n,e,t){t=ja(t,e.x,e.y),t=Hc(t.left,t.top,e.width,e.height),n=Ka(n.element,e,ba(),ya(),ba(),ya(),P.none());return P.some({anchorBox:t,bubble:e.bubble,overrides:e.overrides,layouts:n,placer:P.none()})})],ns=function(n,e,t,o){return{start:n,soffset:e,finish:t,foffset:o}},oc=ko([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),es=(oc.before,oc.on,oc.after,function(n){return n.fold(f,f,f)}),ts=ko([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),os={domRange:ts.domRange,relative:ts.relative,exact:ts.exact,exactFromRange:function(n){return ts.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){n=n.match({domRange:function(n){return I.fromDom(n.startContainer)},relative:function(n,e){return es(n)},exact:function(n,e,t,o){return n}});return mn(n)},range:ns},rs=ko([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);rs.ltr,rs.rtl;function is(n,e,t,o){var r,i,u,c,a=(i=e,u=t,c=o,(a=ln(r=n).dom.createRange()).setStart(r.dom,i),a.setEnd(u.dom,c),a),o=sn(n,t)&&e===o;return a.collapsed&&!o}function us(n){if(0<n.rangeCount){var e=n.getRangeAt(0),n=n.getRangeAt(n.rangeCount-1);return P.some(ns(I.fromDom(e.startContainer),e.startOffset,I.fromDom(n.endContainer),n.endOffset))}return P.none()}function cs(n){if(null===n.anchorNode||null===n.focusNode)return us(n);var e=I.fromDom(n.anchorNode),t=I.fromDom(n.focusNode);return is(e,n.anchorOffset,t,n.focusOffset)?P.some(ns(e,n.anchorOffset,t,n.focusOffset)):us(n)}function as(n){return n=n,P.from(n.getSelection()).filter(function(n){return 0<n.rangeCount}).bind(cs)}function ss(n,e){var i,n=Za(i=n,e).match({ltr:function(n,e,t,o){var r=i.document.createRange();return r.setStart(n.dom,e),r.setEnd(t.dom,o),r},rtl:function(n,e,t,o){var r=i.document.createRange();return r.setStart(t.dom,o),r.setEnd(n.dom,e),r}});return 0<(e=0<(n=(e=n).getClientRects()).length?n[0]:e.getBoundingClientRect()).width||0<e.height?P.some(e).map(Ja):P.none()}function fs(n,e){return{element:n,offset:e}}function ls(n,e){if(0===(t=pn(n)).length)return fs(n,e);if(e<t.length)return fs(t[e],0);var t=t[t.length-1],o=Zn(t)?(o=t,yf.get(o).length):pn(t).length;return fs(t,o)}function ds(n){return n.fold(f,function(n,e,t){return n.translate(-e,-t)})}function ms(n){return n.fold(f,f)}function gs(n){return E(n,function(n,e){return n.translate(e.left,e.top)},Cc(0,0))}function ps(n){return n=x(n,ms),gs(n)}function vs(n,e,t){var o=ln(n.element),o=Fc(o),t=function(t,n){n=mn(n.root).dom;return P.from(n.frameElement).map(I.fromDom).filter(function(n){var e=ln(n),n=ln(t.element);return sn(e,n)}).map(yc)}(n,t).getOr(o);return wf(t,o.left,o.top)}function hs(n,e,t,o){var r=n,i=e,u=t,c=o;return n<0&&(r=0,u=t+n),e<0&&(i=0,c=o+e),i=_f(Cc(r,i)),P.some({point:i,width:u,height:c})}function bs(n,i,u,c,a){return n.map(function(n){var e,t=[i,n.point],o=(e=function(){return ps(t)},o=function(){return ps(t)},r=function(){return function(n){n=x(n,ds);return gs(n)}(t)},c.fold(e,o,r)),r={x:o.left,y:o.top,width:n.width,height:n.height},o=(u.showAbove?_a:xa)(),n=(u.showAbove?wa:Oa)(),n=Ka(a,u,o,n,o,n,P.none());return{anchorBox:r,bubble:u.bubble.getOr(oa()),overrides:u.overrides,layouts:n,placer:P.none()}})}function ys(n,e){return Zn(n)?{element:n,offset:e}:ls(n,e)}function _s(n,e){return e.getSelection.getOrThunk(function(){return function(){return as(n)}})().map(function(n){var e=ys(n.start,n.soffset),n=ys(n.finish,n.foffset);return os.range(e.element,e.offset,n.element,n.offset)})}function ws(n){return n.x+n.width}function xs(n,e){return n.x-e.width}function Os(n,e){return n.y-e.height+n.height}function Ss(n,e,t){return ra(ws(n),n.y,t.southeast(),Aa(),Yc(n,{left:0,top:2}),"link-layout-se")}function Es(n,e,t){return ra(xs(n,e),n.y,t.southwest(),Da(),Yc(n,{right:1,top:2}),"link-layout-sw")}function Cs(n,e,t){return ra(ws(n),Os(n,e),t.northeast(),Fa(),Yc(n,{left:0,bottom:3}),"link-layout-ne")}function ks(n,e,t){return ra(xs(n,e),Os(n,e),t.northwest(),Na(),Yc(n,{right:1,bottom:3}),"link-layout-nw")}function Ts(){return[Ss,Es,Cs,ks]}function Ms(){return[Es,Ss,ks,Cs]}function Rs(n,e,t,o,r){e={anchorBox:t.anchorBox,origin:e},ea(e,r.element,t.bubble,t.layouts,o,t.overrides)}function As(n,e,t,o){o=n.getSystem().build(o),Sc(n,o,t)}function Ds(n,e,t,o){n=Cf(n),C(n,function(n){return sn(o.element,n.element)}).each(gc)}function Fs(e,n,t,r,o){var i=Cf(e);return P.from(i[r]).map(function(n){return Ds(e,0,0,n),o.each(function(n){As(e,0,function(n,e){var t,o;o=e,vn(t=n,r).fold(function(){se(t,o)},function(n){Sn(n,o)})},n)}),n})}function Ns(n){return!((n=n.dom).offsetWidth<=0&&n.offsetHeight<=0)}function Bs(n,e){e.ignore||(uo(n.element),e.onFocus(n))}function Ps(n,e,t){e.store.manager.onLoad(n,e,t)}function Hs(n,e,t){e.store.manager.onUnload(n,e,t)}function Is(n,e,t,o){var r=e.store;t.update([o]),r.setValue(n,o),e.onSetValue(n,o)}function js(n,e,t,o){return et(e.routes,o.start).bind(function(n){return et(n,o.destination)})}function Vs(e,t,n){var o,r,i;i=n,Bf(o=e,r=t).bind(function(n){return Nf(o,r,i,n)}).each(function(n){n=n.transition;Ne(e.element,n.transitionClass),ke(e.element,t.destinationAttr)})}function Ls(n,e,t,o){Vs(n,e,t),Ce(n.element,e.stateAttr)&&Se(n.element,e.stateAttr)!==o&&e.onFinish(n,o),Oe(n.element,e.stateAttr,o)}function Ws(n,e,t){(e=e.aria).update(n,e,t.get())}function Us(e,n,t){n.toggleClass.each(function(n){(t.get()?De:Ne)(e.element,n)})}function zs(n,e,t){If(n,e,t,!t.get())}function qs(n,e,t){t.set(!0),Us(n,e,t),Ws(n,e,t)}function Gs(n,e,t){t.set(!1),Us(n,e,t),Ws(n,e,t)}function Ys(n,e,t){If(n,e,t,e.selected)}function Ks(){function n(n,e){e.stop(),Kt(n)}return[Xt(lr(),n),Xt(wr(),n),$t(or()),$t(ur())]}function Qs(n){return Fr(T([n.map(function(t){return Hr(function(n,e){t(n),e.stop()})}).toArray(),Ks()]))}function Xs(n,e,t){var o=A(n.slice(0,e)),e=A(n.slice(e+1));return C(o.concat(e),t)}function Js(n,e,t){return e=A(n.slice(0,e)),C(e,t)}function $s(n,e,t){var o=n.slice(0,e),e=n.slice(e+1);return C(e.concat(o),t)}function Zs(n,e,t){return e=n.slice(e+1),C(e,t)}function nf(e){return function(n){n=n.raw;return w(e,n.which)}}function ef(n){return function(e){return R(n,function(n){return n(e)})}}function tf(n){return!0===n.raw.shiftKey}function of(n){return!0===n.raw.ctrlKey}function rf(n,e){return{matches:n,classification:e}}function uf(n){for(var e=[],t=function(n){e.push(n)},o=0;o<n.length;o++)n[o].each(t);return e}function cf(t,o,n,r){var e=Pe(t.element,"."+o.highlightClass);O(e,function(e){p(r,function(n){return n.element===e})||(Ne(e,o.highlightClass),t.getSystem().getByDom(e).each(function(n){o.onDehighlight(t,n),Gt(n,Ar())}))})}function af(n,e,t,o){cf(n,e,0,[o]),Wf(n,e,t,o)||(De(o.element,e.highlightClass),e.onHighlight(n,o),Gt(o,Rr()))}function sf(e,t,n,o){var r=Pe(e.element,"."+t.itemClass);return k(r,function(n){return Be(n,t.highlightClass)}).bind(function(n){n=qc(n,o,0,r.length-1);return e.getSystem().getByDom(r[n]).toOptional()})}function ff(n,e,t){e.exists(function(e){return t.exists(function(n){return sn(n,e)})})||Yt(n,Mr(),{prevFocus:e,newFocus:t})}function lf(){function o(n){return ao(n.element)}return{get:o,set:function(n,e){var t=o(n);n.getSystem().triggerFocus(e,n.element);e=o(n);ff(n,t,e)}}}function df(){function o(n){return Yf.getHighlighted(n).map(function(n){return n.element})}return{get:o,set:function(e,n){var t=o(e);e.getSystem().getByDom(n).fold(h,function(n){Yf.highlight(e,n)});n=o(e);ff(e,t,n)}}}var mf,gf,pf,vf,hf,bf,yf=(mf=Zn,gf="text",{get:function(n){if(!mf(n))throw new Error("Can only get "+gf+" value of a "+gf+" node");return pf(n).getOr("")},getOption:pf=function(n){return mf(n)?P.from(n.dom.nodeValue):P.none()},set:function(n,e){if(!mf(n))throw new Error("Can only set raw "+gf+" value of a "+gf+" node");n.dom.nodeValue=e}}),ve=ko([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),_f=ve.screen,wf=ve.absolute,Ke=[Bt("getSelection"),Dt("root"),Bt("bubble"),Hn(),jt("overrides",{}),jt("showAbove",!1),bu("placement",function(n,e,t){var o=mn(e.root).dom,r=vs(n,0,e),i=_s(o,e).bind(function(n){return ss(o,os.exactFromRange(n)).orThunk(function(){var e=I.fromText("\ufeff");return Sn(n.start,e),ss(o,os.exact(e,0,e,1)).map(function(n){return zr(e),n})}).bind(function(n){return hs(n.left,n.top,n.width,n.height)})}),n=_s(o,e).bind(function(n){return $n(n.start)?P.some(n.start):te(n.start)}).getOr(n.element);return bs(i,r,e,t,n)})],rc=[Dt("node"),Dt("root"),Bt("bubble"),Hn(),jt("overrides",{}),jt("showAbove",!1),bu("placement",function(t,o,r){var i=vs(t,0,o);return o.node.bind(function(n){var e=n.dom.getBoundingClientRect(),n=hs(e.left,e.top,e.width,e.height),e=o.node.getOr(t.element);return bs(n,i,o,r,e)})})],ic=[Dt("item"),Hn(),jt("overrides",{}),bu("placement",function(n,e,t){t=zc(t,e.item.element),n=Ka(n.element,e,Ts(),Ms(),Ts(),Ms(),P.none());return P.some({anchorBox:t,bubble:oa(),overrides:e.overrides,layouts:n,placer:P.none()})})],xf=At("anchor",{selection:Ke,node:rc,hotspot:pe,submenu:ic,makeshift:oe}),Of=function(n,e,t,o,r,i){i=i.map(Ic);return Sf(n,e,t,o,r,i)},Sf=function(i,u,n,e,c,a){var s=Rt("positioning anchor.info",xf,e);Vc(function(){nu(c.element,"position","fixed");var n=ru(c.element,"visibility");nu(c.element,"visibility","hidden");var e,t=u.useFixed()?(e=document.documentElement,La(0,0,e.clientWidth,e.clientHeight)):(e=yc((o=i).element),o=o.element.dom.getBoundingClientRect(),Va(e.left,e.top,o.width,o.height)),o=s.placement,r=a.map(y).or(u.getBounds);o(i,s,t).each(function(n){n.placer.getOr(Rs)(i,t,n,r,c)}),n.fold(function(){iu(c.element,"visibility")},function(n){nu(c.element,"visibility",n)}),ru(c.element,"left").isNone()&&ru(c.element,"top").isNone()&&ru(c.element,"right").isNone()&&ru(c.element,"bottom").isNone()&&ru(c.element,"position").is("fixed")&&iu(c.element,"position")},c.element)},Mo=Object.freeze({__proto__:null,position:function(n,e,t,o,r){Of(n,e,t,o,r,P.none())},positionWithin:Of,positionWithinBounds:Sf,getMode:function(n,e,t){return e.useFixed()?"fixed":"absolute"}}),Qo=[jt("useFixed",s),Bt("getBounds")],Ef=ro({fields:Qo,name:"positioning",active:Du,apis:Mo}),Cf=function(n,e){return n.components()},kf=ro({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,e,t,o){As(n,0,se,o)},prepend:function(n,e,t,o){As(n,0,En,o)},remove:Ds,replaceAt:Fs,replaceBy:function(e,n,t,o,r){var i=Cf(e);return k(i,o).bind(function(n){return Fs(e,0,0,n,r)})},set:function(e,n,t,o){Vc(function(){var n=x(o,e.getSystem().build);lc(e,n)},e.element)},contents:Cf})}),Tf="comments.readonly",Mf="comments.resize",Pn=Object.freeze({__proto__:null,getCurrent:function(n,e,t){return e.find(n)}}),qo=[Dt("find")],Rf=ro({fields:qo,name:"composing",apis:Pn}),Xu=Object.freeze({__proto__:null,focus:Bs,blur:function(n,e){e.ignore||n.element.dom.blur()},isFocused:function(n){return e=n.element,n=ie(e).dom,e.dom===n.activeElement;var e}}),Bo=Object.freeze({__proto__:null,exhibit:function(n,e){e=e.ignore?{}:{attributes:{tabindex:"-1"}};return no(e)},events:function(t){return Fr([Xt(pr(),function(n,e){Bs(n,t),e.stop()})].concat(t.stopMousedown?[Xt(ur(),function(n,e){e.event.prevent()})]:[]))}}),Jn=[n("onFocus"),jt("stopMousedown",!1),jt("ignore",!1)],Af=ro({fields:Jn,name:"focusing",active:Bo,apis:Xu}),oc=Object.freeze({__proto__:null,onLoad:Ps,onUnload:Hs,setValue:function(n,e,t,o){e.store.manager.setValue(n,e,t,o)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),ko=Object.freeze({__proto__:null,events:function(t,o){var n=t.resetOnDom?[Nr(function(n,e){Ps(n,t,o)}),Br(function(n,e){Hs(n,t,o)})]:[eo(t,o,Ps)];return Fr(n)}}),ve=function(){var n=fe(null);return nr({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},Ke=function(){var i=fe({}),u=fe({});return nr({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(n){return et(i.get(),n).orThunk(function(){return et(u.get(),n)})},update:function(n){var e=i.get(),t=u.get(),o={},r={};O(n,function(e){o[e.value]=e,et(e,"meta").each(function(n){et(n,"text").each(function(n){r[n]=e})})}),i.set(Z(Z({},e),o)),u.set(Z(Z({},t),r))},clear:function(){i.set({}),u.set({})}})},rc=Object.freeze({__proto__:null,memory:ve,dataset:Ke,manual:function(){return nr({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),pe=[Bt("initialValue"),Dt("getFallbackEntry"),Dt("getDataKey"),Dt("setValue"),bu("manager",{setValue:Is,getValue:function(n,e,t){var o=e.store,r=o.getDataKey(n);return t.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(n){return n})},onLoad:function(e,t,o){t.store.initialValue.each(function(n){Is(e,t,o,n)})},onUnload:function(n,e,t){t.clear()},state:Ke})],ic=[Dt("getValue"),jt("setValue",h),Bt("initialValue"),bu("manager",{setValue:function(n,e,t,o){e.store.setValue(n,o),e.onSetValue(n,o)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(e,t,n){t.store.initialValue.each(function(n){t.store.setValue(e,n)})},onUnload:h,state:Zo.init})],oe=[Bt("initialValue"),bu("manager",{setValue:function(n,e,t,o){t.set(o),e.onSetValue(n,o)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each(function(n){t.isNotSet()&&t.set(n)})},onUnload:function(n,e,t){t.clear()},state:ve})],Qo=[Vt("store",{mode:"memory"},At("mode",{memory:oe,manual:ic,dataset:pe})),n("onSetValue"),jt("resetOnDom",!1)],Df=ro({fields:Qo,name:"representing",active:ko,apis:oc,extra:{setValueFrom:function(n,e){e=Df.getValue(e);Df.setValue(n,e)}},state:rc}),Du=Object.freeze({__proto__:null,exhibit:function(n,e){return no({attributes:gt([{key:e.tabAttr,value:"true"}])})}}),Mo=[jt("tabAttr","data-alloy-tabstop")],Ff=ro({fields:Mo,name:"tabstopping",active:Du}),Nf=function(n,e,t,o){return js(0,e,0,o).bind(function(e){return e.transition.map(function(n){return{transition:n,route:e}})})},Bf=function(e,t,n){var o=e.element;return Ee(o,t.destinationAttr).map(function(n){return{start:Se(e.element,t.stateAttr),destination:n}})},qo=Object.freeze({__proto__:null,findRoute:js,disableTransition:Vs,getCurrentRoute:Bf,jumpTo:Ls,progressTo:function(e,t,o,r){var i,u;u=t,Ce((i=e).element,u.destinationAttr)&&(Ee(i.element,u.destinationAttr).each(function(n){Oe(i.element,u.stateAttr,n)}),ke(i.element,u.destinationAttr));var n,c,c=(n=t,c=r,{start:Se(e.element,n.stateAttr),destination:c});Nf(e,t,o,c).fold(function(){Ls(e,t,o,r)},function(n){Vs(e,t,o);n=n.transition;De(e.element,n.transitionClass),Oe(e.element,t.destinationAttr,r)})},getState:function(n,e,t){return Ee(n.element,e.stateAttr)}}),Pn=Object.freeze({__proto__:null,events:function(r,i){return Fr([Xt(dr(),function(t,n){var o=n.event.raw;Bf(t,r).each(function(e){js(0,r,0,e).each(function(n){n.transition.each(function(n){o.propertyName===n.property&&(Ls(t,r,i,e.destination),r.onTransition(t,e))})})})}),Nr(function(n,e){Ls(n,r,i,r.initialState)})])}}),Jn=[jt("destinationAttr","data-transitioning-destination"),jt("stateAttr","data-transitioning-state"),Dt("initialState"),n("onTransition"),n("onFinish"),Ft("routes",Go(Ge.value,Go(Ge.value,Ot([It("transition",[Dt("property"),Dt("transitionClass")])]))))],Pf=ro({fields:Jn,name:"transitioning",active:Pn,apis:qo,extra:{createRoutes:function(n){var t={};return $e(n,function(n,e){e=e.split("<->");t[e[0]]=Ho(e[1],n),t[e[1]]=Ho(e[0],n)}),t},createBistate:function(n,e,t){return gt([{key:n,value:Ho(e,t)},{key:e,value:Ho(n,t)}])},createTristate:function(n,e,t,o){return gt([{key:n,value:gt([{key:e,value:o},{key:t,value:o}])},{key:e,value:gt([{key:n,value:o},{key:t,value:o}])},{key:t,value:gt([{key:n,value:o},{key:e,value:o}])}])}}}),Bo=Xn().os.isOSX()?"":"Ctrl",Hf=ye({tc_menu_name:"TinyComments",tc_announce_sidebar_available:"Comment. Sidebar available. Press "+Bo+" + Alt + M to switch to sidebar",tc_items_addcomment:"Add comment",tc_items_showcomments:"Show comments",tc_items_deleteall:"Delete all conversations",tc_edit_buttons_save:"Save",tc_edit_buttons_cancel:"Cancel",tc_reply_buttons_save:"Save",tc_reply_buttons_clear:"Clear",tc_reply_placeholders:"Say something ...",tc_kebab_delete_conversation:"Delete conversation",tc_kebab_resolve_conversation:"Resolve conversation",tc_kebab_delete:"Delete",tc_kebab_edit:"Edit",tc_edit_problem_comment:"An error occurred editing this comment. See the Console for details.",tc_edit_unauthorised_comment:"You are not allowed to edit this comment",tc_delete_buttons_cancel:"Cancel",tc_delete_buttons_proceed:"Delete",tc_resolve_buttons_proceed:"Resolve",tc_create_problem:"An error occurred while creating a comment. See the Console for details",tc_reply_problem:"An error occurred while replying to a comment. See the Console for details",tc_delete_prompts_conversation:"Delete this conversation?",tc_delete_prompts_conversation_detail_sing:"1 comment will be deleted. You can't undo this action.",tc_delete_prompts_conversation_detail_pl:"{0} comments will be deleted. You can't undo this action.",tc_delete_prompts_all:"Delete all conversations in the content? This cannot be undone",tc_delete_prompts_comment:"Are you sure you want to delete this comment?",tc_resolve_prompts_conversation:"Resolve this conversation?",tc_resolve_prompts_conversation_detail_sing:"1 comment will be resolved. You can't undo this action.",tc_resolve_prompts_conversation_detail_pl:"{0} comments will be resolved. You can't undo this action.",tc_delete_problem_all:"An error occurred deleting all the conversations. See the Console for details.",tc_delete_problem_conversation:"An error occurred deleting the conversation. See the Console for details.",tc_delete_problem_comment:"An error occurred deleting the comment. See the Console for details.",tc_delete_unauthorised_all:"You are not allowed to delete all the conversations",tc_delete_unauthorised_conversation:"You are not allowed to delete this conversation",tc_delete_unauthorised_comment:"You are not allowed to delete this comment",tc_resolve_unauthorised_conversation:"You are not allowed to resolve this conversation",tc_resolve_problem_conversation:"An error occurred resolving the conversation. See the Console for details.",tc_date_less_than_a_minute_ago:"a moment ago",tc_date_1_minute_ago:"1 minute ago",tc_date_x_minutes_ago:"{0} minutes ago",tc_date_1_hour_ago:"1 hour ago",tc_date_x_hours_ago:"{0} hours ago",tc_date_1_day_ago:"1 day ago",tc_date_x_days_ago:"{0} days ago",tc_date_1_week_ago:"1 week ago",tc_date_x_weeks_ago:"{0} weeks ago",tc_date_1_month_ago:"1 month ago",tc_date_x_months_ago:"{0} months ago",tc_date_1_year_ago:"1 year ago",tc_date_x_years_ago:"{0} years ago",tc_date_comment_edited:" (edited)",tc_comment_buttons_showmore:"SHOW MORE",tc_comment_buttons_showless:"SHOW LESS"},f),If=function(n,e,t,o){(o?qs:Gs)(n,e,t)},Xu=Object.freeze({__proto__:null,onLoad:Ys,toggle:zs,isOn:function(n,e,t){return t.get()},on:qs,off:Gs,set:If}),Ke=Object.freeze({__proto__:null,exhibit:function(){return no({})},events:function(n,e){var t,o,r,i=(t=n,o=e,r=zs,Hr(function(n){r(n,t,o)})),e=eo(n,e,Ys);return Fr(T([n.toggleOnExecute?[i]:[],[e]]))}}),jf=function(n,e,t){Oe(n.element,"aria-expanded",t)},ve=[jt("selected",!1),Bt("toggleClass"),jt("toggleOnExecute",!0),Vt("aria",{mode:"none"},At("mode",{pressed:[jt("syncWithExpanded",!1),bu("update",function(n,e,t){Oe(n.element,"aria-pressed",t),e.syncWithExpanded&&jf(n,e,t)})],checked:[bu("update",function(n,e,t){Oe(n.element,"aria-checked",t)})],expanded:[bu("update",jf)],selected:[bu("update",function(n,e,t){Oe(n.element,"aria-selected",t)})],none:[bu("update",h)]}))],Vf=ro({fields:ve,name:"toggling",active:Ke,apis:Xu,state:(vf=!1,{init:function(){var e=fe(vf);return{get:function(){return e.get()},set:function(n){return e.set(n)},clear:function(){return e.set(vf)},readState:function(){return e.get()}}}})}),Lf=(hf=tf,function(n){return!hf(n)}),Wf=function(n,e,t,o){return Be(o.element,e.highlightClass)},Uf=function(n,e,t,o){e=Pe(n.element,"."+e.itemClass);return P.from(e[o]).fold(function(){return Ge.error("No element found with index "+o)},n.getSystem().getByDom)},zf=function(e,n,t){return ti(e.element,"."+n.itemClass).bind(function(n){return e.getSystem().getByDom(n).toOptional()})},qf=function(e,n,t){n=Pe(e.element,"."+n.itemClass);return(0<n.length?P.some(n[n.length-1]):P.none()).bind(function(n){return e.getSystem().getByDom(n).toOptional()})},Gf=function(e,n,t){n=Pe(e.element,"."+n.itemClass);return uf(x(n,function(n){return e.getSystem().getByDom(n).toOptional()}))},oe=Object.freeze({__proto__:null,dehighlightAll:function(n,e,t){return cf(n,e,0,[])},dehighlight:function(n,e,t,o){Wf(n,e,t,o)&&(Ne(o.element,e.highlightClass),e.onDehighlight(n,o),Gt(o,Ar()))},highlight:af,highlightFirst:function(e,t,o){zf(e,t).each(function(n){af(e,t,o,n)})},highlightLast:function(e,t,o){qf(e,t).each(function(n){af(e,t,o,n)})},highlightAt:function(e,t,o,n){Uf(e,t,o,n).fold(function(n){throw new Error(n)},function(n){af(e,t,o,n)})},highlightBy:function(e,t,o,n){var r=Gf(e,t);C(r,n).each(function(n){af(e,t,o,n)})},isHighlighted:Wf,getHighlighted:function(e,n,t){return ti(e.element,"."+n.highlightClass).bind(function(n){return e.getSystem().getByDom(n).toOptional()})},getFirst:zf,getLast:qf,getPrevious:function(n,e,t){return sf(n,e,0,-1)},getNext:function(n,e,t){return sf(n,e,0,1)},getCandidates:Gf}),ic=[Dt("highlightClass"),Dt("itemClass"),n("onHighlight"),n("onDehighlight")],Yf=ro({fields:ic,name:"highlighting",apis:oe});(pe=bf=bf||{}).OnFocusMode="onFocus",pe.OnEnterOrSpaceMode="onEnterOrSpace",pe.OnApiMode="onApi";function Kf(n,e,t,o,c){function a(e,t,n,o,r){var i;return n=n=n(e,t,o,r),i=t.event,C(n,function(n){return n.matches(i)}).map(function(n){return n.classification}).bind(function(n){return n(e,t,o,r)})}var r={schema:function(){return n.concat([jt("focusManager",lf()),Vt("focusInside","onFocus",kt(function(n){return w(["onFocus","onEnterOrSpace","onApi"],n)?Ge.value(n):Ge.error("Invalid value for focusInside")})),bu("handler",r),bu("state",e),bu("sendFocusIn",c)])},processKey:a,toEvents:function(i,u){var n=i.focusInside!==bf.OnFocusMode?P.none():c(i).map(function(t){return Xt(pr(),function(n,e){t(n,i,u),e.stop()})}),e=[Xt(ar(),function(o,r){a(o,r,t,i,u).fold(function(){var e,t,n;e=o,t=r,n=nf(ai.concat(ui))(t.event),i.focusInside===bf.OnEnterOrSpaceMode&&n&&Ut(e,t)&&c(i).each(function(n){n(e,i,u),t.stop()})},function(n){r.stop()})}),Xt(sr(),function(n,e){a(n,e,o,i,u).each(function(n){e.stop()})})];return Fr(n.toArray().concat(e))}};return r}function Qf(n){return"input"===fn(n)&&"radio"!==Se(n,"type")||"textarea"===fn(n)}function Xf(n,e){return P.some(!0)}function Jf(n,e,t){return t.execute(n,e,n.element)}function $f(i){return function(n,e,t,o){var r=i(n.element);return zl(r,n,e,t,o)}}function Zf(n,e){return e=Sa(n,e),$f(e)}function nl(n,e){return n=Sa(e,n),$f(n)}function el(n,e,t){var o,t=Pe(n,t),t=S(t,Ns);return k(o=t,function(n){return sn(n,e)}).map(function(n){return{index:n,candidates:o}})}function tl(n,e){return k(n,function(n){return sn(e,n)})}function ol(e,n,t,o){return o(Math.floor(n/t),n%t).bind(function(n){n=n.row*t+n.column;return 0<=n&&n<e.length?P.some(e[n]):P.none()})}function rl(o,n,r,i,u){return ol(o,n,i,function(n,e){var t=n===r-1?o.length-n*i:i,t=qc(e,u,0,t-1);return P.some({row:n,column:t})})}function il(o,n,r,i,u){return ol(o,n,i,function(n,e){var t=qc(n,u,0,r-1),n=t===r-1?o.length-t*i:i,n=Gc(e,0,n-1);return P.some({row:t,column:n})})}function ul(e,t,n){ti(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})}function cl(n,e,t,r){var i=function(n,e,t){var o=qc(e,r,0,t.length-1);return o===n?P.none():(e=t[o],"button"===fn(e)&&"disabled"===Se(e,"disabled")?i(n,o,t):P.from(t[o]))};return el(n,t,e).bind(function(n){var e=n.index,n=n.candidates;return i(e,e,n)})}function al(e,t,o){return n=e,(r=o).focusManager.get(n).bind(function(n){return oi(n,r.selector)}).bind(function(n){return o.execute(e,t,n)});var n,r}function sl(e,t,n){t.getInitial(e).orThunk(function(){return ti(e.element,t.selector)}).each(function(n){t.focusManager.set(e,n)})}function fl(n,e,t){return cl(n,t.selector,e,-1)}function ll(n,e,t){return cl(n,t.selector,e,1)}function dl(r){return function(n,e,t,o){return r(n,e,t,o).bind(function(){return t.executeOnMove?al(n,e,t):P.some(!0)})}}function ml(n,e,t){return t.onEscape(n,e)}function gl(n,e,t){return P.from(n[e]).bind(function(n){return P.from(n[t]).map(function(n){return{rowIndex:e,columnIndex:t,cell:n}})})}function pl(n,e,t,o){var r=n[e].length,r=qc(t,o,0,r-1);return gl(n,e,r)}function vl(n,e,t,o){return t=qc(t,o,0,n.length-1),o=n[t].length,o=Gc(e,0,o-1),gl(n,t,o)}function hl(n,e,t,o){var r=n[e].length,r=Gc(t+o,0,r-1);return gl(n,e,r)}function bl(n,e,t,o){return t=Gc(t+o,0,n.length-1),o=n[t].length,o=Gc(e,0,o-1),gl(n,t,o)}function yl(e,t,n){t.previousSelector(e).orThunk(function(){var n=t.selectors;return ti(e.element,n.cell)}).each(function(n){t.focusManager.set(e,n)})}function _l(e,t,n){ti(e.element,t.selector).each(function(n){t.focusManager.set(e,n)})}function wl(n,e,t){return cl(n,t.selector,e,-1)}function xl(n,e,t){return cl(n,t.selector,e,1)}function Ol(n,e,t){(e.disabled()?od:rd)(n,e)}function Sl(n,e){return!0===e.useNative&&w(td,fn(n.element))}function El(n){Oe(n.element,"disabled","disabled")}function Cl(n){ke(n.element,"disabled")}function kl(n){Oe(n.element,"aria-disabled","true")}function Tl(n){Oe(n.element,"aria-disabled","false")}function Ml(n,e){return Sl(n,e)?Ce(n.element,"disabled"):"true"===Se(n.element,"aria-disabled")}function Rl(n){return id.config(n)}function Al(){var n={};return n[Tf]={schema:Ot([Ft("readonly",Xo)]),onReceive:function(n,e){id.set(n,e.readonly)}},n}function Dl(n){return[Rl(n),ud.config({channels:Al()})]}function Fl(t){return function(n){var e=n.eventName.map(function(e){return{action:function(n){Gt(n,e)}}}).getOr({});return ed.sketch(Z(Z({dom:{tag:"button",classes:t,styles:void 0!==n.styles?n.styles:{},innerHtml:n.text}},e),{buttonBehaviours:Vr(en([Ff.config({})],Dl({})))}))}}var Nl,Bl,Pl,Hl,Il,jl,Vl,Ll,Wl,Qo=function(n){function i(n,e){return n=n.visibilitySelector.bind(function(n){return oi(e,n)}).getOr(e),0<Mc(n)}function e(e,t,n){(function(n,e){n=Pe(n.element,e.selector),n=S(n,function(n){return i(e,n)});return P.from(n[e.firstTabstop])})(e,t).each(function(n){t.focusManager.set(e,n)})}function c(e,n,t,o,r){return r(n,t,function(n){return i(e=o,n=n)&&e.useTabstopAt(n);var e}).fold(function(){return o.cyclic?P.some(!0):P.none()},function(n){return o.focusManager.set(e,n),P.some(!0)})}function r(e,n,t,o){var r,i,u=Pe(e.element,t.selector);return r=e,(i=t).focusManager.get(r).bind(function(n){return oi(n,i.selector)}).bind(function(n){return k(u,d(sn,n)).bind(function(n){return c(e,u,n,t,o)})})}var t=[Bt("onEscape"),Bt("onEnter"),jt("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),jt("firstTabstop",0),jt("useTabstopAt",v),Bt("visibilitySelector")].concat([n]),o=y([rf(ef([tf,nf(ii)]),function(n,e,t){var o=t.cyclic?Xs:Js;return r(n,0,t,o)}),rf(nf(ii),function(n,e,t){var o=t.cyclic?$s:Zs;return r(n,0,t,o)}),rf(nf(ci),function(e,t,n){return n.onEscape.bind(function(n){return n(e,t)})}),rf(ef([Lf,nf(ui)]),function(e,t,n){return n.onEnter.bind(function(n){return n(e,t)})})]),n=y([]);return Kf(t,Zo.init,o,n,function(){return P.some(e)})},ko=Qo(Lt("cyclic",s)),oc=Qo(Lt("cyclic",v)),rc=function(n,e,t){return Qf(t)&&nf(ai)(e.event)?P.none():(Qt(n,t,yr()),P.some(!0))},Mo=[jt("execute",rc),jt("useSpace",!1),jt("useEnter",!0),jt("useControlEnter",!1),jt("useDown",!1)],Du=Kf(Mo,Zo.init,function(n,e,t,o){var r=t.useSpace&&!Qf(n.element)?ai:[],i=t.useEnter?ui:[],n=t.useDown?di:[],n=r.concat(i).concat(n);return[rf(nf(n),Jf)].concat(t.useControlEnter?[rf(ef([of,nf(ui)]),Jf)]:[])},function(n,e,t,o){return t.useSpace&&!Qf(n.element)?[rf(nf(ai),Xf)]:[]},function(){return P.none()}),Jn=function(){var t=fe(P.none());return nr({readState:function(){return t.get().map(function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(P.some({numRows:n,numColumns:e}))},getNumRows:function(){return t.get().map(function(n){return n.numRows})},getNumColumns:function(){return t.get().map(function(n){return n.numColumns})}})},Ul=Object.freeze({__proto__:null,flatgrid:Jn,init:function(n){return n.state(n)}}),Pn=function(r){return function(n,e,t,o){return zl(r,n,e,t,o)}},zl=function(e,t,n,o,r){return o.focusManager.get(t).bind(function(n){return e(t.element,n,o,r)}).map(function(n){return o.focusManager.set(t,n),!0})},qo=Pn,Bo=Pn,ql=Pn,ve=[Dt("selector"),jt("execute",rc),W("onEscape"),jt("captureTab",!1),Bn()],Ke=function(r){return function(n,e,t,o){return el(n,e,t.selector).bind(function(n){return r(n.candidates,n.index,o.getNumRows().getOr(t.initSize.numRows),o.getNumColumns().getOr(t.initSize.numColumns))})}},Xu=function(n,e,t){return t.captureTab?P.some(!0):P.none()},ic=Ke(function(n,e,t,o){return rl(n,e,t,o,-1)}),oe=Ke(function(n,e,t,o){return rl(n,e,t,o,1)}),pe=Ke(function(n,e,t,o){return il(n,e,t,o,-1)}),Qo=Ke(function(n,e,t,o){return il(n,e,t,o,1)}),Mo=y([rf(nf(si),Zf(ic,oe)),rf(nf(li),nl(ic,oe)),rf(nf(fi),qo(pe)),rf(nf(di),Bo(Qo)),rf(ef([tf,nf(ii)]),Xu),rf(ef([Lf,nf(ii)]),Xu),rf(nf(ci),function(n,e,t){return t.onEscape(n,e)}),rf(nf(ai.concat(ui)),function(e,t,o,n){return r=e,(i=o).focusManager.get(r).bind(function(n){return oi(n,i.selector)}).bind(function(n){return o.execute(e,t,n)});var r,i})]),Pn=y([rf(nf(ai),Xf)]),Ke=Kf(ve,Jn,Mo,Pn,function(){return P.some(ul)}),ic=[Dt("selector"),jt("getInitial",P.none),jt("execute",rc),W("onEscape"),jt("executeOnMove",!1),jt("allowVertical",!0)],oe=y([rf(nf(ai),Xf)]),pe=Kf(ic,Zo.init,function(n,e,t,o){var r=si.concat(t.allowVertical?fi:[]),t=li.concat(t.allowVertical?di:[]);return[rf(nf(r),dl(Zf(fl,ll))),rf(nf(t),dl(nl(fl,ll))),rf(nf(ui),al),rf(nf(ai),al),rf(nf(ci),ml)]},oe,function(){return P.some(sl)}),Qo=[Nt("selectors",[Dt("row"),Dt("cell")]),jt("cycles",!0),jt("previousSelector",P.none),jt("execute",rc)],Xu=function(n,e){return function(t,o,i){var u=i.cycles?n:e;return oi(o,i.selectors.row).bind(function(n){var e=Pe(n,i.selectors.cell);return tl(e,o).bind(function(o){var r=Pe(t,i.selectors.row);return tl(r,n).bind(function(n){var e,t=(e=i,x(r,function(n){return Pe(n,e.selectors.cell)}));return u(t,n,o).map(function(n){return n.cell})})})})}},ve=Xu(function(n,e,t){return pl(n,e,t,-1)},function(n,e,t){return hl(n,e,t,-1)}),Jn=Xu(function(n,e,t){return pl(n,e,t,1)},function(n,e,t){return hl(n,e,t,1)}),Mo=Xu(function(n,e,t){return vl(n,t,e,-1)},function(n,e,t){return bl(n,t,e,-1)}),Pn=Xu(function(n,e,t){return vl(n,t,e,1)},function(n,e,t){return bl(n,t,e,1)}),ic=y([rf(nf(si),Zf(ve,Jn)),rf(nf(li),nl(ve,Jn)),rf(nf(fi),qo(Mo)),rf(nf(di),Bo(Pn)),rf(nf(ai.concat(ui)),function(e,t,o){return ao(e.element).bind(function(n){return o.execute(e,t,n)})})]),oe=y([rf(nf(ai),Xf)]),Xu=Kf(Qo,Zo.init,ic,oe,function(){return P.some(yl)}),ve=[Dt("selector"),jt("execute",rc),jt("moveOnTab",!1)],Jn=function(e,t,o){return o.focusManager.get(e).bind(function(n){return o.execute(e,t,n)})},qo=y([rf(nf(fi),ql(wl)),rf(nf(di),ql(xl)),rf(ef([tf,nf(ii)]),function(n,e,t,o){return t.moveOnTab?ql(wl)(n,e,t,o):P.none()}),rf(ef([Lf,nf(ii)]),function(n,e,t,o){return t.moveOnTab?ql(xl)(n,e,t,o):P.none()}),rf(nf(ui),Jn),rf(nf(ai),Jn)]),Mo=y([rf(nf(ai),Xf)]),Bo=Kf(ve,Zo.init,qo,Mo,function(){return P.some(_l)}),Pn=[W("onSpace"),W("onEnter"),W("onShiftEnter"),W("onLeft"),W("onRight"),W("onTab"),W("onShiftTab"),W("onUp"),W("onDown"),W("onEscape"),jt("stopSpaceKeyup",!1),Bt("focusIn")],Qo=Kf(Pn,Zo.init,function(n,e,t){return[rf(nf(ai),t.onSpace),rf(ef([Lf,nf(ui)]),t.onEnter),rf(ef([tf,nf(ui)]),t.onShiftEnter),rf(ef([tf,nf(ii)]),t.onShiftTab),rf(ef([Lf,nf(ii)]),t.onTab),rf(nf(fi),t.onUp),rf(nf(di),t.onDown),rf(nf(si),t.onLeft),rf(nf(li),t.onRight),rf(nf(ai),t.onSpace),rf(nf(ci),t.onEscape)]},function(n,e,t){return t.stopSpaceKeyup?[rf(nf(ai),Xf)]:[]},function(n){return n.focusIn}),Gl=ko.schema(),Yl=oc.schema(),Kl=pe.schema(),Ql=Ke.schema(),Xl=Xu.schema(),Jl=Du.schema(),$l=Bo.schema(),Zl=Qo.schema(),nd=(Vl=Rt("Creating behaviour: "+(Nl={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Gl,cyclic:Yl,flow:Kl,flatgrid:Ql,matrix:Xl,execution:Jl,menu:$l,special:Zl}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(e,t,o){t.sendFocusIn(t).fold(function(){e.getSystem().triggerFocus(e.element,e.element)},function(n){n(e,t,o)})},setGridSize:function(n,e,t,o,r){we(t,"setGridSize")?t.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Ul}).name,Wr,Nl),Bl=At(Vl.branchKey,Vl.branches),Pl=Vl.name,Hl=Vl.active,Il=Vl.apis,jl=Vl.extra,Nl=Vl.state,Bl=Ht(Pl,[Pt("config",Vl=Bl)]),jr(Vl,Bl,Pl,Hl,Il,jl,Nl)),ed=ki({name:"Button",factory:function(n){function t(e){return et(n.dom,"attributes").bind(function(n){return et(n,e)})}var e=Qs(n.action),o=n.dom.tag;return{uid:n.uid,dom:n.dom,components:n.components,events:e,behaviours:Gu(n.buttonBehaviours,[Af.config({}),nd.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==o)return{role:t("role").getOr("button")};var n=t("type").getOr("button"),e=t("role").map(function(n){return{role:n}}).getOr({});return Z({type:n},e)}()},eventOrder:n.eventOrder}},configFields:[jt("uid",void 0),Dt("dom"),jt("components",[]),qu("buttonBehaviours",[Af,nd]),Bt("action"),Bt("role"),jt("eventOrder",{})]}),td=["input","button","textarea","select"],od=function(e,n,t){n.disableClass.each(function(n){De(e.element,n)}),(Sl(e,n)?El:kl)(e),n.onDisabled(e)},rd=function(e,n,t){n.disableClass.each(function(n){Ne(e.element,n)}),(Sl(e,n)?Cl:Tl)(e),n.onEnabled(e)},ic=Object.freeze({__proto__:null,enable:rd,disable:od,isDisabled:Ml,onLoad:Ol,set:function(n,e,t,o){(o?od:rd)(n,e)}}),oe=Object.freeze({__proto__:null,exhibit:function(n,e){return no({classes:e.disabled()?e.disableClass.toArray():[]})},events:function(t,n){return Fr([{key:yr(),value:zt({abort:function(n,e){return Ml(n,t)}})},eo(t,n,Ol)])}}),rc=[Vt("disabled",s,Jo),jt("useNative",!0),Bt("disableClass"),n("onDisabled"),n("onEnabled")],id=ro({fields:rc,name:"disabling",active:oe,apis:ic}),Jn=Object.freeze({__proto__:null,events:function(u){return Fr([Xt(br(),function(o,n){var e,r=u.channels,t=Xe(r),i=n,t=(t=t,(e=i).universal?t:S(t,function(n){return w(e.channels,n)}));O(t,function(n){var e=r[n],t=e.schema,t=Rt("channel["+n+"] data\nReceiver: "+po(o.element),t,i.data);e.onReceive(o,t)})})])}}),ve=[Ft("channels",Go(Ge.value,Ot([U("onReceive"),jt("schema",Ko())])))],ud=ro({fields:ve,name:"receiving",active:Jn}),qo="tox-button--naked",cd="tox-comment",Mo="tox-comment__body",Pn="tox-textarea",ko="tox-comment__reply",oc="tox-comment__overlay",pe="tox-comment__overlaytext",Ke="tox-comment__buttonspacing",Xu="tox-button",Du="tox-comment__edit",Bo="tox-comment__scroll",Qo="tox-collection__item",rc="tox-conversations",oe="tox-comment__expander",ic=oe+" p:contains("+Hf.tc_comment_buttons_showmore+")",ve=oe+" p:contains("+Hf.tc_comment_buttons_showless+")",Jn=function(e){return function(n){return["."+cd+":contains("+n+")","."+e].join(" ")}},ad={kebab:"."+qo,cardBody:"."+cd+" ."+Mo,card:"."+cd,showMore:"."+ic,showLess:"."+ve,editItem:[".tox-menu",'[role="menuitem"]:contains('+Hf.tc_kebab_edit+")"].join(" "),deleteItem:[".tox-menu",'[role="menuitem"]:contains('+Hf.tc_kebab_delete+")"].join(" "),deleteConversationItem:[".tox-menu",'[role="menuitem"]:contains('+Hf.tc_kebab_delete_conversation+")"].join(" "),resolveConversationItem:[".tox-menu",'[role="menuitem"]:contains('+Hf.tc_kebab_resolve_conversation+")"].join(" "),outerScroll:"."+Bo,outerContainer:"."+rc,cardFor:function(n){return"."+cd+':contains("'+n+'")'},cardN:function(n){return"."+cd+":nth-child("+(n+1)+")"},kebabFor:Jn(qo),showMoreFor:Jn(ic),showLessFor:Jn(ve),saveButton:".tox-button:contains("+Hf.tc_edit_buttons_save+")",cancelButton:".tox-button:contains("+Hf.tc_edit_buttons_cancel+")",clearButton:".tox-button:contains("+Hf.tc_reply_buttons_clear+")",deleteButton:".tox-button:contains("+Hf.tc_delete_buttons_proceed+")",resolveButton:".tox-button:contains("+Hf.tc_resolve_buttons_proceed+")",commentText:["."+rc,"."+Bo,"."+cd,"textarea"].join(" "),editActions:"."+Du,cardOverlay:"."+oc,cardOverlayText:"."+pe,cardOverlayButtons:"."+Ke,replyTextarea:"."+ko+" textarea",editTextarea:["."+cd,"textarea"].join(" "),kebabMenu:".tox-menu",textarea:"."+Pn},sd={kebabOpen:qo+"--open",bodyExpanded:"tox-comment__body--expanded",bodyNotAnimating:"tox-comment__body--pending",disappearing:"tox-comment--disappearing",commentThreadOverlay:"tox-comment-thread__overlay",bodyHasGradient:"tox-comment__gradient",editingTextarea:Pn},fd={showMoreLessContainer:[oe],outerContainer:[rc],date:["tox-comment__date"],replySection:[ko],replyTextarea:[Pn],textarea:[],editTextarea:[],kebab:[qo,Xu,"tox-button--icon"],kebabIcon:["tox-icon"],card:[cd],cardHead:["tox-comment__header"],cardHeadMeta:["tox-comment__meta"],cardBody:[Mo],cardOverlay:[oc],cardOverlayText:[pe],cardOverlayButtons:[Ke],button:[Xu],secondaryButton:[Xu,"tox-button--secondary"],editActions:[Du],outerScroll:[Bo],commentList:["tox-comment-thread"],avatar:["tox-user__avatar"],username:["tox-user__name"],user:["tox-user"],showMoreLess:[],kebabItem:[Qo],kebabItemLabel:["tox-collection__item-label"],kebabDisabledItem:["tox-collection__item--state-disabled"],kebabMenu:["tox-menu","tox-collection","tox-collection--list"],kebabMenuGroup:["tox-collection__group"],roots:{silver:[rc],modern:[rc,"tox"]}},ld={kebab:{backgroundMenu:"tox-menu--background",selectedMenu:"tox-menu--active",menu:"tox-menu",item:Qo,selectedItem:"tox-collection__item--active"}},dd=Fl(fd.button),md=Fl(fd.secondaryButton),gd="tc-save-edit",pd="tc-cancel-edit",vd=wi("tc-patch-comment-state-event"),hd=wi("tc-purge-comment-state-event"),bd=wi("tc-force-patch-state-event");(rc=Ll=Ll||{}).None="Prop_None",rc.Collapsed="Prop_Collapsed",rc.Expanded="Prop_Expanded",rc.CollapsedOrNone="Prop_CollapsedOrNone",rc.ExpandOrNone="Prop_ExpandOrNone",rc.Edit="Prop_Edit",(Qo=Wl=Wl||{})[Qo.Before=0]="Before",Qo[Qo.QueryingDelete=1]="QueryingDelete",Qo[Qo.QueryingResolve=2]="QueryingResolve",Qo[Qo.PostDelete=3]="PostDelete",Qo[Qo.PostResolve=4]="PostResolve";function yd(n){return x(n.conversation,function(n){return n.props})}function _d(n,e){return Z(Z({},n),{targetUid:e})}function wd(n){if(0<n.queue.length){n=(n=x((e=n).conversation,function(t){return C(e.queue,function(n){return n.uid===t.uid}).fold(function(){return t},function(n){var e=void 0!==n.patch.content?{mode:Ll.ExpandOrNone}:{};return{uid:t.uid,props:Z(Z(Z({},t.props),n.patch),e)}})}),{targetUid:e.targetUid,conversation:n,queue:[]});return P.some({world:n,props:yd(n)})}return P.none();var e}function xd(){return{targetUid:P.none(),conversation:[],queue:[]}}function Od(t,o){return function(n){var e=o(n);Yt(n,vd,{uid:t,patch:e})}}function Sd(t,o){return function(n){var e=o(n);Yt(n,vd,{uid:t,patch:e}),Gt(n,bd)}}function Ed(n){Gt(n,bd)}function Cd(n,e){nu(n.element,"visibility","hidden"),Vf.set(n,!1);var t=n.element.dom.clientHeight;return Vf.set(n,!0),iu(n.element,"visibility"),n.element.dom.scrollHeight>t+1?e:Ll.None}function kd(n){Vf.off(n),De(n.element,sd.bodyHasGradient)}function Td(n){Vf.on(n),Ne(n.element,sd.bodyHasGradient)}function Md(n){return hn(n.element)}function Rd(n){Ne(n.element,sd.bodyHasGradient),Vf.set(n,!1),ke(n.element,"aria-expanded")}function Ad(o){function n(n){return function(e){O(n,function(n){return n(e)})}}function e(t){Md(t).each(function(n){var e=ru(n,"width");nu(n,"width",Ac(n)+"px"),iu(n,"height"),Df.setValue(t,o.props.content),t.getSystem().triggerEvent(fr(),n,{}),tu(n,{width:e})})}function t(n){return e=n,n=o.memCommands,Ud(e),void n.getOpt(e).each(function(n){kf.remove(e,n)});var e}var r=((r={})[Ll.None]=n([t,e,Rd]),r[Ll.Expanded]=n([t,e,Td]),r[Ll.Collapsed]=n([t,e,kd]),r[Ll.ExpandOrNone]=n([t,e,function(n){De(n.element,sd.bodyNotAnimating);var e=Cd(n,Ll.Expanded);Od(o.props.uid,function(){return{mode:e}})(n)}]),r[Ll.CollapsedOrNone]=n([t,e,function(n){De(n.element,sd.bodyNotAnimating);var e=Cd(n,Ll.Collapsed);e===Ll.Collapsed&&(De(n.element,sd.bodyHasGradient),Vf.off(n)),n.element.dom.offsetWidth,Od(o.props.uid,function(){return{mode:e}})(n)}]),r[Ll.Edit]=n([function(n){return e=n,n=o.memCommands,Vf.on(e),Ne(e.element,sd.bodyHasGradient),void Ld(e,n);var e},e]),r);return et(r,o.props.mode)}function Dd(n){return Z(Z({},(e=n,Vr([Af.config({onFocus:e.selectOnFocus?function(n){var e=n.element,n=uu(e);e.dom.setSelectionRange(0,n.length)}:h})]))),pu(n.inputBehaviours,[Df.config({store:Z(Z({mode:"manual"},n.data.map(function(n){return{initialValue:n}}).getOr({})),{getValue:function(n){return uu(n.element)},setValue:function(n,e){uu(n.element)!==e&&cu(n.element,e)}}),onSetValue:n.onSetValue})]));var e}function Fd(n){return nd.config({mode:"cyclic",onEscape:n.onEscape,useTabstopAt:function(n){return"textarea"!==fn(n)||"true"!==Se(n,"readonly")}})}function Nd(e){return nd.config({mode:"special",onEnter:function(n){return Gt(n,e.enterEvent),P.some(!0)},onShiftEnter:function(n,e){return e.cut(),P.none()},onSpace:function(n,e){return e.cut(),P.none()}})}function Bd(n){var e=(t=n.element.dom).clientHeight,t=t.scrollHeight;e<t&&(e=Mc(n.element)-e,nu(n.element,"height",t+e+"px"))}function Pd(n){var e,o=(e=fe(P.none()),{clear:function(){return e.set(P.none())},set:function(n){return e.set(P.some(n))},isSet:function(){return e.get().isSome()},on:function(n){return e.get().each(n)}});return Zd.sketch({tag:"textarea",inputAttributes:Z(Z({},em),{readonly:"true"}),inputClasses:fd.editTextarea,inputStyles:Z(Z({},tm),{"overflow-y":"hidden",border:"none !important"}),data:n,inputBehaviours:Vr([io("textarea-events",[Nr(function(n){o.set(Ac(n.element)),Bd(n)}),Xt(fr(),Bd)]),ud.config({channels:Z(Z({},Al()),((n={})[Mf]={onReceive:function(e){var t=Ac(e.element);o.on(function(n){n!==t&&iu(e.element,"height")}),o.set(t),Bd(e)}},n))}),Nd({enterEvent:Jd}),Ff.config({}),Rl({})])})}function Hd(n,e){function t(n){Gt(n,zd),Sd(o.get().uid,function(n){return{mode:Ll.ExpandOrNone}})(n)}var o=fe(n),r={updateWith:function(e,n,t){o.set(n),Ad({props:n,memCommands:i}).each(function(n){Ne(e.element,sd.bodyNotAnimating),n(e)})}},i=hc((o.get(),e=e,{dom:{tag:"div",classes:fd.editActions},components:[Fl(fd.secondaryButton)({text:e.translate(Hf.tc_edit_buttons_cancel),eventName:P.some(pd)}),Fl(fd.button)({text:e.translate(Hf.tc_edit_buttons_save),eventName:P.some(gd)})]}));return{dom:{tag:"div",classes:fd.cardBody},components:[Pd(o.get().content)],behaviours:Vr([io("overflow-events",[Nr(function(n){r.updateWith(n,o.get(),{})}),Xt(gd,function(n){Gt(n,Jd)}),Xt(pd,t),(e=dr(),Jt(e)(function(e,n){"max-height"===n.event.raw.propertyName&&hn(e.element).each(function(n){e.getSystem().triggerEvent(fr(),n,{})})}))]),Fd({onEscape:function(n){return t(n),P.some(!0)}}),Vf.config({toggleClass:sd.bodyExpanded,selected:!1,toggleOnExecute:!1,aria:{mode:"expanded"}}),Df.config({store:{mode:"manual",getValue:function(n){return hn(n.element).map(uu).getOr("")},setValue:function(n,e){hn(n.element).each(function(n){cu(n,e)})}}}),kf.config({})]),apis:r}}function Id(){return(new Date).toISOString()}var jd,Vd=function(n,e){return Z(Z({},n),{queue:n.queue.concat(e)})},Ld=function(n,e){Wd(n),e.getOpt(n).fold(function(){kf.append(n,e.asSpec())},h)},Wd=function(n){Md(n).each(function(n){ke(n,"readonly"),De(n,sd.editingTextarea),uo(n);var e=n.dom,n=uu(n).length;e.setSelectionRange(n,n)}),n.element.dom.scrollTop=0},Ud=function(n){Md(n).each(function(n){Oe(n,"readonly","true"),Ne(n,sd.editingTextarea)})},zd=wi("tc-focus-outer-comment"),qd=wi("tc-start-delete-comment"),Gd=wi("tc-start-delete-conversation"),Yd=wi("tc-start-resolve-conversation"),Kd=wi("tc-commit-delete"),Qd=wi("tc-commit-resolve"),Xd=wi("tc-start-edit-comment"),Jd=wi("tc-commit-edit-comment"),$d=(wi("tc-cancel-edit-comment"),wi("tc-long-content"),wi("tc-short-content"),wi("tc-toggle-comment")),rc=y([Bt("data"),jt("inputAttributes",{}),jt("inputStyles",{}),jt("tag","input"),jt("inputClasses",[]),n("onSetValue"),jt("styles",{}),jt("eventOrder",{}),zu("inputBehaviours",[Df,Af]),jt("selectOnFocus",!0)]),Zd=ki({name:"Input",configFields:rc(),factory:function(n,e){return{uid:n.uid,dom:{tag:(t=n).tag,attributes:Z({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses},components:[],behaviours:Dd(n),eventOrder:n.eventOrder};var t}}),nm="data-alloy-widget-tabstop",em={"data-gramm_editor":"false",rows:"2"},tm={"white-space":"pre-wrap"},om=6048e5,rm=4*om;(Qo=jd=jd||{})[Qo.LessThanMinute=0]="LessThanMinute",Qo[Qo.Minute=1]="Minute",Qo[Qo.Hour=2]="Hour",Qo[Qo.Day=3]="Day",Qo[Qo.Week=4]="Week",Qo[Qo.Month=5]="Month",Qo[Qo.Year=6]="Year";function im(n,r){function o(n){return[function(n){n=I.fromText(n);return Vu({element:n})}(""+(e=vm(n.createdAt),t=r,o=hm[e.interval],o=1===e.intervalUnits?o[0]:o[1],t.translate([o,e.intervalUnits]))),{dom:{tag:"span",classes:[],innerHtml:n.modifiedAt===n.createdAt?"":r.translate(Hf.tc_date_comment_edited)}}];var e,t,o}var e={updateWith:function(n,e,t){kf.set(n,o(e))}};return{dom:{tag:"div",classes:fd.date},components:o(n),behaviours:Vr([kf.config({})]),apis:e}}function um(e,n){return ni(n,function(n){if(!$n(n))return!1;n=Se(n,"id");return void 0!==n&&-1<n.indexOf("aria-owns")}).bind(function(n){var e=Se(n,"id"),n=ie(n);return ti(n,'[aria-owns="'+e+'"]')}).exists(function(n){return ym(e,n)})}function cm(e,n,t,o){return t.get().each(function(n){pc(e)}),n=n.getAttachPoint(e),dc(n,e),o=e.getSystem().build(o),dc(e,o),t.set(o),o}function am(n,e,t,o){return o=cm(n,e,t,o),e.onOpen(n,o),o}function sm(e,t,o){o.get().each(function(n){pc(e),gc(e),t.onClose(e,n),o.clear()})}function fm(n,e,t){return t.isOpen()}function lm(n){(ao(n.element).isNone()||Af.isFocused(n))&&(Af.isFocused(n)||Af.focus(n),Yt(n,Sm,{item:n}))}function dm(n){Yt(n,Em,{item:n})}function mm(){return"item-widget"}function gm(n,e){var t={};$e(n,function(n,e){O(n,function(n){t[n]=e})});var o=e,r=Ze(e,function(n,e){return{k:n,v:e}}),i=ye(r,function(n,e){return[e].concat(Dm(t,o,r,e))});return ye(t,function(n){return et(i,n).getOr([n])})}var pm,vm=d(function(n,e){e=n()-Date.parse(e);return e<6e4?{interval:jd.LessThanMinute,intervalUnits:e,intervalMs:e}:e<36e5?{interval:jd.Minute,intervalUnits:Math.floor(e/6e4),intervalMs:e}:e<864e5?{interval:jd.Hour,intervalUnits:Math.floor(e/36e5),intervalMs:e}:e<om?{interval:jd.Day,intervalUnits:Math.floor(e/864e5),intervalMs:e}:e<rm?{interval:jd.Week,intervalUnits:Math.floor(e/om),intervalMs:e}:e<290304e5?{interval:jd.Month,intervalUnits:Math.floor(e/rm),intervalMs:e}:{interval:jd.Year,intervalUnits:Math.floor(e/290304e5),intervalMs:e}},function(){return Date.now()}),rc=jd,hm=((Qo={})[rc.LessThanMinute]=[Hf.tc_date_less_than_a_minute_ago,Hf.tc_date_less_than_a_minute_ago],Qo[rc.Minute]=[Hf.tc_date_1_minute_ago,Hf.tc_date_x_minutes_ago],Qo[rc.Hour]=[Hf.tc_date_1_hour_ago,Hf.tc_date_x_hours_ago],Qo[rc.Day]=[Hf.tc_date_1_day_ago,Hf.tc_date_x_days_ago],Qo[rc.Week]=[Hf.tc_date_1_week_ago,Hf.tc_date_x_weeks_ago],Qo[rc.Month]=[Hf.tc_date_1_month_ago,Hf.tc_date_x_months_ago],Qo[rc.Year]=[Hf.tc_date_1_year_ago,Hf.tc_date_x_years_ago],Qo),bm={editCommentEvent:wi("tc-conversation-edit-comment"),deleteCommentEvent:wi("tc-conversation-delete-comment"),deleteConversationEvent:wi("tc-conversation-delete-all"),resolveConversationEvent:wi("tc-conversation-resolve"),createCommentEvent:wi("tc-conversation-create")},ym=function(e,n){return Ea(n,function(n){return sn(n,e.element)},s)||um(e,n)},rc=Object.freeze({__proto__:null,getCoupled:function(n,e,t,o){return t.getOrCreate(n,e,o)}}),Qo=[Ft("others",Go(Ge.value,Ko()))],_m=ro({fields:Qo,name:"coupling",apis:rc,state:Object.freeze({__proto__:null,init:function(){var r={},n=y({});return nr({readState:n,getOrCreate:function(e,t,o){var n=Xe(t.others);if(n)return et(r,o).getOrThunk(function(){var n=et(t.others,o).getOrDie("No information found for coupled component: "+o)(e),n=e.getSystem().build(n);return r[o]=n});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(n,null,2))}})}})}),wm=function(n,e,t){var o,r,i=e.getAttachPoint(n);nu(n.element,"position",Ef.getMode(i)),o=n,n="visibility",r=e.cloakVisibilityAttr,e="hidden",ru(o.element,n).fold(function(){ke(o.element,r)},function(n){Oe(o.element,r,n)}),nu(o.element,n,e)},xm=function(n,e,t){var o,r,i;o=n.element,p(["top","left","right","bottom"],function(n){return ru(o,n).isSome()})||iu(n.element,"position"),r=n,i="visibility",e=e.cloakVisibilityAttr,Ee(r.element,e).fold(function(){return iu(r.element,i)},function(n){return nu(r.element,i,n)})},Go=Object.freeze({__proto__:null,cloak:wm,decloak:xm,open:am,openWhileCloaked:function(n,e,t,o,r){wm(n,e),am(n,e,t,o),r(),xm(n,e)},close:sm,isOpen:fm,isPartOf:function(e,t,n,o){return fm(0,0,n)&&n.get().exists(function(n){return t.isPartOf(e,n,o)})},getState:function(n,e,t){return t.get()},setContent:function(n,e,t,o){return t.get().map(function(){return cm(n,e,t,o)})}}),Qo=Object.freeze({__proto__:null,events:function(t,o){return Fr([Xt(Or(),function(n,e){sm(n,t,o)})])}}),rc=[n("onOpen"),n("onClose"),Dt("isPartOf"),Dt("getAttachPoint"),jt("cloakVisibilityAttr","data-precloak-visibility")],Om=ro({fields:rc,name:"sandboxing",active:Qo,apis:Go,state:Object.freeze({__proto__:null,init:function(){var e=fe(P.none()),n=y("not-implemented");return nr({readState:n,isOpen:function(){return e.get().isSome()},clear:function(){e.set(P.none())},set:function(n){e.set(P.some(n))},get:function(){return e.get()}})}})}),Sm="alloy.item-hover",Em="alloy.item-focus",Cm=y(Sm),km=y(Em),Qo=[Dt("data"),Dt("components"),Dt("dom"),jt("hasSubmenu",!1),Bt("toggling"),qu("itemBehaviours",[Vf,Af,nd,Df]),jt("ignoreFocus",!1),jt("domModification",{}),bu("builder",function(n){return{dom:n.dom,domModification:Z(Z({},n.domModification),{attributes:Z(Z(Z({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Gu(n.itemBehaviours,[n.toggling.fold(Vf.revoke,function(n){return Vf.config(Z({aria:{mode:"checked"}},n))}),Af.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){dm(n)}}),nd.config({mode:"execution"}),Df.config({store:{mode:"memory",initialValue:n.data}}),io("item-type-events",en(Ks(),[Xt(cr(),lm),Xt(_r(),Af.focus)]))]),components:n.components,eventOrder:n.eventOrder}}),jt("eventOrder",{})],Go=[Dt("dom"),Dt("components"),bu("builder",function(n){return{dom:n.dom,components:n.components,events:Fr([(n=_r(),Xt(n,function(n,e){e.stop()}))])}})],Tm=y([tr({name:"widget",overrides:function(e){return{behaviours:Vr([Df.config({store:{mode:"manual",getValue:function(n){return e.data},setValue:function(){}}})])}}})]),tr=[Dt("uid"),Dt("data"),Dt("components"),Dt("dom"),jt("autofocus",!1),jt("ignoreFocus",!1),qu("widgetBehaviours",[Df,Af,nd]),jt("domModification",{}),Mu(Tm()),bu("builder",function(t){function o(n){return function(n,e,t){t=e.partUids[t];return n.getSystem().getByUid(t).toOptional()}(n,t,"widget").map(function(n){return nd.focusIn(n),n})}var n=Cu(mm(),t,Tm()),e=ku(mm(),t,n.internals()),n=function(n,e){return Qf(e.event.target)||t.autofocus&&e.setSource(n.element),P.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:Fr([Hr(function(n,e){o(n).each(function(n){e.stop()})}),Xt(cr(),lm),Xt(_r(),function(n,e){t.autofocus?o(n):Af.focus(n)})]),behaviours:Gu(t.widgetBehaviours,[Df.config({store:{mode:"memory",initialValue:t.data}}),Af.config({ignore:t.ignoreFocus,onFocus:function(n){dm(n)}}),nd.config({mode:"special",focusIn:t.autofocus?function(n){o(n)}:Ur(),onLeft:n,onRight:n,onEscape:function(n,e){return Af.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),P.none()):(Af.focus(n),P.some(!0))}})])}})],Mm=At("type",{widget:tr,item:Qo,separator:Go}),uc=y([uc({factory:{sketch:function(n){n=Rt("menu.spec item",Mm,n);return n.builder(n)}},name:"items",unit:"item",defaults:function(n,e){return e.hasOwnProperty("uid")?e:Z(Z({},e),{uid:Fi("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Bn=y([Dt("value"),Dt("items"),Dt("dom"),Dt("components"),jt("eventOrder",{}),zu("menuBehaviours",[Yf,Df,Rf,nd]),Vt("movement",{mode:"menu",moveOnTab:!0},At("mode",{grid:[Bn(),bu("config",function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}})],matrix:[bu("config",function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}}),Dt("rowSelector")],menu:[jt("moveOnTab",!0),bu("config",function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}})]})),Ft("markers",Qu()),jt("fakeFocus",!1),jt("focusManager",lf()),n("onHighlight")]),Rm=y("alloy.menu-focus"),Am=Ti({name:"Menu",configFields:Bn(),partFields:uc(),factory:function(n,e,t,o){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:pu(n.menuBehaviours,[Yf.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Df.config({store:{mode:"memory",initialValue:n.value}}),Rf.config({find:P.some}),nd.config(n.movement.config(n,n.movement))]),events:Fr([Xt(km(),function(e,t){var n=t.event;e.getSystem().getByDom(n.target).each(function(n){Yf.highlight(e,n),t.stop(),Yt(e,Rm(),{menu:e,item:n})})}),Xt(Cm(),function(n,e){e=e.event.item;Yf.highlight(n,e)})]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Dm=function(t,o,r,n){return et(r,n).bind(function(n){return et(t,n).bind(function(n){var e=Dm(t,o,r,n);return P.some([n].concat(e))})}).getOr([])},Fm=function(n){return"prepared"===n.type?P.some(n.menu):P.none()},Nm={init:function(){function c(t){return function(n,e){for(var t=Xe(n),o=0,r=t.length;o<r;o++){var i=t[o],u=n[i];if(e(u,i,n))return P.some(u)}return P.none()}(r.get(),function(n,e){return n===t})}var r=fe({}),i=fe({}),a=fe({}),s=fe(P.none()),u=fe({}),f=function(n){return e(n).bind(Fm)},e=function(n){return et(i.get(),n)},t=function(n){return et(r.get(),n)};return{setMenuBuilt:function(n,e){var t;i.set(Z(Z({},i.get()),((t={})[n]={type:"prepared",menu:e},t)))},setContents:function(n,e,t,o){s.set(P.some(n)),r.set(t),i.set(e),u.set(o);t=gm(o,t);a.set(t)},expand:function(t){return et(r.get(),t).map(function(n){var e=et(a.get(),t).getOr([]);return[n].concat(e)})},refresh:function(n){return et(a.get(),n)},collapse:function(n){return et(a.get(),n).bind(function(n){return 1<n.length?P.some(n.slice(1)):P.none()})},lookupMenu:e,lookupItem:t,otherMenus:function(n){var e=u.get();return D(Xe(e),n)},getPrimary:function(){return s.get().bind(f)},getMenus:function(){return i.get()},clear:function(){r.set({}),i.set({}),a.set({}),s.set(P.none())},isClear:function(){return s.get().isNone()},getTriggeringPath:function(n,u){var e=S(t(n).toArray(),function(n){return f(n).isSome()});return et(a.get(),n).bind(function(n){var i=A(e.concat(n));return function(n){for(var e=[],t=0;t<n.length;t++){var o=n[t];if(!o.isSome())return P.none();e.push(o.getOrDie())}return P.some(e)}(M(i,function(n,e){return t=n,o=u,r=i.slice(0,e+1),f(t).bind(function(e){return c(t).bind(function(n){return o(n).map(function(n){return{triggeredMenu:e,triggeringItem:n,triggeringPath:r}})})}).fold(function(){return s.get().is(n)?[]:[P.none()]},function(n){return[P.some(n)]});var t,o,r}))})}}},extractPreparedMenu:Fm},Bm=y("collapse-item"),Pm=ki({name:"TieredMenu",configFields:[Nn("onExecute"),Nn("onEscape"),U("onOpenMenu"),U("onOpenSubmenu"),n("onRepositionMenu"),n("onCollapseMenu"),jt("highlightImmediately",!0),Nt("data",[Dt("primary"),Dt("menus"),Dt("expansions")]),jt("fakeFocus",!1),n("onHighlight"),n("onHover"),vu(),Dt("dom"),jt("navigateOnHover",!0),jt("stayInDom",!1),zu("tmenuBehaviours",[nd,Yf,Rf,kf]),jt("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)},repositionMenus:function(n,e){n.repositionMenus(e)}},factory:function(u,n){function t(n){var o,r,n=(o=n,r=u.data.primary,e=u.data.menus,ye(e,function(n,e){function t(){return Am.sketch(Z(Z({},n),{value:e,markers:u.markers,fakeFocus:u.fakeFocus,onHighlight:u.onHighlight,focusManager:(u.fakeFocus?df:lf)()}))}return e===r?{type:"prepared",menu:o.getSystem().build(t())}:{type:"notbuilt",nbMenu:t}})),e=g();return m.setContents(u.data.primary,n,u.data.expansions,e),m.getPrimary()}function c(n){return Df.getValue(n).value}function i(e,n){Yf.highlight(e,n),Yf.getHighlighted(n).orThunk(function(){return Yf.getFirst(n)}).each(function(n){Qt(e,n.element,_r())})}function a(e,n){return uf(x(n,function(n){return e.lookupMenu(n).bind(function(n){return"prepared"===n.type?P.some(n.menu):P.none()})}))}function s(e,n,t){t=a(n,n.otherMenus(t)),O(t,function(n){Xi(n.element,[u.markers.backgroundMenu]),u.stayInDom||kf.remove(e,n)})}function f(n,t){var e,n=(e=n,o.get().getOrThunk(function(){var t={},n=Pe(e.element,"."+u.markers.item),n=S(n,function(n){return"true"===Se(n,"aria-haspopup")});return O(n,function(n){e.getSystem().getByDom(n).each(function(n){var e=c(n);t[e]=n})}),o.set(P.some(t)),t}));$e(n,function(n,e){e=w(t,e);Oe(n.element,"aria-expanded",e)})}function l(t,o,r){return P.from(r[0]).bind(function(n){return o.lookupMenu(n).bind(function(n){if("notbuilt"===n.type)return P.none();var e=n.menu,n=a(o,r.slice(1));return O(n,function(n){De(n.element,u.markers.backgroundMenu)}),ot(e.element)||kf.append(t,Uu(e)),Xi(e.element,[u.markers.backgroundMenu]),i(t,e),s(t,o,r),P.some(e)})})}var d,o=fe(P.none()),m=Nm.init(),g=function(n){return ye(u.data.menus,function(n,e){return M(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})})};(b=d=d||{})[b.HighlightSubmenu=0]="HighlightSubmenu",b[b.HighlightParent=1]="HighlightParent";function r(o,r,i){void 0===i&&(i=d.HighlightSubmenu);var n=c(r);return m.expand(n).bind(function(t){return f(o,t),P.from(t[0]).bind(function(e){return m.lookupMenu(e).bind(function(n){n=function(n,e,t){if("notbuilt"!==t.type)return t.menu;t=n.getSystem().build(t.nbMenu());return m.setMenuBuilt(e,t),t}(o,e,n);return ot(n.element)||kf.append(o,Uu(n)),u.onOpenSubmenu(o,r,n,A(t)),i===d.HighlightSubmenu?(Yf.highlightFirst(n),l(o,m,t)):(Yf.dehighlightAll(n),P.some(r))})})})}function p(e,t){var n=c(t);return m.collapse(n).bind(function(n){return f(e,n),l(e,m,n).map(function(n){return u.onCollapseMenu(e,t,n),n})})}function e(t){return function(e,n){return oi(n.getSource(),"."+u.markers.item).bind(function(n){return e.getSystem().getByDom(n).toOptional().bind(function(n){return t(e,n).map(function(){return!0})})})}}function v(n){return Yf.getHighlighted(n).bind(Yf.getHighlighted)}var h=Fr([Xt(Rm(),function(e,t){var n=t.event.item;m.lookupItem(c(n)).each(function(){var n=t.event.menu;Yf.highlight(e,n);n=c(t.event.item);m.refresh(n).each(function(n){return s(e,m,n)})})}),Hr(function(e,n){n=n.event.target;e.getSystem().getByDom(n).each(function(n){0===c(n).indexOf("collapse-item")&&p(e,n),r(e,n,d.HighlightSubmenu).fold(function(){u.onExecute(e,n)},function(){})})}),Nr(function(e,n){t(e).each(function(n){kf.append(e,Uu(n)),u.onOpenMenu(e,n),u.highlightImmediately&&i(e,n)})})].concat(u.navigateOnHover?[Xt(Cm(),function(n,e){e=e.event.item;!function(e,n){n=c(n);m.refresh(n).bind(function(n){return f(e,n),l(e,m,n)})}(n,e),r(n,e,d.HighlightParent),u.onHover(n,e)})]:[])),b={collapseMenu:function(e){v(e).each(function(n){p(e,n)})},highlightPrimary:function(e){m.getPrimary().each(function(n){i(e,n)})},repositionMenus:function(t){m.getPrimary().bind(function(e){return v(t).bind(function(n){var e=c(n),n=(n=m.getMenus(),nt(n,function(n){return n})),t=uf(x(n,Nm.extractPreparedMenu));return m.getTriggeringPath(e,function(n){return e=n,N(t,function(n){if(!n.getSystem().isConnected())return P.none();n=Yf.getCandidates(n);return C(n,function(n){return c(n)===e})});var e})}).map(function(n){return{primary:e,triggeringPath:n}})}).fold(function(){var n;n=t,P.from(n.components()[0]).filter(function(n){return"menu"===Se(n.element,"role")}).each(function(n){u.onRepositionMenu(t,n,[])})},function(n){var e=n.primary,n=n.triggeringPath;u.onRepositionMenu(t,e,n)})}};return{uid:u.uid,dom:u.dom,markers:u.markers,behaviours:pu(u.tmenuBehaviours,[nd.config({mode:"special",onRight:e(function(n,e){return Qf(e.element)?P.none():r(n,e,d.HighlightSubmenu)}),onLeft:e(function(n,e){return Qf(e.element)?P.none():p(n,e)}),onEscape:e(function(n,e){return p(n,e).orThunk(function(){return u.onEscape(n,e).map(function(){return n})})}),focusIn:function(e,n){m.getPrimary().each(function(n){Qt(e,n.element,_r())})}}),Yf.config({highlightClass:u.markers.selectedMenu,itemClass:u.markers.menu}),Rf.config({find:function(n){return Yf.getHighlighted(n)}}),kf.config({})]),eventOrder:u.eventOrder,apis:b,events:h}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:Ho(n,e),expansions:{}}},collapseItem:function(n){return{value:wi(Bm()),meta:{text:n}}}}}),Hm=y("sink"),mr=y(mr({name:Hm(),overrides:y({dom:{tag:"div"},behaviours:Vr([Ef.config({useFixed:v})]),events:Fr([$t(ar()),$t(ur()),$t(lr())])})})),Im=Ot([jt("isExtraPart",s),Ht("fireEventInstead",[jt("event",kr())])]),jm=Ot([Ht("fireEventInstead",[jt("event",Tr())]),$o("doReposition")]);($o=pm=pm||{})[$o.HighlightFirst=0]="HighlightFirst",$o[$o.HighlightNone=1]="HighlightNone";function Vm(n,e){var t=n.getHotspot(e).getOr(e),o=n.getAnchorOverrides();return n.layouts.fold(function(){return{anchor:"hotspot",hotspot:t,overrides:o}},function(n){return{anchor:"hotspot",hotspot:t,overrides:o,layouts:n}})}function Lm(n,e,t,o,r,i,u){var c,a,s,f,l,d,m=Vm(n,t);return(c=m,s=o,f=r,l=u,e=u=e,u=a=t,e=(0,(n=n).fetch)(u).map(e),d=ng(a,n),e.map(function(n){return n.bind(function(n){return P.from(Pm.sketch(Z(Z({},f.menu()),{uid:Fi(""),data:n,highlightImmediately:l===pm.HighlightFirst,onOpenMenu:function(n,e){var t=d().getOrDie();Ef.position(t,c,e),Om.decloak(s)},onOpenSubmenu:function(n,e,t){var o=d().getOrDie();Ef.position(o,{anchor:"submenu",item:e},t),Om.decloak(s)},onRepositionMenu:function(n,e,t){var o=d().getOrDie();Ef.position(o,c,e),O(t,function(n){Ef.position(o,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)})},onEscape:function(){return Af.focus(a),Om.close(s),P.some(!0)}})))})})).map(function(n){return n.fold(function(){Om.isOpen(o)&&Om.close(o)},function(n){Om.cloak(o),Om.open(o,n),i(o)}),o})}function Wm(n,e,t,o,r,i,u){return Om.close(o),Ue(o)}function Um(n,e,t,o,r,i){var u=_m.getCoupled(t,"sandbox");return(Om.isOpen(u)?Wm:Lm)(n,e,t,u,o,r,i)}function zm(n,e,t){e=Rf.getCurrent(e).getOr(e),n=Ac(n.element),t?nu(e.element,"min-width",n+"px"):(e=e.element,n=n,Ta.set(e,n))}function qm(n){Om.getState(n).each(function(n){Pm.repositionMenus(n)})}function Gm(o,r,i){var e,n,t,u,c={id:e=wi("aria-owns"),link:function(n){Oe(n,"aria-owns",e)},unlink:function(n){ke(n,"aria-owns")}},a=ng(r,o);return{dom:{tag:"div",classes:o.sandboxClasses,attributes:{id:c.id,role:"listbox"}},behaviours:Gu(o.sandboxBehaviours,[Df.config({store:{mode:"memory",initialValue:r}}),Om.config({onOpen:function(n,e){var t=Vm(o,r);c.link(r.element),o.matchWidth&&zm(t.hotspot,e,o.useMinWidth),o.onOpen(t,n,e),void 0!==i&&void 0!==i.onOpen&&i.onOpen(n,e)},onClose:function(n,e){c.unlink(r.element),void 0!==i&&void 0!==i.onClose&&i.onClose(n,e)},isPartOf:function(n,e,t){return ym(e,t)||ym(r,t)},getAttachPoint:function(){return a().getOrDie()}}),Rf.config({find:function(n){return Om.getState(n).bind(function(n){return Rf.getCurrent(n)})}}),ud.config({channels:Z(Z({},(u=Rt("Dismissal",Im,t={isExtraPart:s}),(t={})[_()]={schema:Ot([Dt("target")]),onReceive:function(e,n){Om.isOpen(e)&&(Om.isPartOf(e,n.target)||u.isExtraPart(e,n.target)||u.fireEventInstead.fold(function(){return Om.close(e)},function(n){return Gt(e,n.event)}))}},t)),(n=Rt("Reposition",jm,t={doReposition:qm}),(t={})[l()]={onReceive:function(e){Om.isOpen(e)&&n.fireEventInstead.fold(function(){return n.doReposition(e)},function(n){return Gt(e,n.event)})}},t))})])}}function Ym(n){var e=I.fromHtml(n),t=pn(e),o=function(n){n=void 0!==n.dom.attributes?n.dom.attributes:[];return E(n,function(n,e){return"class"===e.name?n:Z(Z({},n),((n={})[e.name]=e.value,n))},{})}(e),n=(n=e,Array.prototype.slice.call(n.dom.classList,0)),t=0===t.length?{}:{innerHtml:lo(e)};return Z({tag:fn(e),classes:n,attributes:o},t)}function Km(e,t,o){function r(n){Gt(n,zd),Sd(e(),function(){return{stage:Wl.Before}})(n)}function i(n,e,t){return ed.sketch({dom:{tag:"button",classes:n?fd.button:fd.secondaryButton,innerHtml:e},eventOrder:((e={})[ur()]=[tg,Af.name(),rg],e),action:t,buttonBehaviours:Vr(ig)})}function u(n,e){return n=x(function(n,e){switch(e){case Wl.QueryingDelete:return o?[Hf.tc_delete_prompts_conversation,1===n?Hf.tc_delete_prompts_conversation_detail_sing:{pattern:Hf.tc_delete_prompts_conversation_detail_pl,targets:[n]}]:[Hf.tc_delete_prompts_comment];case Wl.QueryingResolve:return[Hf.tc_resolve_prompts_conversation,1===n?Hf.tc_resolve_prompts_conversation_detail_sing:{pattern:Hf.tc_resolve_prompts_conversation_detail_pl,targets:[n]}];default:return[]}}(n,e),function(n){return"string"==typeof n?t.translate(n):t.translate([n.pattern].concat(n.targets))}),e=e===Wl.QueryingDelete,{lines:n,cancelText:t.translate(Hf.tc_delete_buttons_cancel),proceedText:t.translate(e?Hf.tc_delete_buttons_proceed:Hf.tc_resolve_buttons_proceed),proceedEvent:e?Kd:Qd}}var n={setText:function(n,e,t){var o=u(e,t);kf.set(n,x(o.lines,function(n){return{dom:{tag:"div"},components:[{dom:Ym("<p>"+n+"</p>")}]}}).concat([{dom:{tag:"div",classes:fd.cardOverlayButtons},components:[i(!0,o.cancelText,r),i(!1,o.proceedText,function(n){Gt(n,o.proceedEvent)})]}]))}};return{dom:{tag:"div",styles:{display:"none"},classes:fd.cardOverlayText},components:[],apis:n,behaviours:Vr([kf.config({}),io("card-delete-events",[Xt(vr(),function(n){ao(n.element).fold(function(){Sd(e(),function(){return{stage:Wl.Before}})(n)},h)})]),nd.config({mode:"cyclic",onEscape:function(n){return r(n),P.some(!0)}})])}}function Qm(n,e,t){t?(iu(e.element,"display"),e.hasConfigured(nd)&&nd.focusIn(e)):nu(e.element,"display","none")}function Xm(n,e,t,o,r){void 0===t&&(t='<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 24C5.373 24 0 18.627 0 12S5.373 0 12 0s12 5.373 12 12-5.373 12-12 12zm-8.693-5.259A10.981 10.981 0 0 0 12 23c3.535 0 6.68-1.668 8.693-4.259C19.432 16.251 14.591 15 12 15c-2.59 0-7.432 1.25-8.693 3.741zm8.7-5.741C14.224 13 16 10.99 16 8.5S14.224 4 12.007 4C9.79 4 8 6.01 8 8.5S9.79 13 12.007 13z" fill-rule="nonzero"></path></svg>');var i,u,c,a,s,f=fe(n),l=T([o.deleteConversation?[fg]:[],o.resolveConversation?[lg]:[],o.editComment?[ag]:[],o.deleteComment?[sg]:[]]),d=hc(im(n,r.universe)),o={updateWith:function(n,e,t){var o,r,i,u;f.set(e),m.getOpt(n).each(function(n){n.getApis().updateWith(n,e,{})}),g.getOpt(n).each(function(n){n.getApis().updateWith(n,e,{})}),o=n,r=t.numComments,u=(i=e).stage===Wl.QueryingDelete||i.stage===Wl.QueryingResolve,p.getOpt(o).each(function(n){return Qm(0,n,u)}),v.getOpt(o).each(function(n){n.getApis().setText(n,r,i.stage),Qm(0,n,u)}),e.stage!==Wl.PostDelete&&e.stage!==Wl.PostResolve||Pf.getCurrentRoute(n).filter(function(n){return n.destination===cg}).fold(function(){Pf.progressTo(n,cg)},h),d.getOpt(n).each(function(n){n.getApis().updateWith(n,e,{})})}},l={dom:{tag:"div",classes:fd.cardHead},components:T([[{dom:{tag:"div",classes:fd.cardHeadMeta},components:[(c=f.get().authorName,t={dom:{tag:"div",classes:fd.avatar,innerHtml:t}},c={dom:{tag:"div",classes:fd.username,innerHtml:c}},{dom:{tag:"div",classes:fd.user},components:[t,{dom:{tag:"div"},components:[c,d.asSpec()]}]})]}],0<l.length?[(i=r,u=x(l,function(e){var n;return{type:"item",data:{value:e.eventName},dom:{tag:"div",classes:fd.kebabItem},components:[{dom:{tag:"span",classes:fd.kebabItemLabel,innerHtml:i.universe.translate(e.textKey)}}],itemBehaviours:Vr(en([io("item-events",[Hr(function(n){Yt(n,og,{eventName:e.eventName}),Gt(n,Or())})])],Dl({disableClass:fd.kebabDisabledItem.join(" ")}))),eventOrder:((n={})[yr()]=[id.name(),tg,Vf.name(),"typeaheadevents","item-events"],n)}}),eg.sketch({dom:{tag:"button",attributes:{type:"button"},classes:fd.kebab},components:[{dom:{tag:"div",classes:fd.kebabIcon,innerHtml:'<svg width="24" height="24" data-name="icon-image-options"><g id="icon-image-options" stroke="none" stroke-width="1" fill-rule="evenodd"><path d="M6 10a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm12 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2zm-6 0a2 2 0 0 0-2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2 2 2 0 0 0-2-2z" id="Shape" fill-rule="nonzero"></path></g></svg>'}}],lazySink:function(n){return i.getSink(n).fold(function(){return Ge.error("Could not find sink for kebab")},Ge.value)},dropdownBehaviours:Vr(en(Dl({}),[Ff.config({tabAttr:nm})])),sandboxBehaviours:Vr([io("kebab-sandbox-events",[Xt(og,function(n,e){n=Df.getValue(n);Gt(n,e.event.eventName)})])]),parts:{menu:{dom:{tag:"div"},markers:ld.kebab}},toggleClass:sd.kebabOpen,layouts:{onLtr:function(){return[la]},onRtl:function(){return[fa]}},fetch:function(){var n=wi("kebab-id");return Ue(P.some(Pm.singleData(n,{value:wi(n),dom:{tag:"div",classes:fd.kebabMenu},components:[{dom:{tag:"div",classes:fd.kebabMenuGroup},components:[Am.parts.items({})]}],items:u})))}}))]:[]])},m=hc((n={uid:n.uid,mode:n.mode},a=fe(n),n={updateWith:function(n,e,t){switch(a.set(e),e.mode){case Ll.None:nu(n.element,"display","none");break;case Ll.Collapsed:iu(n.element,"display"),hn(n.element).each(function(n){return mo(n,Hf.tc_comment_buttons_showmore)});break;case Ll.Expanded:iu(n.element,"display"),hn(n.element).each(function(n){return mo(n,Hf.tc_comment_buttons_showless)});break;case Ll.ExpandOrNone:case Ll.CollapsedOrNone:break;case Ll.Edit:nu(n.element,"display","none")}}},{dom:{tag:"div",classes:fd.showMoreLessContainer,styles:{display:"none"}},components:[ed.sketch({dom:{tag:"p",classes:fd.showMoreLess,innerHtml:Hf.tc_comment_buttons_showmore},action:function(n){Sd(a.get().uid,function(){return{mode:a.get().mode===Ll.Collapsed?Ll.Expanded:Ll.Collapsed}})(n)},buttonBehaviours:Vr([Ff.config({tabAttr:nm})])})],apis:n})),g=hc(Hd(f.get(),r.universe)),p=hc({dom:{tag:"div",classes:fd.cardOverlay,styles:{display:"none"}}}),v=hc(Km(function(){return f.get().uid},r.universe,e));return{dom:{tag:"div",classes:fd.card,styles:{position:"relative"}},components:[l,g.asSpec(),p.asSpec(),v.asSpec(),m.asSpec()],behaviours:Vr([Af.config({}),Ff.config({}),(s={escapeEvent:zd},nd.config({mode:"cyclic",selector:"["+nm+'="true"]',focusInside:bf.OnEnterOrSpaceMode,onEscape:function(n,e){return Ut(n,e)?P.none():(Gt(n,s.escapeEvent),P.some(!0))}})),Pf.config({initialState:ug,onTransition:function(n){var e;e=f.get().uid,function(n){Yt(n,hd,{uid:e})}(n)},routes:((r={})[ug]=((l={})[cg]={transition:{property:"opacity",transitionClass:sd.disappearing}},l),r)}),Df.config({store:{mode:"memory",initialValue:f.get().uid}}),io("comment-events",[Xt($d,function(n){return Sd(f.get().uid,function(){return{mode:f.get().mode===Ll.Collapsed?Ll.Expanded:Ll.Collapsed}})(n)}),Xt(zd,Af.focus),Xt(qd,function(n){Sd(f.get().uid,function(){return{stage:Wl.QueryingDelete}})(n)}),Xt(Gd,function(n){Sd(f.get().uid,function(){return{stage:Wl.QueryingDelete}})(n)}),Xt(Yd,function(n){Sd(f.get().uid,function(){return{stage:Wl.QueryingResolve}})(n)}),Xt(Qd,function(n){Yt(n,bm.resolveConversationEvent,{uid:f.get().uid})}),Xt(Xd,function(n){return Sd(f.get().uid,function(n){return{mode:Ll.Edit}})(n)}),Xt(Jd,function(e){g.getOpt(e).each(function(n){n=Df.getValue(n);Yt(e,bm.editCommentEvent,{uid:f.get().uid,content:n})})}),Xt(Kd,function(n){Yt(n,e?bm.deleteConversationEvent:bm.deleteCommentEvent,{uid:f.get().uid})})])]),apis:o}}function Jm(n,o,r){return x(n,function(n,e){var t=0===e;return Xm(n,t,void 0,{editComment:!0,deleteComment:0<e,deleteConversation:t,resolveConversation:t&&r},o)})}function $m(n,r,i){void 0===i&&(i=!1);var e={setComments:function(n,e){Rf.getCurrent(n).each(function(n){kf.set(n,Jm(e,r,i))}),Ed(n)},updateWith:function(e,o,n){Rf.getCurrent(e).each(function(n){var t=kf.contents(n);(F(o).exists(function(n){return n.stage===Wl.QueryingDelete})||F(o).exists(function(n){return n.stage===Wl.QueryingResolve})?De:Ne)(n.element,sd.commentThreadOverlay),t.length!==o.length?kf.set(n,Jm(o,r,i)):O(t,function(n,e){t[e].getApis().updateWith(t[e],o[e],{numComments:o.length})}),Ed(e)})},scrollToEnd:function(o){Rf.getCurrent(o).each(function(n){n=kf.contents(n);(0===(n=n).length?P.none():P.some(n[n.length-1])).each(function(n){var e=o.element.dom,t=e.getBoundingClientRect(),n=n.element.dom.getBoundingClientRect();n.top<t.top?e.scrollTop=n.top-t.top:n.bottom>t.bottom&&(e.scrollTop=n.bottom-t.bottom)})})}};return{dom:{tag:"div",classes:fd.outerScroll},components:[{dom:{tag:"div",classes:fd.commentList},components:Jm(n,r,i),behaviours:Vr([(n={selector:ad.card},nd.config({mode:"flow",allowVertical:!0,selector:n.selector})),kf.config({})])}],behaviours:Vr([Rf.config({find:function(e){return hn(e.element).bind(function(n){return e.getSystem().getByDom(n).toOptional()})}})]),apis:e}}var Zm,ng=function(e,n){return e.getSystem().getByUid(n.uid+"-"+Hm()).map(function(n){return function(){return Ge.value(n)}}).getOrThunk(function(){return n.lazySink.fold(function(){return function(){return Ge.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(n){return function(){return n(e)}})})},zu=y([Dt("dom"),Dt("fetch"),n("onOpen"),W("onExecute"),jt("getHotspot",P.some),jt("getAnchorOverrides",y({})),Hn(),zu("dropdownBehaviours",[Vf,_m,nd,Af]),Dt("toggleClass"),jt("eventOrder",{}),Bt("lazySink"),jt("matchWidth",!1),jt("useMinWidth",!1),Bt("role")].concat([jt("sandboxClasses",[]),qu("sandboxBehaviours",[Rf,ud,Om,Df])])),mr=y([gr({schema:[vu()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),mr()]),eg=Ti({name:"Dropdown",configFields:zu(),partFields:mr(),factory:function(e,n,t,o){function r(n){Om.getState(n).each(function(n){Pm.highlightPrimary(n)})}var i,u={expand:function(n){Vf.isOn(n)||Um(e,function(n){return n},n,o,h,pm.HighlightNone).get(h)},open:function(n){Vf.isOn(n)||Um(e,function(n){return n},n,o,h,pm.HighlightFirst).get(h)},isOpen:Vf.isOn,close:function(n){Vf.isOn(n)&&Um(e,function(n){return n},n,o,h,pm.HighlightFirst).get(h)},repositionMenus:function(n){Vf.isOn(n)&&function(n){n=_m.getCoupled(n,"sandbox");qm(n)}(n)}},c=function(n,e){return Kt(n),P.some(!0)};return{uid:e.uid,dom:e.dom,components:n,behaviours:pu(e.dropdownBehaviours,[Vf.config({toggleClass:e.toggleClass,aria:{mode:"expanded"}}),_m.config({others:{sandbox:function(n){return Gm(e,n,{onOpen:function(){Vf.on(n)},onClose:function(){Vf.off(n)}})}}}),nd.config({mode:"special",onSpace:c,onEnter:c,onDown:function(n,e){var t;return eg.isOpen(n)?(t=_m.getCoupled(n,"sandbox"),r(t)):eg.open(n),P.some(!0)},onEscape:function(n,e){return eg.isOpen(n)?(eg.close(n),P.some(!0)):P.none()}}),Af.config({})]),events:Qs(P.some(function(n){Um(e,function(n){return n},n,o,r,pm.HighlightFirst).get(h)})),eventOrder:Z(Z({},e.eventOrder),((c={})[yr()]=["disabling","toggling","alloy.base.behaviour"],c)),apis:u,domModification:{attributes:Z(Z({"aria-haspopup":"true"},e.role.fold(function(){return{}},function(n){return{role:n}})),"button"===e.dom.tag?{type:(i="type",et(e.dom,"attributes").bind(function(n){return et(n,i)}).getOr("button"))}:{})}}},apis:{open:function(n,e){return n.open(e)},expand:function(n,e){return n.expand(e)},close:function(n,e){return n.close(e)},isOpen:function(n,e){return n.isOpen(e)},repositionMenus:function(n,e){return n.repositionMenus(e)}}}),tg="alloy.base.behaviour",og=wi("tc-kebab-action"),rg="overlay-button-events",ig=[Ff.config({}),io(rg,[Xt(ur(),function(n,e){e.event.prevent()})])],ug="basecamp",cg="deleting",ag={textKey:Hf.tc_kebab_edit,eventName:Xd},sg={textKey:Hf.tc_kebab_delete,eventName:qd},fg={textKey:Hf.tc_kebab_delete_conversation,eventName:Gd},lg={textKey:Hf.tc_kebab_resolve_conversation,eventName:Yd};(mr=Zm=Zm||{})[mr.Start=0]="Start",mr[mr.Reply=1]="Reply";function dg(n){return e=xg,n=n,Zd.sketch({tag:"textarea",inputClasses:fd.replyTextarea,inputAttributes:Z(Z({},em),{placeholder:n.translate(Hf.tc_reply_placeholders)}),inputStyles:tm,inputBehaviours:Vr(en([Nd({enterEvent:e}),Ff.config({}),io("reply-events",[Xt(fr(),Bd)])],Dl({})))});var e}function mg(t,n){var o=hc(dg(n)),e={focusEditor:function(n){o.getOpt(n).each(Af.focus)},updateWith:function(n,e,t){p(e,function(n){return n.mode===Ll.Edit})?nu(n.element,"display","none"):iu(n.element,"display")}};return{dom:{tag:"div",classes:fd.replySection},behaviours:Vr([io("reply-events",[Xt(wg,function(n){o.getOpt(n).each(function(n){Df.setValue(n,"")})}),Xt(xg,function(e){o.getOpt(e).map(Df.getValue).each(function(n){0<n.length&&Yt(e,bm.createCommentEvent,{content:n,mode:t})})})])]),components:[o.asSpec(),md({text:n.translate(Hf.tc_reply_buttons_clear),eventName:P.some(wg)}),dd({text:n.translate(Hf.tc_reply_buttons_save),eventName:P.some(xg)})],apis:e}}function gg(){var t=fe(xd()),n=function(n){t.set(n(t.get()))};return{clearAll:function(){t.set(xd())},recalibrate:function(t){n(function(n){return e=n,n=t.comments,{targetUid:e.targetUid,conversation:x(n,function(n){return{uid:n.uid,props:Z(Z({},n),{stage:Wl.Before,mode:e.targetUid.is(n.uid)?Ll.ExpandOrNone:Ll.CollapsedOrNone})}}),queue:[]};var e})},enqueuePatch:function(e,t){n(function(n){return Vd(n,[{uid:e,patch:t}])})},enqueuePatches:function(e){n(function(n){return Vd(n,e)})},setTargetUid:function(e){n(function(n){return _d(n,P.some(e))})},clearTargetUid:function(){n(function(n){return _d(n,P.none())})},processQueue:function(){return wd(t.get()).map(function(n){var e=n.world,n=n.props;return t.set(e),n})},purge:function(t){n(function(n){var e=S(n.conversation,function(n){return n.uid!==t});return Z(Z({},n),{conversation:e})})},getProps:function(){return yd(t.get())},adjust:function(e){n(function(n){return Vd(n,x(e,function(n){return{uid:n.uid,patch:"to-delete"===n.type?{stage:Wl.PostDelete}:{}}}))})}}}function pg(n){return{type:"redraw-sidebar",view:n}}function vg(n,e){if(n.conversation.uid!==e.conversation.uid)return pg(e);var t,o,r=x(n.conversation.comments,function(n){return n.uid}),i=x(e.conversation.comments,function(n){return n.uid});return t=r,n=i,void 0===o&&(o=L),a(o).eq(t,n)?{type:"refresh-comments",comments:x(e.conversation.comments,function(n){return{uid:n.uid,patch:Z({},n)}})}:0!==D(i,r).length?pg(e):{type:"remove-comments",adjustments:x(r,function(n){return{type:w(i,n)?"to-remain":"to-delete",uid:n}})}}function hg(n,e,t,o,r){function i(e){g.get().each(function(n){"comments"===n.type&&e(n.conversation.uid)})}function u(){l.processQueue().each(function(e){y(e),p.getOpt(d).each(function(n){n.getApis().updateWith(n,e,{})})})}function c(e){i(function(n){return e(n).get(function(n){n.fold(function(n){return n()},function(n){return n()})})})}function a(n){n.get(function(n){n.fold(function(n){n()},function(n){l.setTargetUid(n.targetUid),n.fn()})})}function s(n){kf.set(d,[v.asSpec()].concat(n))}function f(n){"splash"===n.view.type?(l.clearAll(),s([h.asSpec()])):"comments"===n.view.type&&(l.recalibrate(n.view.conversation),s([p.asSpec(),b.asSpec()]),p.getOpt(d).each(function(n){var e=l.getProps();y(e),n.getApis().setComments(n,e),n.getApis().scrollToEnd(n)}))}var l=gg(),d=Wu({dom:{tag:"div",classes:n,styles:{position:"relative"}},behaviours:Vr([kf.config({}),Fd({onEscape:function(n){return Gt(n,Og),P.some(!0)}}),io("sidebar-events",[Xt(vd,function(n,e){l.enqueuePatch(e.event.uid,e.event.patch)}),Xt(hd,function(n,e){l.purge(e.event.uid),p.getOpt(d).each(function(n){var e=l.getProps();y(e),n.getApis().updateWith(n,e,{})})}),Xt(bd,function(){u()}),Xt(Og,function(){e.onEscape()}),Xt(bm.deleteConversationEvent,function(){c(function(n){return t.deleteConversation(n)})}),Xt(bm.deleteCommentEvent,function(n,e){c(function(n){return t.deleteComment(n,e.event.uid)})}),Xt(bm.resolveConversationEvent,function(){t.optResolveConversation.each(function(e){c(function(n){return e(n)})})}),Xt(bm.editCommentEvent,function(n,e){i(function(n){a(t.editComment(n,e.event.uid,e.event.content))})}),Xt(bm.createCommentEvent,function(n,e){e.event.mode===Zm.Reply?i(function(n){a(t.reply(n,e.event.content))}):a(t.createConversation(e.event.content))})])])}),m=vc(d),g=fe(P.none()),p=hc($m([],{getSink:function(n){return v.getOpt(n)},universe:o},r.useResolveConversation)),v=hc({dom:{tag:"div",styles:{"z-index":"100"}},behaviours:Vr([Ef.config({})])}),h=hc(mg(Zm.Start,o)),b=hc(mg(Zm.Reply,o)),y=function(e){b.getOpt(d).each(function(n){n.getApis().updateWith(n,e,{})})};return{system:m,root:d,element:m.element,update:function(t){p.getOpt(d).bind(function(e){return g.get().map(function(n){return{convUi:e,pview:n}})}).fold(function(){return f(t)},function(n){var e=n.pview,e=(n=e,e=t.view,n.type!==e.type?pg(e):"splash"===e.type?{type:"no-change"}:vg(n,e));switch(e.type){case"add-comment":f(t);break;case"no-change":break;case"redraw-sidebar":f(t);break;case"remove-comments":l.adjust(e.adjustments),u();break;case"refresh-comments":l.enqueuePatches(e.comments),u()}}),g.set(P.some(t.view)),Ns(d.element)&&t.grabFocus()&&b.getOpt(d).orThunk(function(){return h.getOpt(d)}).each(function(n){n.getApis().focusEditor(n)})},hasFocus:function(){return ao(d.element).isSome()},setReadonly:function(n){n&&m.broadcastOn([_()],{target:m.element}),m.broadcastOn([Tf],{readonly:n})},getSink:v.getOpt}}function bg(n,e){n.execCommand("tc-delete-conversation-at-cursor",null,{conversationUid:e})}function yg(n,e,t,o){return n.fold(function(n){return Ge.error({message:e,error:n,refresh:o})},function(n){return t(n).fold(function(n){return Ge.error({message:n.permError,error:n.reason,refresh:o})},Ge.value)})}function _g(n){return et(n,"reason").getOr("")}var wg=wi("tc-clear-input"),xg=wi("tc-submit-input"),Og=wi("tc-escapeInSidebar"),Sg=function(o,t,r){function i(n){return function(){r().showError(n.message,n.error),n.refresh&&n.refresh()}}return{createConversation:function(n){return Qe.wrap(o.create({content:n,createdAt:Id()}).map(function(n){var e=Ge.value;return yg(n,Hf.tc_create_problem,e,h).fold(function(n){return Ge.error(i(n))},function(e){return Ge.value({targetUid:e.conversationUid,fn:function(){r().refreshReadonly()?et(e,"onError").each(function(n){return n(new Error("Unable to create a new conversation"))}):(t.annotator.annotate(ut(),{uid:e.conversationUid}),r().refreshSidebar(P.some(e.conversationUid),3),et(e,"onSuccess").each(function(n){return n(e.conversationUid)}))}})})}))},reply:function(t,n){return Qe.wrap(o.reply({conversationUid:t,content:n,createdAt:Id()}).map(function(n){var e=Ge.value;return yg(n,Hf.tc_reply_problem,e,h).fold(function(n){return Ge.error(i(n))},function(n){return Ge.value({targetUid:n.commentUid,fn:function(){r().refreshSidebar(P.some(t),3)}})})}))},editComment:function(e,t,n){return Qe.wrap(o.editComment({conversationUid:e,commentUid:t,content:n,modifiedAt:Id()}).map(function(n){return yg(n,Hf.tc_edit_problem_comment,function(n){return n.canEdit?Ge.value(n):Ge.error({permError:Hf.tc_edit_unauthorised_comment,reason:_g(n)})},h).fold(function(n){return Ge.error(i(n))},function(){return Ge.value({targetUid:t,fn:function(){r().refreshSidebar(P.some(e),4)}})})}))},deleteComment:function(e,n){return Qe.wrap(o.deleteComment({conversationUid:e,commentUid:n}).map(function(n){return yg(n,Hf.tc_delete_problem_comment,function(n){return n.canDelete?Ge.value(n):Ge.error({permError:Hf.tc_delete_unauthorised_comment,reason:_g(n)})},function(){r().refreshSidebar(P.some(e),4)}).fold(function(n){return Ge.error(i(n))},function(){return Ge.value(function(){r().refreshSidebar(P.some(e),4)})})}))},deleteConversation:function(e){return Qe.wrap(o.deleteConversation({conversationUid:e}).map(function(n){return yg(n,Hf.tc_delete_problem_conversation,function(n){return n.canDelete?Ge.value(n):Ge.error({permError:Hf.tc_delete_unauthorised_conversation,reason:_g(n)})},function(){r().refreshSidebar(P.some(e),4)}).fold(function(n){return Ge.error(i(n))},function(){return Ge.value(function(){bg(t,e),r().refreshSidebar(P.none(),2)})})}))},optResolveConversation:o.resolveConversation.map(function(n){return function(e){return Qe.wrap(n({conversationUid:e}).map(function(n){return yg(n,Hf.tc_resolve_problem_conversation,function(n){return n.canResolve?Ge.value(n):Ge.error({permError:Hf.tc_resolve_unauthorised_conversation,reason:_g(n)})},function(){r().refreshSidebar(P.some(e),4)}).fold(function(n){return Ge.error(i(n))},function(){return Ge.value(function(){bg(t,e),r().refreshSidebar(P.none(),2)})})}))}})}};tinymce.Resource.add("tinymce.plugins.tinycomments.sidebar",function(n,e,t,o,r,i){function u(n){h.system.broadcastOn([_()],{target:I.fromDom(n.target)})}var c,a,s,f,l,d,m,g,p=Sg(t,e,function(){return b}),v={useResolveConversation:t.resolveConversation.isSome()},v=n===kn.Modern?(l=e,d=p,m=i,g=v,{createSidebar:function(){return hg(fd.roots.modern,{onEscape:function(){return l.focus()}},d,m,g)},createController:ct}):(c=e,a=p,s=i,f=v,{createSidebar:function(){return hg(fd.roots.silver,{onEscape:function(){return c.focus()}},a,s,f)},createController:ct}),h=v.createSidebar(),b=v.createController(t,o,e,h);e.on("ResizeEditor",function(){h.system.broadcastOn([Mf],{})});var y=xn(I.fromDom(document),"mousedown",function(n){h.system.broadcastOn([_()],{target:n.target})});e.on("mousedown",u),e.on("remove",function(){e.off("mousedown",u),y.unbind()});r({controller:b,attachTo:function(n){se(n,h.element)}})})}();