/*!
 * TinyDrive
 *
 * Copyright 2010-2021 Tiny Technologies, Inc. All rights reserved.
 *
 * Version: 1.4.1-91
 */
!function(){"use strict";function b(){}function i(t,o){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t(o.apply(null,e))}}function w(e){return function(){return e}}function l(e){return e}function f(o){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var t=r.concat(e);return o.apply(null,t)}}function u(e){return function(){throw new Error(e)}}var s=w(!1),x=w(!0),e=function(){return a},a={fold:function(e,n){return e()},is:s,isSome:s,isNone:x,getOr:o,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:w(null),getOrUndefined:w(void 0),or:o,orThunk:t,map:e,each:b,bind:e,exists:s,forall:x,filter:e,equals:n,equals_:n,toArray:function(){return[]},toString:w("none()")};function n(e){return e.isNone()}function t(e){return e()}function o(e){return e}function c(e){return!(null==e)}function S(e,n){return e=e,n=n,-1<q.call(e,n)}function d(e,n){for(var t=0,o=e.length;t<o;t++)if(n(e[t],t))return!0;return!1}function O(e,n){for(var t=e.length,o=new Array(t),r=0;r<t;r++){var i=e[r];o[r]=n(i,r)}return o}function k(e,n){for(var t=0,o=e.length;t<o;t++)n(e[t],t)}function C(e,n){for(var t=[],o=0,r=e.length;o<r;o++){var i=e[o];n(i,o)&&t.push(i)}return t}function m(e,n,t){return function(e,n){for(var t=e.length-1;0<=t;t--)n(e[t],t)}(e,function(e){t=n(t,e)}),t}function p(e,n,t){return k(e,function(e){t=n(t,e)}),t}function L(e,n){return function(e,n,t){for(var o=0,r=e.length;o<r;o++){var i=e[o];if(n(i,o))return E.some(i);if(t(i,o))break}return E.none()}(e,n,s)}function g(e,n){for(var t=0,o=e.length;t<o;t++)if(n(e[t],t))return E.some(t);return E.none()}function h(e){for(var n=[],t=0,o=e.length;t<o;++t){if(!R(e[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+e);Z.apply(n,e[t])}return n}function F(e,n){return h(O(e,n))}function v(e,n){for(var t=0,o=e.length;t<o;++t)if(!0!==n(e[t],t))return!1;return!0}function T(e){return(e=K.call(e,0)).reverse(),e}function y(e,n){return C(e,function(e){return!S(n,e)})}function D(e,n){return 0<=n&&n<e.length?E.some(e[n]):E.none()}function B(e){return D(e,0)}function M(e){return D(e,e.length-1)}function I(e,n){for(var t=0;t<e.length;t++){var o=n(e[t],t);if(o.isSome())return o}return E.none()}var r,_=function(t){function e(){return r}function n(e){return e(t)}var o=w(t),r={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:x,isNone:s,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:e,orThunk:e,map:function(e){return _(e(t))},each:function(e){e(t)},bind:n,exists:n,forall:n,filter:function(e){return e(t)?r:a},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(s,function(e){return n(t,e)})}};return r},E={some:_,none:e,from:function(e){return null==e?a:_(e)}},A=function(t){return function(e){return e=typeof(n=e),(null===n?"null":"object"==e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e)===t;var n}},z=function(n){return function(e){return typeof e===n}},P=function(n){return function(e){return n===e}},N=A("string"),V=A("object"),R=A("array"),H=P(null),U=z("boolean"),j=P(void 0),W=z("function"),G=z("number"),K=Array.prototype.slice,q=Array.prototype.indexOf,Z=Array.prototype.push,J=W(Array.from)?Array.from:function(e){return K.call(e)},Y=function(t){return{is:function(e){return t===e},isValue:x,isError:s,getOr:w(t),getOrThunk:w(t),getOrDie:w(t),or:function(e){return Y(t)},orThunk:function(e){return Y(t)},fold:function(e,n){return n(t)},map:function(e){return Y(e(t))},mapError:function(e){return Y(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOptional:function(){return E.some(t)}}},X=function(t){return{is:s,isValue:s,isError:x,getOr:l,getOrThunk:function(e){return e()},getOrDie:function(){return u(String(t))()},or:function(e){return e},orThunk:function(e){return e()},fold:function(e,n){return e(t)},map:function(e){return X(t)},mapError:function(e){return X(e(t))},each:b,bind:function(e){return X(t)},exists:s,forall:x,toOptional:E.none}},$={value:Y,error:X,fromOption:function(e,n){return e.fold(function(){return X(n)},Y)}};(Za=r=r||{})[Za.Error=0]="Error",Za[Za.Value=1]="Value";function Q(e,n,t){return e.stype===r.Error?n(e.serror):t(e.svalue)}function ee(e){return{stype:r.Value,svalue:e}}function ne(e){return{stype:r.Error,serror:e}}function te(e,n){for(var t=we(e),o=0,r=t.length;o<r;o++){var i=t[o];n(e[i],i)}}function oe(e,t){return Se(e,function(e,n){return{k:n,v:t(e,n)}})}function re(e,n){var t,o,r,i,u={};return t=n,i=u,o=function(e,n){i[n]=e},r=b,te(e,function(e,n){(t(e,n)?o:r)(e,n)}),u}function ie(e,t){var o=[];return te(e,function(e,n){o.push(t(e,n))}),o}function ue(e){return ie(e,function(e){return e})}function ae(e,n){return Oe(e,n)?E.from(e[n]):E.none()}function ce(e,n){return Oe(e,n)&&void 0!==e[n]&&null!==e[n]}function se(t){var o,r=!1;return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r||(r=!0,o=t.apply(null,e)),o}}function fe(e){return De.defaultedThunk(w(e))}var le=function(e){return e.fold(ne,ee)},de=function(e){return Q(e,$.error,$.value)},me=ee,pe=function(e){var n=[],t=[];return k(e,function(e){Q(e,function(e){return t.push(e)},function(e){return n.push(e)})}),{values:n,errors:t}},ge=ne,he=function(e,n){return e.stype===r.Value?n(e.svalue):e},ve=function(e,n){return e.stype===r.Error?n(e.serror):e},ye=function(e,n){return e.stype===r.Value?{stype:r.Value,svalue:n(e.svalue)}:e},be=function(e,n){return e.stype===r.Error?{stype:r.Error,serror:n(e.serror)}:e},we=Object.keys,xe=Object.hasOwnProperty,Se=function(e,t){var o={};return te(e,function(e,n){n=t(e,n);o[n.k]=n.v}),o},Oe=function(e,n){return xe.call(e,n)},ke=function(u){if(!R(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],t={};return k(u,function(e,o){var n=we(e);if(1!==n.length)throw new Error("one and only one name per case");var r=n[0],i=e[r];if(void 0!==t[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!R(i))throw new Error("case arguments must be an array");a.push(r),t[r]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+n);return{fold:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(e.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+e.length);return e[o].apply(null,t)},match:function(e){var n=we(e);if(a.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+n.join(","));if(!v(a,function(e){return S(n,e)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+a.join(", "));return e[r].apply(null,t)},log:function(e){console.log(e,{constructors:a,constructor:r,params:t})}}}}),t},Ce=Object.prototype.hasOwnProperty,Le=function(u){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var t={},o=0;o<e.length;o++){var r,i=e[o];for(r in i)Ce.call(i,r)&&(t[r]=u(t[r],i[r]))}return t}},Fe=Le(function(e,n){return V(e)&&V(n)?Fe(e,n):n}),Te=Le(function(e,n){return n}),De=ke([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Be=De.strict,Me=De.asOption,Ie=De.defaultedThunk,_e=De.mergeWithThunk;ke([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);function Ee(e,n){var t={};return t[e]=n,t}function Ae(e,n){return t=n,o={},te(e,function(e,n){S(t,n)||(o[n]=e)}),o;var t,o}function ze(e){return n={},k(e,function(e){n[e.key]=e.value}),n;var n}function Pe(e,n){var t,o,r;return 0<(r=(t=[],o=[],k(e,function(e){e.fold(function(e){t.push(e)},function(e){o.push(e)})}),{errors:t,values:o})).errors.length?(e=r.errors,$.error(h(e))):(n=n,0===(r=r.values).length?$.value(n):$.value(Fe(n,Te.apply(void 0,r))))}function Ne(e){return i(ge,h)(e)}function Ve(e){return V(e)&&100<we(e).length?" removed due to size":JSON.stringify(e,null,2)}function Re(e,n){return ge([{path:e,getErrorInfo:n}])}function He(t,o,r){return ae(o,r).fold(function(){return e=r,n=o,Re(t,function(){return'Could not find valid *strict* value for "'+e+'" in '+Ve(n)});var e,n},me)}function Ue(e,n,t){return n=ae(e,n).fold(function(){return t(e)},l),me(n)}function je(u,a,e,c){return e.fold(function(t,n,e,o){function r(e){return e=o.extract(u.concat([t]),c,e),ye(e,function(e){return Ee(n,c(e))})}function i(e){return e.fold(function(){var e=Ee(n,c(E.none()));return me(e)},function(e){e=o.extract(u.concat([t]),c,e);return ye(e,function(e){return Ee(n,c(E.some(e)))})})}return e.fold(function(){return he(He(u,a,t),r)},function(e){return he(Ue(a,t,e),r)},function(){return he(me(ae(a,t)),i)},function(e){return he(function(n,e,t){e=ae(n,e).map(function(e){return!0===e?t(n):e});return me(e)}(a,t,e),i)},function(e){var n=e(a),e=ye(Ue(a,t,w({})),function(e){return Fe(n,e)});return he(e,r)})},function(e,n){n=n(a);return me(Ee(e,c(n)))})}function We(o){return{extract:function(t,e,n){return ve(o(n,e),function(e){return n=e,Re(t,function(){return n});var n})},toString:function(){return"val"}}}function Ge(e){var i=kn(e),u=m(e,function(n,e){return e.fold(function(e){return Fe(n,wn(e,!0))},w(n))},{});return{extract:function(e,n,t){var o,r=U(t)?[]:we(re(t,function(e){return null!=e})),r=C(r,function(e){return!ce(u,e)});return 0===r.length?i.extract(e,n,t):(o=r,Re(e,function(){return"There are unsupported fields: ["+o.join(", ")+"] specified"}))},toString:i.toString}}function Ke(r){return{extract:function(t,o,e){e=O(e,function(e,n){return r.extract(t.concat(["["+n+"]"]),o,e)});return Sn(e)},toString:function(){return"array("+r.toString()+")"}}}function qe(i,u){return{extract:function(n,t,o){var e,r=we(o),r=(e=n,r=r,Ke(We(i)).extract(e,l,r));return he(r,function(e){e=O(e,function(e){return On.field(e,e,Be(),u)});return kn(e).extract(n,t,o)})},toString:function(){return"setOf("+u.toString()+")"}}}function Ze(t,n,o,r,i){return ae(r,i).fold(function(){return e=r,n=i,Re(t,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+Ve(e)});var e,n},function(e){return e.extract(t.concat(["branch: "+i]),n,o)})}function Je(r,i){return{extract:function(n,t,o){return ae(o,r).fold(function(){return e=r,Re(n,function(){return'Choice schema did not contain choice key: "'+e+'"'});var e},function(e){return Ze(n,t,o,i,e)})},toString:function(){return"chooseOn("+r+"). Possible values: "+we(i)}}}function Ye(n){return We(function(e){return n(e).fold(ge,me)})}function Xe(e,n,t){return de(function(e,n,t,o){t=n.extract([e],t,o);return be(t,function(e){return{input:o,errors:e}})}(e,n,l,t))}function $e(e){return e.fold(function(e){throw new Error(Bn(e))},l)}function Qe(e,n,t){return $e(Xe(e,n,t))}function en(e,n){return Je(e,oe(n,kn))}function nn(n){return Ye(function(e){return S(n,e)?$.value(e):$.error('Unsupported value: "'+e+'", choose one of "'+n.join(", ")+'".')})}function tn(e){return Fn(e,e,Be(),Cn())}function on(e,n){return Fn(e,e,Be(),n)}function rn(e){return on(e,_n)}function un(e){return on(e,En)}function an(e){return on(e,An)}function cn(e){return on(e,zn)}function sn(n,t){return Fn(n,n,Me(),We(function(e){return ge("The field: "+n+" is forbidden. "+t)}))}function fn(e,n){return Fn(e,e,Be(),kn(n))}function ln(e){return Fn(e,e,Me(),Cn())}function dn(e,n){return Fn(e,e,Me(),n)}function mn(e,n){return dn(e,kn(n))}function pn(e,n){return Fn(e,e,fe(n),Cn())}function gn(e,n,t){return Fn(e,e,fe(n),t)}function hn(e,n){return gn(e,n,_n)}function vn(e,n){return Ln(e,n)}function yn(e){return W(e)?e:s}function bn(e,n,t){var o=n(e),r=yn(t);return o.orThunk(function(){return r(e)?E.none():function(e,n,t){for(var o=e.dom,r=yn(t);o.parentNode;){var o=o.parentNode,i=Wn.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return E.none()}(e,n,r)})}var wn=Ee,xn=function(e,n){e=pe(e);return 0<e.errors.length?Ne(e.errors):(e=e.values,n=n,0<e.length?me(Fe(n,Te.apply(void 0,e))):me(n))},Sn=function(e){e=pe(e);return 0<e.errors.length?Ne(e.errors):me(e.values)},On=ke([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),kn=function(o){return{extract:function(e,n,t){return function(n,t,e,o){e=O(e,function(e){return je(n,t,e,o)});return xn(e,{})}(e,t,o,n)},toString:function(){return"obj{\n"+O(o,function(e){return e.fold(function(e,n,t,o){return e+" -> "+o.toString()},function(e,n){return"state("+e+")"})}).join("\n")+"}"}}},Cn=w(We(me)),Ln=On.state,Fn=On.field,Tn=We(me),Dn=function(n,e){return qe(function(e){return le(n(e))},e)},Bn=function(e){return"Errors: \n"+function(e){e=10<e.length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e;return O(e,function(e){return"Failed path: ("+e.path.join(" > ")+")\n"+e.getErrorInfo()})}(e.errors).join("\n")+"\n\nInput object: "+Ve(e.input)},Mn=w(Tn),In=function(t,o){return We(function(e){var n=typeof e;return t(e)?me(e):ge("Expected type: "+o+" but got: "+n)})},_n=In(G,"number"),En=In(N,"string"),An=In(U,"boolean"),zn=In(W,"function"),Pn=function(e){return dn(e,zn)},Nn=function(e,n){return gn(e,n,En)},Vn=function(e,n,t){return gn(e,n,nn(t))},Rn=function(e,n){return gn(e,n,zn)},Hn={init:function(){return Un({readState:function(){return"No State required"}})}},Un=function(e){return e},jn=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},Wn={fromHtml:function(e,n){n=(n||document).createElement("div");if(n.innerHTML=e,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return jn(n.childNodes[0])},fromTag:function(e,n){e=(n||document).createElement(e);return jn(e)},fromText:function(e,n){e=(n||document).createTextNode(e);return jn(e)},fromDom:jn,fromPoint:function(e,n,t){return E.from(e.dom.elementFromPoint(n,t)).map(jn)}},Gn=function(){return(Gn=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};function Kn(e,n){var t={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]]);return t}function qn(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;for(var o=Array(e),r=0,n=0;n<t;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}function Zn(e,n){for(var t=0,o=n.length,r=e.length;t<o;t++,r++)e[r]=n[t];return e}function Jn(e,n){var t=String(n).toLowerCase();return L(e,function(e){return e.search(t)})}function Yn(e,n,t){return""===n||e.length>=n.length&&e.substr(t,t+n.length)===n}function Xn(e,n){return-1!==e.indexOf(n)}function $n(e){return window.matchMedia(e).matches}function Qn(e,n){if(1!==(e=e.dom).nodeType)return!1;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function et(e){return 1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount}function nt(e,n){return n=void 0===n?document:n.dom,et(n)?[]:O(n.querySelectorAll(e),Wn.fromDom)}function tt(e,n){return e.dom===n.dom}function ot(e,n){return t=e.dom,e=n.dom,n=t,t=e,e=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(n.compareDocumentPosition(t)&e);var t}function rt(e,n){return(pr().browser.isIE()?ot:function(e,n){e=e.dom,n=n.dom;return e!==n&&e.contains(n)})(e,n)}function it(e,n){return tt(e.element,n.event.target)}function ut(e){if(!ce(e,"can")&&!ce(e,"abort")&&!ce(e,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(e,null,2)+" does not have can, abort, or run!");return Qe("Extracting event.handler",Ge([pn("can",x),pn("abort",s),pn("run",b)]),e)}function at(t){var n,o,r,i,e=(o=function(e){return e.can},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return p(n,function(e,n){return e&&o(n).apply(void 0,t)},!0)}),u=(r=n=t,i=function(e){return e.abort},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return p(r,function(e,n){return e||i(n).apply(void 0,t)},!1)});return ut({can:e,abort:u,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];k(t,function(e){e.run.apply(void 0,n)})}})}function ct(e,n){ri(e,e.element,n,{})}function st(e,n,t){ri(e,e.element,n,t)}function ft(e){ct(e,Wr())}function lt(e,n,t){ri(e,n,t,{})}function dt(e,n){return{key:e,value:ut({run:n})}}function mt(e){return function(t){return{key:e,value:ut({run:function(e,n){it(e,n)&&t(e,n)}})}}}function pt(e){return dt(e,function(e,n){n.cut()})}function gt(e,n){var t=e.toString(),o=t.indexOf(")")+1,r=t.indexOf("("),i=t.substring(r+1,o-1).split(/,\s*/);return e.toFunctionAnnotation=function(){return{name:n,parameters:fi(i)}},e}function ht(e){return{classes:void 0!==e.classes?e.classes:[],attributes:void 0!==e.attributes?e.attributes:{},styles:void 0!==e.styles?e.styles:{}}}function vt(t,o,r){return ci(function(e,n){r(e,t,o)})}function yt(e,n,t,o,r,i){var u=Ge(e),e=mn(n,[dn("config",Ge(e))]);return li(u,e,n,t,o,r,i)}function bt(r,i,u){var e,n,t,o,a,c;return e=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=[t].concat(e);return t.config({name:w(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(e){var n=Array.prototype.slice.call(o,1);return i.apply(void 0,[t,e.config,e.state].concat(n))})},n=u,o=(t=i).toString(),a=o.indexOf(")")+1,t=o.indexOf("("),c=o.substring(t+1,a-1).split(/,\s*/),e.toFunctionAnnotation=function(){return{name:n,parameters:fi(c.slice(0,1).concat(c.slice(3)))}},e}function wt(e){return{key:e,value:void 0}}function xt(e){return e=Qe("Creating behaviour: "+e.name,mi,e),yt(e.fields,e.name,e.active,e.apis,e.extra,e.state)}function St(e){var n,t,o,r,i,u=Qe("Creating behaviour: "+e.name,pi,e);return n=en(u.branchKey,u.branches),t=u.name,o=u.active,r=u.apis,i=u.extra,e=u.state,n=mn(t,[dn("config",u=n)]),li(u,n,t,o,r,i,e)}function Ot(e,n){return{key:e,value:{config:{},me:function(e,n){n=ii(n);return xt({fields:[tn("enabled")],name:e,active:{events:w(n)}})}(e,n),configAsRaw:w({}),initialConfig:{},state:Hn}}}function kt(e){var n=e;return{get:function(){return n},set:function(e){n=e}}}function Ct(e){return e.dom.nodeName.toLowerCase()}function Lt(e){return Wn.fromDom(e.dom.ownerDocument)}function Ft(e){return wi(e)?e:Lt(e)}function Tt(e){return Wn.fromDom(Ft(e).dom.defaultView)}function Dt(e){return E.from(e.dom.parentNode).map(Wn.fromDom)}function Bt(e){return E.from(e.dom.offsetParent).map(Wn.fromDom)}function Mt(e){return O(e.dom.childNodes,Wn.fromDom)}function It(e,n){return e=e.dom.childNodes,E.from(e[n]).map(Wn.fromDom)}function _t(e){return It(e,0)}function Et(e){return xi(e)&&c(e.dom.host)}function At(e){return Wn.fromDom(e.dom.host)}function zt(n,t){Dt(n).each(function(e){e.dom.insertBefore(t.dom,n.dom)})}function Pt(n,t){_t(n).fold(function(){Fi(n,t)},function(e){n.dom.insertBefore(t.dom,e.dom)})}function Nt(n,e){k(e,function(e){Fi(n,e)})}function Vt(e){e.dom.textContent="",k(Mt(e),function(e){Ti(e)})}function Rt(e,n){var t=Lt(e).dom,o=Wn.fromDom(t.createDocumentFragment()),t=function(e,n){n=(n||document).createElement("div");return n.innerHTML=e,Mt(Wn.fromDom(n))}(n,t);Nt(o,t),Vt(e),Fi(e,o)}function Ht(e,n,t){if(!(N(t)||U(t)||G(t)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",t,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,t+"")}function Ut(e,n,t){Ht(e.dom,n,t)}function jt(e,n){var t=e.dom;te(n,function(e,n){Ht(t,n,e)})}function Wt(e,n){return null===(n=e.dom.getAttribute(n))?void 0:n}function Gt(e,n){return E.from(Wt(e,n))}function Kt(e,n){e.dom.removeAttribute(n)}function qt(e,n){return Wn.fromDom(e.dom.cloneNode(n))}function Zt(e){return qt(e,!0)}function Jt(e){if(Et(e))return"#shadow-root";var n=qt(e,!1);return e=n,n=Wn.fromTag("div"),e=Wn.fromDom(e.dom.cloneNode(!0)),Fi(n,e),n.dom.innerHTML}function Yt(e){var n=(new Date).getTime();return e+"_"+Math.floor(1e9*Math.random())+ ++Mi+String(n)}function Xt(e){return e=yi(e)?e.dom[Ai]:null,E.from(e)}function $t(n){function e(e){return function(){throw new Error("The component must be in a context to send: "+e+(n?"\n"+Jt(n().element)+" is not in context.":""))}}return{debugInfo:w("fake"),triggerEvent:e("triggerEvent"),triggerFocus:e("triggerFocus"),triggerEscape:e("triggerEscape"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),broadcast:e("broadcast"),broadcastOn:e("broadcastOn"),broadcastEvent:e("broadcastEvent"),isConnected:s}}function Qt(e){return wn(Ri,e)}function eo(o){return e=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return o.apply(void 0,qn([e.getApis(),e],n))},t=(n=o).toString(),r=t.indexOf(")")+1,n=t.indexOf("("),i=t.substring(n+1,r-1).split(/,\s*/),e.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:fi(i.slice(1))}},e;var e,n,t,r,i}function no(e,r){var i={};return te(e,function(e,o){te(e,function(e,n){var t=ae(i,n).getOr([]);i[n]=t.concat([r(o,e)])})}),i}function to(n,e,t,o){var r=Gn({},e);function i(e){return m(e,function(e,n){return Gn(Gn({},n.modification),e)},{})}k(t,function(e){r[e.name()]=e.exhibit(n,o)});var u=no(r,function(e,n){return{name:e,modification:n}}),e=m(u.classes,function(e,n){return n.modification.concat(e)},[]),t=i(u.attributes),u=i(u.styles);return ht({classes:e,attributes:t,styles:u})}function oo(r,i,e,u){try{var n=function(e,n){e=K.call(e,0);return e.sort(n),e}(e,function(e,n){var t=e[i],o=n[i],e=u.indexOf(t),n=u.indexOf(o);if(-1===e)throw new Error("The ordering for "+r+" does not have an entry for "+t+".\nOrder specified: "+JSON.stringify(u,null,2));if(-1===n)throw new Error("The ordering for "+r+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(u,null,2));return e<n?-1:n<e?1:0});return $.value(n)}catch(e){return $.error([e])}}function ro(e){return e.cHandler}function io(e,n){return{name:e,handler:n}}function uo(e,n,t){var o,r,n=Gn(Gn({},t),(o=e,r={},k(n,function(e){r[e.name()]=e.handlers(o)}),r));return no(n,io)}function ao(e){var r=W(e=e)?{can:x,abort:s,run:e}:e;return function(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];e=[e,n].concat(t);r.abort.apply(void 0,e)?n.stop():r.can.apply(void 0,e)&&r.run.apply(void 0,e)}}function co(e,n,t){return(n=n[t])?oo("Event: "+t,"name",e,n).map(function(e){e=O(e,function(e){return e.handler});return at(e)}):(t=t,e=e,$.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(O(e,function(e){return e.name}),null,2)]))}function so(e){var n;return Xe("custom.definition",kn([Fn("dom","dom",Be(),kn([tn("tag"),pn("styles",{}),pn("classes",[]),pn("attributes",{}),ln("value"),ln("innerHtml")])),tn("components"),tn("uid"),pn("events",{}),pn("apis",{}),Fn("eventOrder","eventOrder",((n={})[Wr()]=["disabling",Ui,"toggling","typeaheadevents"],n[Rr()]=[Ui,"focusing","keying"],n[Jr()]=[Ui,"disabling","toggling","representing"],n[Dr()]=[Ui,"representing","streaming","invalidating"],n[$r()]=[Ui,"representing","item-events","tooltipping"],n[wr()]=["focusing",Ui,"item-type-events"],n[hr()]=["focusing",Ui,"item-type-events"],n[kr()]=["item-type-events","tooltipping"],n[jr()]=["receiving","reflecting","tooltipping"],n=n,De.mergeWithThunk(w(n))),Mn()),ln("domModification")]),e)}function fo(e,n){return void 0===(n=Wt(e,n))||""===n?[]:n.split(" ")}function lo(e){return void 0!==e.dom.classList}function mo(e,n){return function(e,n,t){t=fo(e,n).concat([t]);return Ut(e,n,t.join(" ")),!0}(e,"class",n)}function po(e,n){return o=n,0<(e=C(fo(t=e,n="class"),function(e){return e!==o})).length?Ut(t,n,e.join(" ")):Kt(t,n),0;var t,o}function go(e,n){lo(e)?e.dom.classList.add(n):mo(e,n)}function ho(e){0===(lo(e)?e.dom.classList:fo(e,"class")).length&&Kt(e,"class")}function vo(e,n){lo(e)?e.dom.classList.remove(n):po(e,n),ho(e)}function yo(e,n){return lo(e)&&e.dom.classList.contains(n)}function bo(n,e){k(e,function(e){go(n,e)})}function wo(n,e){k(e,function(e){vo(n,e)})}function xo(e){return void 0!==e.style&&W(e.style.getPropertyValue)}function So(){return Wi(Wn.fromDom(document))}function Oo(e,n,t){if(!N(t))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",t,":: Element ",e),new Error("CSS value must be a string: "+t);xo(e)&&e.style.setProperty(n,t)}function ko(e,n){xo(e)&&e.style.removeProperty(n)}function Co(e,n,t){e=e.dom,Oo(e,n,t)}function Lo(e,n){var t=e.dom;te(n,function(e,n){Oo(t,n,e)})}function Fo(e,n){var t=e.dom;te(n,function(e,n){e.fold(function(){ko(t,n)},function(e){Oo(t,n,e)})})}function To(e,n){var t=e.dom,o=window.getComputedStyle(t).getPropertyValue(n);return""!==o||ji(e)?o:Gi(t,n)}function Do(e,n){return e=e.dom,n=Gi(e,n),E.from(n).filter(function(e){return 0<e.length})}function Bo(e,n){var t=e.dom;ko(t,n),Gt(e,"style").map(Xo).is("")&&Kt(e,"style")}function Mo(e){return e.dom.value}function Io(e,n){if(void 0===n)throw new Error("Value.set was undefined");e.dom.value=n}function _o(e,n){return t=e,n=O(e=n,function(e){return mn(e.name(),[tn("config"),pn("state",Hn)])}),n=Xe("component.behaviours",kn(n),t.behaviours).fold(function(e){throw new Error(Bn(e)+"\nComplete spec:\n"+JSON.stringify(t,null,2))},function(e){return e}),{list:e,data:oe(n,function(e){var n=e.map(function(e){return{config:e.config,state:e.state.init(e.config)}});return function(){return n}})};var t}function Eo(e){var n,t=(n=ae(t=e,"behaviours").getOr({}),t=C(we(n),function(e){return void 0!==n[e]}),O(t,function(e){return n[e].me}));return _o(e,t)}function Ao(e,n,t){var o=Gn(Gn({},(o=e).dom),{uid:o.uid,domChildren:O(o.components,function(e){return e.element})}),e=e.domModification.fold(function(){return ht({})},ht);return e=e=0<n.length?to(t,{"alloy.base.modification":e},n,o):e,Gn(Gn({},o=o),{attributes:Gn(Gn({},o.attributes),e.attributes),styles:Gn(Gn({},o.styles),e.styles),classes:o.classes.concat(e.classes)})}function zo(e,n,t){var o={"alloy.base.behaviour":e.events};return function(e,n,t,o){o=uo(e,t,o);return Hi(o,n)}(t,e.eventOrder,n,o).getOrDie()}function Po(t){function e(){return s}var n=kt(Vi),o=$e(so(t)),r=Eo(t),i=r.list,u=r.data,a=function(e){var n=Wn.fromTag(e.tag);jt(n,e.attributes),bo(n,e.classes),Lo(n,e.styles),e.innerHtml.each(function(e){return Rt(n,e)});var t=e.domChildren;return Nt(n,t),e.value.each(function(e){Io(n,e)}),e.uid,zi(n,e.uid),n}(Ao(o,i,u)),i=zo(o,i,u),c=kt(o.components),s={getSystem:n.get,config:function(e){var n=u;return(W(n[e.name()])?n[e.name()]:function(){throw new Error("Could not find "+e.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(e){return W(u[e.name()])},spec:t,readState:function(e){return u[e]().map(function(e){return e.state.readState()}).getOr("not enabled")},getApis:function(){return o.apis},connect:function(e){n.set(e)},disconnect:function(){n.set($t(e))},element:a,syncComponents:function(){var e=Mt(a),e=F(e,function(e){return n.get().getByDom(e).fold(function(){return[]},function(e){return[e]})});c.set(e)},components:c.get,events:i};return s}function No(e){var n=(t=Ni(e)).events,t=function(e){e=ae(e,"components").getOr([]);return O(e,Ji)}(e=Kn(t,["events"])),t=Gn(Gn({},e),{events:Gn(Gn({},Bi),n),components:t});return $.value(Po(t))}function Vo(e){function n(){return e.stopPropagation()}function t(){return e.preventDefault()}var o=Wn.fromDom(function(e){if(ki()&&c(e.target)){var n=Wn.fromDom(e.target);if(yi(n)&&Li(n)&&e.composed&&e.composedPath){n=e.composedPath();if(n)return B(n)}}return E.from(e.target)}(e).getOr(e.target)),r=i(t,n);return{target:o,x:e.clientX,y:e.clientY,stop:n,prevent:t,kill:r,raw:e}}function Ro(e,n,t,o,r){var i,u,o=(i=t,u=o,function(e){i(e)&&u(Vo(e))});return e.dom.addEventListener(n,o,r),{unbind:f(Xi,e,n,o,r)}}function Ho(e,n,t){return Ro(e,n,$i,t,!1)}function Uo(e,n,t){return Ro(e,n,$i,t,!0)}var jo,Wo,Go,Ko=function(){return qo(0,0)},qo=function(e,n){return{major:e,minor:n}},Zo={nu:qo,detect:function(e,n){n=String(n).toLowerCase();return 0===e.length?Ko():function(e,n){var t=function(e,n){for(var t=0;t<e.length;t++){var o=e[t];if(o.test(n))return o}}(e,n);if(!t)return{major:0,minor:0};e=function(e){return Number(n.replace(t,"$"+e))};return qo(e(1),e(2))}(e,n)},unknown:Ko},Jo=function(e,t){return Jn(e,t).map(function(e){var n=Zo.detect(e.versionRegexes,t);return{current:e.name,version:n}})},Yo=function(e,t){return Jn(e,t).map(function(e){var n=Zo.detect(e.versionRegexes,t);return{current:e.name,version:n}})},Xo=(jo=/^\s+|\s+$/g,function(e){return e.replace(jo,"")}),$o=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Qo=function(n){return function(e){return Xn(e,n)}},er=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return Xn(e,"edge/")&&Xn(e,"chrome")&&Xn(e,"safari")&&Xn(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,$o],search:function(e){return Xn(e,"chrome")&&!Xn(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return Xn(e,"msie")||Xn(e,"trident")}},{name:"Opera",versionRegexes:[$o,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Qo("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Qo("firefox")},{name:"Safari",versionRegexes:[$o,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(Xn(e,"safari")||Xn(e,"mobile/"))&&Xn(e,"applewebkit")}}],nr=[{name:"Windows",search:Qo("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return Xn(e,"iphone")||Xn(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Qo("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Qo("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Qo("linux"),versionRegexes:[]},{name:"Solaris",search:Qo("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Qo("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Qo("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],tr={browsers:w(er),oses:w(nr)},or="Firefox",rr=function(e){var n=e.current,t=e.version,e=function(e){return function(){return n===e}};return{current:n,version:t,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(or),isSafari:e("Safari")}},ir={unknown:function(){return rr({current:void 0,version:Zo.unknown()})},nu:rr,edge:w("Edge"),chrome:w("Chrome"),ie:w("IE"),opera:w("Opera"),firefox:w(or),safari:w("Safari")},ur="Windows",ar="Android",cr="Solaris",sr="FreeBSD",fr="ChromeOS",lr=function(e){var n=e.current,t=e.version,e=function(e){return function(){return n===e}};return{current:n,version:t,isWindows:e(ur),isiOS:e("iOS"),isAndroid:e(ar),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(cr),isFreeBSD:e(sr),isChromeOS:e(fr)}},dr={unknown:function(){return lr({current:void 0,version:Zo.unknown()})},nu:lr,windows:w(ur),ios:w("iOS"),android:w(ar),linux:w("Linux"),osx:w("OSX"),solaris:w(cr),freebsd:w(sr),chromeos:w(fr)},mr=function(e,n){var t,o,r=tr.browsers(),i=tr.oses(),u=Jo(r,e).fold(ir.unknown,ir.nu),a=Yo(i,e).fold(dr.unknown,dr.nu);return{browser:u,os:a,deviceType:(t=u,o=e,r=n,u=(i=a).isiOS()&&!0===/ipad/i.test(o),e=i.isiOS()&&!u,n=i.isiOS()||i.isAndroid(),a=n||r("(pointer:coarse)"),r=u||!e&&n&&r("(min-device-width:768px)"),n=e||n&&!r,o=t.isSafari()&&i.isiOS()&&!1===/safari/i.test(o),{isiPad:w(u),isiPhone:w(e),isTablet:w(r),isPhone:w(n),isTouch:w(a),isAndroid:i.isAndroid,isiOS:i.isiOS,isWebView:w(o),isDesktop:w(!n&&!r&&!o)})}},pr=se(function(){return mr(navigator.userAgent,$n)}),gr=w,hr=gr("touchstart"),vr=gr("touchmove"),yr=gr("touchend"),br=gr("touchcancel"),wr=gr("mousedown"),xr=gr("mousemove"),Sr=gr("mouseout"),Or=gr("mouseup"),kr=gr("mouseover"),Cr=gr("focusin"),Lr=gr("focusout"),Fr=gr("keydown"),Tr=gr("keyup"),Dr=gr("input"),Br=gr("click"),Mr=gr("dragover"),Ir=gr("dragend"),_r=gr("dragstart"),Er=gr("dragleave"),Ar=gr("dragenter"),zr=gr("drop"),Pr=gr("drag"),Nr=function(e){return w("alloy."+e)},Vr={tap:Nr("tap")},Rr=Nr("focus"),Hr=Nr("blur.post"),Ur=Nr("paste.post"),jr=Nr("receive"),Wr=Nr("execute"),Gr=Nr("focus.item"),Kr=Vr.tap,qr=Nr("longpress"),Zr=Nr("sandbox.close"),Jr=Nr("system.init"),Yr=Nr("system.scroll"),Xr=Nr("system.attached"),$r=Nr("system.detached"),Qr=Nr("system.dismissRequested"),ei=Nr("system.repositionRequested"),ni=Nr("focusmanager.shifted"),ti=Nr("highlight"),oi=Nr("dehighlight"),ri=function(e,n,t,o){o=Gn({target:n},o);e.getSystem().triggerEvent(t,n,o)},ii=ze,ui=mt(Xr()),ai=mt($r()),ci=mt(Jr()),si=(Wo=Wr(),function(e){return dt(Wo,e)}),fi=function(e){return O(e,function(e){return Yn(n=e,t="/*",n.length-t.length)?e.substring(0,e.length-"/*".length):e;var n,t})},li=function(t,e,o,r,n,i,u){function a(e){return ce(e,o)?e[o]():E.none()}var n=oe(n,function(e,n){return bt(o,e,n)}),i=oe(i,gt),c=Gn(Gn(Gn({},i),n),{revoke:f(wt,o),config:function(e){var n=Qe(o+"-config",t,e);return{key:o,value:{config:n,me:c,configAsRaw:se(function(){return Qe(o+"-config",t,e)}),initialConfig:e,state:u}}},schema:w(e),exhibit:function(e,t){return a(e).bind(function(n){return ae(r,"exhibit").map(function(e){return e(t,n.config,n.state)})}).getOr(ht({}))},name:w(o),handlers:function(e){return a(e).map(function(e){return ae(r,"events").getOr(function(){return{}})(e.config,e.state)}).getOr({})}});return c},di=ze,mi=Ge([tn("fields"),tn("name"),pn("active",{}),pn("apis",{}),pn("state",Hn),pn("extra",{})]),pi=Ge([tn("branchKey"),tn("branches"),tn("name"),pn("active",{}),pn("apis",{}),pn("state",Hn),pn("extra",{})]),gi=w(void 0),hi="undefined"!=typeof window?window:Function("return this;")(),vi=function(n){return function(e){return e.dom.nodeType===n}},yi=vi(1),bi=vi(3),wi=vi(9),xi=vi(11),Si=Dt,Oi=W(Element.prototype.attachShadow)&&W(Node.prototype.getRootNode),ki=w(Oi),Ci=Oi?function(e){return Wn.fromDom(e.dom.getRootNode())}:Ft,Li=function(e){return c(e.dom.shadowRoot)},Fi=function(e,n){e.dom.appendChild(n.dom)},Ti=function(e){e=e.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},Di=ii([{key:Rr(),value:ut({can:function(e,n){var t=n.event,o=t.originator,r=t.target;return n=r,!(tt(t=o,e.element)&&!tt(t,n))||(console.warn(Rr()+" did not get interpreted by the desired target. \nOriginator: "+Jt(o)+"\nTarget: "+Jt(r)+"\nCheck the "+Rr()+" event handlers"),!1)}})}]),Bi=Object.freeze({__proto__:null,events:Di}),Mi=0,Ii=w("alloy-id-"),_i=w("data-alloy-id"),Ei=Ii(),Ai=_i(),zi=function(e,n){Object.defineProperty(e.dom,Ai,{value:n,writable:!0})},Pi=Yt,Ni=l,Vi=$t(),Ri=Yt("alloy-premade"),Hi=function(e,r){e=ie(e,function(t,o){return(1===t.length?$.value(t[0].handler):co(t,r,o)).map(function(e){var n=ao(e),e=1<t.length?C(r[o],function(n){return d(t,function(e){return e.name===n})}).join(" > "):t[0].name;return wn(o,{handler:n,purpose:e})})});return Pe(e,{})},Ui="alloy.base.behaviour",ji=function(e){var n=bi(e)?e.dom.parentNode:e.dom;if(null==n||null===n.ownerDocument)return!1;var t,o,r=n.ownerDocument;return function(e){e=Ci(e);return Et(e)?E.some(e):E.none()}(Wn.fromDom(n)).fold(function(){return r.body.contains(n)},(t=ji,o=At,function(e){return t(o(e))}))},Wi=function(e){e=e.dom.body;if(null==e)throw new Error("Body is not available yet");return Wn.fromDom(e)},Gi=function(e,n){return xo(e)?e.style.getPropertyValue(n):""},Ki=function(e){e=Wn.fromText(e);return qi({element:e})},qi=function(e){var n=Qe("external.component",Ge([tn("element"),ln("uid")]),e),t=kt($t());n.uid.each(function(e){zi(n.element,e)});var o={getSystem:t.get,config:E.none,hasConfigured:s,connect:function(e){t.set(e)},disconnect:function(){t.set($t(function(){return o}))},getApis:function(){return{}},element:n.element,spec:e,readState:w("No state"),syncComponents:b,components:w([]),events:{}};return Qt(o)},Zi=Pi,Ji=function(n){return ae(n,Ri).fold(function(){var e=n.hasOwnProperty("uid")?n:Gn({uid:Zi("")},n);return No(e).getOrDie()},function(e){return e})},Yi=Qt,Xi=function(e,n,t,o){e.dom.removeEventListener(n,t,o)},$i=x;(Go=Go||{}).SetListType="listType.set";var Qi;(Qi=Qi||{}).SetOrderByField="orderBy.set";var eu;(eu=eu||{}).SetSortOrder="sortOrder.set";function nu(e){return M(e).bind(function(e){return e.uuid})}function tu(e,t){return e.length===t.length&&v(e,function(e,n){return e=e,n=t[n],e.name===n.name&&e.uuid.equals(n.uuid)})}function ou(e){return Te({offset:0,parentUuid:E.none(),sortBy:"name",sortOrder:"asc",query:E.none(),fileTypes:[]},e)}function ru(e){return{type:"",message:e}}function iu(e){return{type:"",message:e.message}}var uu;(nc=uu=uu||{}).Loading="files.loading",nc.Set="files.set",nc.Add="files.add",nc.Append="files.append",nc.Remove="files.remove";var au;(tc=au=au||{}).Set="query.set",tc.Clear="query.clear";var cu;(oc=cu=cu||{}).Add="notification.add",oc.Remove="notification.remove";function su(e){return{type:cu.Add,payload:{notification:{data:{uid:Yt("error")},status:"error",text:e}}}}function fu(n){return function(e){return n(su(e.message))}}var lu;(rc=lu=lu||{}).Open="inPreview.open",rc.Close="inPreview.close",rc.SetDimensions="inPreview.setDimensions",rc.SetDescription="inPreview.setDescription";function du(o){return function(e,n,t){return zu(n().fileState.files,o)(e,n,t)}}function mu(o){return function(e,n,t){e((e=o,{type:lu.SetDimensions,payload:{dimensions:e}}))}}function pu(e,n,t){return t.query.isSome()?e.search(t):"starred"===n?e.listStarred(t):e.list(t)}function gu(e,n){return e={parentUuid:nu(e.path),sortBy:e.sortBy,sortOrder:e.sortOrder,query:e.query,fileTypes:e.fileTypes},ou(Te({},e,n))}function hu(e){var n=Yt("files");return{type:uu.Set,payload:{complete:!0===e.last,offset:e.offset,files:e.files,hash:n}}}function vu(e){return{type:uu.Loading,payload:{loading:e}}}function yu(n,e,t,o,r){"done"===e.fileState.loading&&(n(vu(t)),o.get(function(e){return e.fold(function(e){n(vu("done")),n(su(e.message))},function(e){n(vu("done")),r(e)})}))}function bu(e,n,t,o){yu(e,n,"reload",t,o)}function wu(e,n,t,o){yu(e,n,"new",t,o)}function xu(n,e,t){t=pu(t,e().viewType,gu(e(),{offset:0})),bu(n,e(),t,function(e){return n(hu(e))})}function Su(t,o,r){var e=pu(r,o().viewType,gu(o(),{offset:0}));bu(t,o(),e,function(n){t(hu(n)),o().preview.each(function(e){return zu(n.files,e.file.uuid)(t,o,r)})})}function Ou(t,e,n){!1===e().fileState.complete&&(n=pu(n,e().viewType,gu(e(),{offset:e().fileState.offset})),yu(t,e(),"append",n,function(e){return t((n=e,e=Yt("files"),{type:uu.Append,payload:{complete:!0===n.last,offset:n.offset,files:n.files,hash:e}}));var n}))}function ku(r){return function(n,e,t){var o=E.from(r).filter(function(e){return 0<e.length});o.fold(function(){n({type:au.Clear,payload:{query:r}})},function(){n({type:au.Set,payload:{query:r}})});o=pu(t,e().viewType,gu(e(),{query:o}));wu(n,e(),o,function(e){return n(hu(e))})}}function Cu(e){return{type:Qi.SetOrderByField,payload:{field:e}}}function Lu(r){return function(t,e,n){var o=e().sortBy===r?"asc"===e().sortOrder?"desc":"asc":"asc",n=pu(n,e().viewType,gu(e(),{sortOrder:o,sortBy:r}));bu(t,e(),n,function(e){var n;t(Cu(r)),t((n=o,{type:eu.SetSortOrder,payload:{sortOrder:n}})),t(hu(e))})}}function Fu(o){return function(n,e,t){t=pu(t,e().viewType,gu(e(),{}));wu(n,e(),t,function(e){n(Cu("name")),n({type:Go.SetListType,payload:{listType:o}}),n(hu(e))})}}function Tu(t){return{schema:kn([tn("state"),tn("oldState")]),onReceive:function(e,n){e.getSystem().isConnected()&&t(e,n)}}}function Du(e,n){e.getSystem().isConnected()&&st(e,"action",{data:n})}function Bu(){return ae(hi,"tinymce").or(ae(hi,"tinydrive")).getOrThunk(function(){var e={};return hi.tinydrive=e})}function Mu(n,e,t,o){function r(e){a=n(u=a,e),o(a,u,e)}function i(){return a}var u,a=e;return{dispatch:function(e){e(r,i,t)}}}var Iu,_u,Eu,Au,zu=function(t,r){return function(o,e,n){L(t,function(e){return e.uuid===r}).each(function(t){n.getMeta(t.uuid).get(function(e){return e.fold(fu(o),function(e){return o((n=t,e=e,{type:lu.Open,payload:{file:n,meta:e}}));var n})})})}},Pu={},Nu={exports:Pu};_u=Pu,Eu=Nu,Au=Iu=void 0,function(e){"object"==typeof _u&&void 0!==Eu?Eu.exports=e():"function"==typeof Iu&&Iu.amd?Iu([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=e()}(function(){return function o(r,i,u){function a(n,e){if(!i[n]){if(!r[n]){var t="function"==typeof Au&&Au;if(!e&&t)return t(n,!0);if(c)return c(n,!0);throw(t=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",t}t=i[n]={exports:{}},r[n][0].call(t.exports,function(e){return a(r[n][1][e]||e)},t,t.exports,o,r,i,u)}return i[n].exports}for(var c="function"==typeof Au&&Au,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,n,t){var o,r,n=n.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(n){if(o===setTimeout)return setTimeout(n,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(n,0);try{return o(n,0)}catch(e){try{return o.call(null,n,0)}catch(e){return o.call(this,n,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(e){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var c,s=[],f=!1,l=-1;function d(){f&&c&&(f=!1,c.length?s=c.concat(s):l=-1,s.length&&m())}function m(){if(!f){var e=a(d);f=!0;for(var n=s.length;n;){for(c=s,s=[];++l<n;)c&&c[l].run();l=-1,n=s.length}c=null,f=!1,function(n){if(r===clearTimeout)return clearTimeout(n);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{r(n)}catch(e){try{return r.call(null,n)}catch(e){return r.call(this,n)}}}(e)}}function p(e,n){this.fun=e,this.array=n}function g(){}n.nextTick=function(e){var n=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)n[t-1]=arguments[t];s.push(new p(e,n)),1!==s.length||f||a(m)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],2:[function(e,l,n){!function(n){function o(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function r(t,o){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var e,n=1===t._state?o.onFulfilled:o.onRejected;if(null!==n){try{e=n(t._value)}catch(e){return void a(o.promise,e)}u(o.promise,e)}else(1===t._state?u:a)(o.promise,t._value)})):t._deferreds.push(o)}function u(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof i)return n._state=3,n._value=e,void c(n);if("function"==typeof t)return void f((o=t,r=e,function(){o.apply(r,arguments)}),n)}n._state=1,n._value=e,c(n)}catch(e){a(n,e)}var o,r}function a(e,n){e._state=2,e._value=n,c(e)}function c(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var n=0,t=e._deferreds.length;n<t;n++)r(e,e._deferreds[n]);e._deferreds=null}function s(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function f(e,n){var t=!1;try{e(function(e){t||(t=!0,u(n,e))},function(e){t||(t=!0,a(n,e))})}catch(e){if(t)return;t=!0,a(n,e)}}var e,t;e=this,t=setTimeout,i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,n){var t=new this.constructor(o);return r(this,new s(e,n,t)),t},i.all=function(e){var a=Array.prototype.slice.call(e);return new i(function(r,i){if(0===a.length)return r([]);var u=a.length;for(var e=0;e<a.length;e++)!function n(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if("function"==typeof o)return void o.call(e,function(e){n(t,e)},i)}a[t]=e,0==--u&&r(a)}catch(e){i(e)}}(e,a[e])})},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i(function(e){e(n)})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(r){return new i(function(e,n){for(var t=0,o=r.length;t<o;t++)r[t].then(e,n)})},i._immediateFn="function"==typeof n?function(e){n(e)}:function(e){t(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==l&&l.exports?l.exports=i:e.Promise||(e.Promise=i)}.call(this,e("timers").setImmediate)},{timers:3}],3:[function(c,e,s){!function(e,n){var o=c("process/browser.js").nextTick,t=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function a(e,n){this._id=e,this._clearFn=n}s.setTimeout=function(){return new a(t.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new a(t.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(e){e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(e,n){clearTimeout(e._idleTimeoutId),e._idleTimeout=n},s.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},s._unrefActive=s.active=function(e){clearTimeout(e._idleTimeoutId);var n=e._idleTimeout;0<=n&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},n))},s.setImmediate="function"==typeof e?e:function(e){var n=u++,t=!(arguments.length<2)&&r.call(arguments,1);return i[n]=!0,o(function(){i[n]&&(t?e.apply(null,t):e.call(null),s.clearImmediate(n))}),n},s.clearImmediate="function"==typeof n?n:function(e){delete i[e]}}.call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(e,n,t){var o=e("promise-polyfill"),e="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:e.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)});function Vu(e){setTimeout(function(){throw e},0)}function Ru(e){return Qu(Xu(e))}function Hu(e){console.error(e)}function Uu(t,o){return na.nu(function(e){var n=Wn.fromTag("script");jt(n,Gn({src:t},o)),Ho(n,"load",function(){e($.value(n))}),Ho(n,"error",function(){e($.error("Failed to load script: "+t))}),Fi(So(),n)})}function ju(e,o,r){return ae(e,o).fold(function(){return n=e,t=o,Uu(r,{}).bindResult(function(e){return $.fromOption(ae(n,t),'Could not find "'+t+'" in the given namespace')});var n,t},na.pure)}var Wu,Gu,Ku,qu=Nu.exports.boltExport,Zu=function(e){var t=E.none(),n=[],o=function(e){r()?u(e):n.push(e)},r=function(){return t.isSome()},i=function(e){k(e,u)},u=function(n){t.each(function(e){setTimeout(function(){n(e)},0)})};return e(function(e){r()||(t=E.some(e),i(n),n=[])}),{get:o,map:function(t){return Zu(function(n){o(function(e){n(t(e))})})},isReady:r}},Ju={nu:Zu,pure:function(n){return Zu(function(e){e(n)})}},Yu=function(t){function e(e){t().then(e,Vu)}return{map:function(e){return Yu(function(){return t().then(e)})},bind:function(n){return Yu(function(){return t().then(function(e){return n(e).toPromise()})})},anonBind:function(e){return Yu(function(){return t().then(function(){return e.toPromise()})})},toLazy:function(){return Ju.nu(e)},toCached:function(){var e=null;return Yu(function(){return e=null===e?t():e})},toPromise:t,get:e}},Xu=function(e){return Yu(function(){return new qu(e)})},$u=function(e){return Yu(function(){return qu.resolve(e)})},Qu=function(i){return Gn(Gn({},i),{toCached:function(){return Qu(i.toCached())},bindFuture:function(n){return Qu(i.bind(function(e){return e.fold(function(e){return $u($.error(e))},function(e){return n(e)})}))},bindResult:function(n){return Qu(i.map(function(e){return e.bind(n)}))},mapResult:function(n){return Qu(i.map(function(e){return e.map(n)}))},mapError:function(n){return Qu(i.map(function(e){return e.mapError(n)}))},foldResult:function(n,t){return i.map(function(e){return e.fold(n,t)})},withTimeout:function(e,r){return Qu(Xu(function(n){var t=!1,o=setTimeout(function(){t=!0,n($.error(r()))},e);i.get(function(e){t||(clearTimeout(o),n(e))})}))}})},ea=function(e){return Qu($u($.value(e)))},na={nu:Ru,wrap:Qu,pure:ea,value:ea,error:function(e){return Qu($u($.error(e)))},fromResult:function(e){return Qu($u(e))},fromFuture:function(e){return Qu(e.map($.value))},fromPromise:function(e){return Ru(function(n){e.then(function(e){n($.value(e))},function(e){n($.error(e))})})}};(e=Wu=Wu||{}).DownloadFiles="external.download",e.Exit="external.exit",(Gu=Gu||{}).InsertFiles="insert.insertFiles",(A=Ku=Ku||{}).Push="clipboard.push",A.SetOperation="clipboard.setOperation",A.Clear="clipboard.clear";var ta;(P=ta=ta||{}).PushPathItem="path.push",P.Slice="path.slice";var oa;(oa=oa||{}).UploadProgress="upload.progress";function ra(e,n){return e.uuid===n.uuid}function ia(e,n){return{lastUpdate:E.some(new Date),files:(n=n.files,t=e,C(n,function(e){return!1===ra(e,t)}))};var t}function ua(t,o){var e=L(o.files,function(e){return e.uuid===t.uuid}).fold(function(){return o.files.concat([t])},function(){return e=o.files,n=t,O(e,function(e){return ra(e,n)?n:e});var e,n});return{lastUpdate:E.some(new Date),files:e}}var aa;(aa=aa||{}).SetViewType="viewType.set";var ca,sa,fa=(ca={notifications:function(e,n){switch(n.type){case cu.Add:return Zn(Zn([],e),[n.payload.notification]);case cu.Remove:return C(e,function(e){return e.data.uid!==n.payload.uid});default:return e}},viewType:function(e,n){return n.type!==aa.SetViewType?e:n.payload.viewType},listType:function(e,n){return n.type!==Go.SetListType?e:n.payload.listType},fileState:function(e,n){switch(n.type){case uu.Loading:return"new"===n.payload.loading||"reload"===n.payload.loading?{loading:n.payload.loading,complete:e.complete,offset:0,files:[],hash:e.hash}:{loading:n.payload.loading,complete:e.complete,offset:e.offset,files:e.files,hash:e.hash};case uu.Set:return{loading:e.loading,complete:n.payload.complete,offset:n.payload.offset,files:n.payload.files,hash:n.payload.hash};case uu.Append:return{loading:e.loading,complete:n.payload.complete,offset:n.payload.offset,files:Zn(Zn([],e.files),n.payload.files),hash:n.payload.hash};case uu.Add:var t=Zn(Zn([],e.files),[n.payload.file]);return{loading:e.loading,complete:!0,offset:e.files.length,files:t,hash:n.payload.hash};case uu.Remove:t=C(e.files,function(e){return e.uuid!==n.payload.uuid});return{loading:e.loading,complete:!0,offset:e.files.length,files:t,hash:n.payload.hash};default:return e}},selectedFiles:function(e,n){switch(n.type){case"selectedFiles.set":return n.payload.files;case"selectedFiles.select":return Zn(Zn([],e),[n.payload.file]);case"selectedFiles.unselect":return C(e,function(e){return e.uuid!==n.payload.uuid});case"selectedFiles.selectAll":return n.payload.files;case"selectedFiles.clear":return[];default:return e}},sortBy:function(e,n){return n.type!==Qi.SetOrderByField?e:n.payload.field},sortOrder:function(e,n){return n.type!==eu.SetSortOrder?e:n.payload.sortOrder},upload:function(e,n){return n.type!==oa.UploadProgress?e:(t=n.payload,n=e,((e=t).loaded===e.total?ia:ua)(t,n));var t},path:function(e,n){switch(n.type){case ta.PushPathItem:return e.concat(n.payload.pathItem);case ta.Slice:return e.slice(0,n.payload.index);default:return e}},clipboard:function(e,n){switch(n.type){case Ku.Push:return E.some({operation:n.payload.operation,files:n.payload.files});case Ku.Clear:return E.none();default:return e}},preview:function(e,n){switch(n.type){case lu.Open:return E.some({file:n.payload.file,meta:n.payload.meta,dimensions:e.bind(function(e){return e.dimensions})});case lu.Close:return E.none();case lu.SetDimensions:return e.map(function(e){return Gn(Gn({},e),{dimensions:n.payload.dimensions})});case lu.SetDescription:return e.map(function(e){return Gn(Gn({},e),{meta:Gn(Gn({},e.meta),{description:n.payload.description})})});default:return e}},query:function(e,n){switch(n.type){case au.Set:return E.some(n.payload.query);case au.Clear:return E.none();default:return e}},fileTypes:function(e,n){return e}},function(t,o){return Object.keys(ca).reduce(function(e,n){return e[n]=ca[n](t[n],o),e},{})}),la="unknown";(z=sa=sa||{})[z.STOP=0]="STOP",z[z.NORMAL=1]="NORMAL",z[z.LOGGING=2]="LOGGING";function da(n,e,t){var o,r,i,u;switch(ae(ma.get(),n).orThunk(function(){var e=we(ma.get());return I(e,function(e){return-1<n.indexOf(e)?E.some(ma.get()[e]):E.none()})}).getOr(sa.NORMAL)){case sa.NORMAL:return t(ga());case sa.LOGGING:var a=(o=n,r=e,i=[],u=(new Date).getTime(),{logEventCut:function(e,n,t){i.push({outcome:"cut",target:n,purpose:t})},logEventStopped:function(e,n,t){i.push({outcome:"stopped",target:n,purpose:t})},logNoParent:function(e,n,t){i.push({outcome:"no-parent",target:n,purpose:t})},logEventNoHandlers:function(e,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(e,n,t){i.push({outcome:"response",purpose:t,target:n})},write:function(){var e=(new Date).getTime();S(["mousemove","mouseover","mouseout",Jr()],o)||console.log(o,{event:o,time:e-u,target:r.dom,sequence:O(i,function(e){return S(["cut","stopped","response"],e.outcome)?"{"+e.purpose+"} "+e.outcome+" at ("+Jt(e.target)+")":e.outcome})})}}),c=t(a);return a.write(),c;case sa.STOP:return!0}}var ma=kt({}),pa=["alloy/data/Fields","alloy/debugging/Debugging"],ga=w({logEventCut:b,logEventStopped:b,logNoParent:b,logEventNoHandlers:b,logEventResponse:b,write:b}),ha=w([tn("menu"),tn("selectedMenu")]),va=w([tn("item"),tn("selectedItem")]);w(kn(va().concat(ha())));function ya(e,n,t){return function(){var e=new Error;if(void 0===e.stack)return;e=e.stack.split("\n");L(e,function(n){return 0<n.indexOf("alloy")&&!d(pa,function(e){return-1<n.indexOf(e)})}).getOr(la)}(),Fn(n,n,t,Ye(function(t){return $.value(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(void 0,e)})}))}function ba(e,n){return vn(e,w(n))}function wa(e){return vn(e,l)}function xa(e){return Oe(e,"uiType")}function Sa(e,n,t,o){return xa(t)&&t.uiType===Ja?(i=t,u=o,(r=e).exists(function(e){return e!==i.owner})?Ya.single(!0,w(i)):ae(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+we(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(e){return e.replace()})):Ya.single(!1,w(t));var r,i,u}function Oa(n,t,e,o){var r,i,u,o=oe(o,function(e,n){return o=e,r=!1,{name:w(t=n),required:function(){return o.fold(function(e,n){return e},function(e,n){return e})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+t);return r=!0,o}};var t,o,r}),e=(r=n,i=t,u=o,F(e,function(e){return Xa(r,i,e,u)}));return te(o,function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),e}function ka(e){function n(e){return e.name}return e.fold(n,n,n,n)}function Ca(e,n,t,o){return Fe(n.defaults(e,t,o),t,{uid:e.partUids[n.name]},n.overrides(e,t,o))}function La(r,e){var n={};return k(e,function(e){e.fold(E.some,E.none,E.some,E.some).each(function(t){var o=ac(r,t.pname);n[t.name]=function(e){var n=Qe("Part: "+t.name+" in "+r,kn(t.schema),e);return Gn(Gn({},o),{config:e,validated:n})}})}),n}function Fa(e,n,t){return o=n,i={},r={},k(t,function(e){e.fold(function(o){i[o.pname]=$a(!0,function(e,n,t){return o.factory.sketch(Ca(e,o,n,t))})},function(e){var n=o.parts[e.name];r[e.name]=w(e.factory.sketch(Ca(o,e,n[uc()]),n))},function(o){i[o.pname]=$a(!1,function(e,n,t){return o.factory.sketch(Ca(e,o,n,t))})},function(r){i[r.pname]=Qa(!0,function(n,e,t){var o=n[r.name];return O(o,function(e){return r.factory.sketch(Fe(r.defaults(n,e,t),e,r.overrides(n,e)))})})})}),{internals:w(i),externals:w(r)};var o,i,r}function Ta(e,n,t){return Oa(E.some(e),n,n.components,t)}function Da(e,n,t){return t=n.partUids[t],e.getSystem().getByUid(t).toOptional()}function Ba(e,n,t){return Da(e,n,t).getOrDie("Could not find part: "+t)}function Ma(n,e){return e=O(e,ka),ze(O(e,function(e){return{key:e,value:n+"-"+e}}))}function Ia(n){return Fn("partUids","partUids",_e(function(e){return Ma(e.uid,n)}),Mn())}function _a(e,n,t,o,r){return r=r,r=(0<(o=o).length?[fn("parts",o)]:[]).concat([tn("uid"),pn("dom",{}),pn("components",[]),wa("originalSpec"),pn("debug.sketcher",{})]).concat(r),Qe(e+" [SpecSchema]",Ge(r.concat(n)),t)}function Ea(e,n,t,o,r){var i=cc(r),u=F(t,function(e){return e.fold(E.none,E.some,E.none,E.none).map(function(e){return fn(e.name,e.schema.concat([wa(uc())]))}).toArray()}),r=Ia(t),r=_a(e,n,i,u,[r]),t=Fa(0,r,t);return o(r,Ta(e,r,t.internals()),i,t.externals())}function Aa(e){return e.dump}function za(e,n){return Gn(Gn({},e.dump),di(n))}function Pa(e,n){Fi(e.element,n.element)}function Na(n,e){var t,o=n.components();k((t=n).components(),function(e){return Ti(e.element)}),Vt(t.element),t.syncComponents(),o=y(o,e),k(o,function(e){gc(e),n.getSystem().removeFromWorld(e)}),k(e,function(e){e.getSystem().isConnected()?Pa(n,e):(n.getSystem().addToWorld(e),Pa(n,e),ji(n.element)&&hc(e)),n.syncComponents()})}function Va(e,n){vc(e,n,Fi)}function Ra(e){gc(e),Ti(e.element),e.getSystem().removeFromWorld(e)}function Ha(n){var e=Dt(n.element).bind(function(e){return n.getSystem().getByDom(e).toOptional()});Ra(n),e.each(function(e){e.syncComponents()})}function Ua(e){var n=e.components();k(n,Ra),Vt(e.element),e.syncComponents()}function ja(e,n){yc(e,n,Fi)}function Wa(e){return e.dom.focus()}function Ga(e){return void 0===e&&(e=Wn.fromDom(document)),E.from(e.dom.activeElement).map(Wn.fromDom)}function Ka(n){return Ga(Ci(n)).filter(function(e){return n.dom.contains(e.dom)})}var qa=w(kn(va())),Za=fn("initSize",[tn("numColumns"),tn("numRows")]),Le=function(){return fn("markers",[tn("backgroundMenu")].concat(ha()).concat(va()))},Tn=function(e){return ya(0,e,fe(b))},In=function(e){return ya(0,e,fe(E.none))},$o=function(e){return ya(0,e,Be())},Qo=function(e){return ya(0,e,Be())},er=w(Za),Ja="placeholder",Ya=ke([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Xa=function(o,r,i,u){return Sa(o,0,i,u).fold(function(e,n){var t=xa(i)?n(r,i.config,i.validated):n(r),n=ae(t,"components").getOr([]),n=F(n,function(e){return Xa(o,r,e,u)});return[Gn(Gn({},t),{components:n})]},function(e,n){if(xa(i)){var t=n(r,i.config,i.validated);return i.validated.preprocess.getOr(l)(t)}return n(r)})},$a=Ya.single,Qa=Ya.multiple,ec=w(Ja),nr=ke([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),gr=pn("factory",{sketch:l}),Vr=pn("schema",[]),Nr=tn("name"),vi=Fn("pname","pname",Ie(function(e){return"<alloy."+Yt(e.name)+">"}),Mn()),Oi=Ln("schema",function(){return[ln("preprocess")]}),Di=pn("defaults",w({})),Ii=pn("overrides",w({})),_i=kn([gr,Vr,Nr,vi,Di,Ii]),nc=kn([gr,Vr,Nr,Di,Ii]),tc=kn([gr,Vr,Nr,vi,Di,Ii]),oc=kn([gr,Oi,Nr,tn("unit"),vi,Di,Ii]),rc=function(n,t){return function(e){e=Qe("Converting part type",t,e);return n(e)}},ic=rc(nr.required,_i),Pu=rc(nr.external,nc),Nu=rc(nr.optional,tc),ea=rc(nr.group,oc),uc=w("entirety"),ac=function(e,n){return{uiType:ec(),owner:e,name:n}},cc=function(e){return Oe(e,"uid")?e:Gn(Gn({},e),{uid:Pi("uid")})},sc=Ge([tn("name"),tn("factory"),tn("configFields"),pn("apis",{}),pn("extraApis",{})]),fc=Ge([tn("name"),tn("factory"),tn("configFields"),tn("partFields"),pn("apis",{}),pn("extraApis",{})]),e=function(e){var n=Qe("Sketcher for "+e.name,sc,e),t=oe(n.apis,eo),e=oe(n.extraApis,gt);return Gn(Gn({name:n.name,configFields:n.configFields,sketch:function(e){return function(e,n,t,o){o=cc(o);return t(_a(e,n,o,[],[]),o)}(n.name,n.configFields,n.factory,e)}},t),e)},A=function(e){var n=Qe("Sketcher for "+e.name,fc,e),t=La(n.name,n.partFields),o=oe(n.apis,eo),e=oe(n.extraApis,gt);return Gn(Gn({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(e){return Ea(n.name,n.configFields,n.partFields,n.factory,e)},parts:t},o),e)},P=function(n,e){return t=n,o={},e=O(e,function(e){return sn(e.name(),"Cannot configure "+e.name()+" for "+n)}).concat([vn("dump",l)]),gn(t,o,kn(e));var t,o},lc=P,dc=za,mc=e({name:"Container",factory:function(e){var n=e.dom,t=n.attributes,n=Kn(n,["attributes"]);return{uid:e.uid,dom:Gn({tag:"div",attributes:Gn({role:"presentation"},t)},n),components:e.components,behaviours:Aa(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[pn("components",[]),P("containerBehaviours",[]),pn("events",{}),pn("domModification",{}),pn("eventOrder",{})]}),z=Object.freeze({__proto__:null,events:function(u){return ii([dt(jr(),function(o,e){var n,r=u.channels,t=we(r),i=e,t=(t=t,(n=i).universal?t:C(t,function(e){return S(n.channels,e)}));k(t,function(e){var n=r[e],t=n.schema,t=Qe("channel["+e+"] data\nReceiver: "+Jt(o.element),t,i.data);n.onReceive(o,t)})})])}}),Za=[on("channels",Dn($.value,Ge([$o("onReceive"),pn("schema",Mn())])))],pc=xt({fields:Za,name:"receiving",active:z}),gc=function(e){ct(e,$r());e=e.components();k(e,gc)},hc=function(e){var n=e.components();k(n,hc),ct(e,Xr())},vc=function(e,n,t){e.getSystem().addToWorld(n),t(e.element,n.element),ji(e.element)&&hc(n),e.syncComponents()},yc=function(e,n,t){t(e,n.element);e=Mt(n.element);k(e,function(e){n.getByDom(e).each(hc)})};function bc(e,n,t,o,r){return e(t,o)?E.some(t):W(r)&&r(t)?E.none():n(t,o,r)}function wc(e,n,t){for(var o=e.dom,r=W(t)?t:s;o.parentNode;){var o=o.parentNode,i=Wn.fromDom(o);if(n(i))return E.some(i);if(r(i))break}return E.none()}function xc(e,n,t){return bc(function(e,n){return n(e)},wc,e,n,t)}function Sc(e,t){var o=Ci(t),n=Ga(o).bind(function(n){function e(e){return tt(n,e)}var o,r;return e(t)?E.some(t):(o=e,(r=function(e){for(var n=0;n<e.childNodes.length;n++){var t=Wn.fromDom(e.childNodes[n]);if(o(t))return E.some(t);t=r(e.childNodes[n]);if(t.isSome())return t}return E.none()})(t.dom))}),e=e(t);return n.each(function(n){Ga(o).filter(function(e){return tt(e,n)}).fold(function(){Wa(n)},b)}),e}function Oc(e,n,t,o){o=e.getSystem().build(o),vc(e,o,t)}function kc(e,n,t,o){e=cs(e),L(e,function(e){return tt(o.element,e.element)}).each(Ha)}function Cc(n,e,t,r,o){var i=cs(n);return E.from(i[r]).map(function(e){return kc(n,0,0,e),o.each(function(e){Oc(n,0,function(e,n){var t,o;o=n,It(t=e,r).fold(function(){Fi(t,o)},function(e){zt(e,o)})},e)}),e})}function Lc(e){var n=void 0!==e.uid&&ce(e,"uid")?e.uid:Pi("memento");return{get:function(e){return e.getSystem().getByUid(n).getOrDie()},getOpt:function(e){return e.getSystem().getByUid(n).toOptional()},asSpec:function(){return Gn(Gn({},e),{uid:n})}}}function Fc(e,n,t){(n=n.aria).update(e,n,t.get())}function Tc(n,e,t){e.toggleClass.each(function(e){(t.get()?go:vo)(n.element,e)})}function Dc(e,n,t){fs(e,n,t,!t.get())}function Bc(e,n,t){t.set(!0),Tc(e,n,t),Fc(e,n,t)}function Mc(e,n,t){t.set(!1),Tc(e,n,t),Fc(e,n,t)}function Ic(e,n,t){fs(e,n,t,n.selected)}function _c(e){return ms.getOuter(e)}function Ec(e,n){return t=function(e){return Qn(e,n)},C(Mt(e),t);var t}function Ac(e,n){return nt(n,e)}function zc(e,n,t){return wc(e,function(e){return Qn(e,n)},t)}function Pc(e,n){return t=function(e){return Qn(e,n)},L(e.dom.childNodes,function(e){return t(Wn.fromDom(e))}).map(Wn.fromDom);var t}function Nc(e,n){return function(e,n){n=void 0===n?document:n.dom;return et(n)?E.none():E.from(n.querySelector(e)).map(Wn.fromDom)}(n,e)}function Vc(e,n,t){return bc(Qn,zc,e,n,t)}function Rc(e,n,t){var o=T(e.slice(0,n)),n=T(e.slice(n+1));return L(o.concat(n),t)}function Hc(e,n,t){return n=T(e.slice(0,n)),L(n,t)}function Uc(e,n,t){var o=e.slice(0,n),n=e.slice(n+1);return L(n.concat(o),t)}function jc(e,n,t){return n=e.slice(n+1),L(n,t)}function Wc(n){return function(e){e=e.raw;return S(n,e.which)}}function Gc(e){return function(n){return v(e,function(e){return e(n)})}}function Kc(e){return!0===e.raw.shiftKey}function qc(e){return!0===e.raw.ctrlKey}function Zc(e,n){return{matches:e,classification:n}}function Jc(e,n,t,o){return o<(n=e+n)?t:n<t?o:n}function Yc(e,n,t){return Math.min(Math.max(e,n),t)}function Xc(e){for(var n=[],t=function(e){n.push(e)},o=0;o<e.length;o++)e[o].each(t);return n}function $c(e,n,t){return e.isSome()&&n.isSome()?E.some(t(e.getOrDie(),n.getOrDie())):E.none()}function Qc(e){return e.bind(l)}function es(t,o,e,r){var n=Ac(t.element,"."+o.highlightClass);k(n,function(n){d(r,function(e){return e.element===n})||(vo(n,o.highlightClass),t.getSystem().getByDom(n).each(function(e){o.onDehighlight(t,e),ct(e,oi())}))})}function ns(e,n,t,o){es(e,n,0,[o]),ks(e,n,t,o)||(go(o.element,n.highlightClass),n.onHighlight(e,o),ct(o,ti()))}function ts(n,t,e,o){var r=Ac(n.element,"."+t.itemClass);return g(r,function(e){return yo(e,t.highlightClass)}).bind(function(e){e=Jc(e,o,0,r.length-1);return n.getSystem().getByDom(r[e]).toOptional()})}function os(e,n,t){n.exists(function(n){return t.exists(function(e){return tt(e,n)})})||st(e,ni(),{prevFocus:n,newFocus:t})}function rs(){function o(e){return Ka(e.element)}return{get:o,set:function(e,n){var t=o(e);e.getSystem().triggerFocus(n,e.element);n=o(e);os(e,t,n)}}}function is(){function o(e){return Ds.getHighlighted(e).map(function(e){return e.element})}return{get:o,set:function(n,e){var t=o(n);n.getSystem().getByDom(e).fold(b,function(e){Ds.highlight(n,e)});e=o(n);os(n,t,e)}}}var us,as,cs=function(e,n){return e.components()},ss=xt({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(e,n,t,o){Oc(e,0,Fi,o)},prepend:function(e,n,t,o){Oc(e,0,Pt,o)},remove:kc,replaceAt:Cc,replaceBy:function(n,e,t,o,r){var i=cs(n);return g(i,o).bind(function(e){return Cc(n,0,0,e,r)})},set:function(n,e,t,o){Sc(function(){var e=O(o,n.getSystem().build);Na(n,e)},n.element)},contents:cs})}),Ie=function(e){return{init:function(){var n=kt(e);return{get:function(){return n.get()},set:function(e){return n.set(e)},clear:function(){return n.set(e)},readState:function(){return n.get()}}}}},fs=function(e,n,t,o){(o?Bc:Mc)(e,n,t)},Vr=Object.freeze({__proto__:null,onLoad:Ic,toggle:Dc,isOn:function(e,n,t){return t.get()},on:Bc,off:Mc,set:fs}),gr=Object.freeze({__proto__:null,exhibit:function(){return ht({})},events:function(e,n){var t,o,r,i=(t=e,o=n,r=Dc,si(function(e){r(e,t,o)})),n=vt(e,n,Ic);return ii(h([e.toggleOnExecute?[i]:[],[n]]))}}),ls=function(e,n,t){Ut(e.element,"aria-expanded",t)},Oi=[pn("selected",!1),ln("toggleClass"),pn("toggleOnExecute",!0),gn("aria",{mode:"none"},en("mode",{pressed:[pn("syncWithExpanded",!1),ba("update",function(e,n,t){Ut(e.element,"aria-pressed",t),n.syncWithExpanded&&ls(e,n,t)})],checked:[ba("update",function(e,n,t){Ut(e.element,"aria-checked",t)})],expanded:[ba("update",ls)],selected:[ba("update",function(e,n,t){Ut(e.element,"aria-selected",t)})],none:[ba("update",b)]}))],ds=xt({fields:Oi,name:"toggling",active:gr,apis:Vr,state:Ie(!1)}),Nr=function(t,o){function e(e){var n=o(e);if(n<=0||null===n){e=To(e,t);return parseFloat(e)||0}return n}function r(t,e){return p(e,function(e,n){n=To(t,n),n=void 0===n?0:parseInt(n,10);return isNaN(n)?e:e+n},0)}return{set:function(e,n){if(!G(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);e=e.dom;xo(e)&&(e.style[t]=n+"px")},get:e,getOuter:e,aggregate:r,max:function(e,n,t){t=r(e,t);return t<n?n-t:0}}},ms=Nr("height",function(e){var n=e.dom;return ji(e)?n.getBoundingClientRect().height:n.offsetHeight}),ps=[8],gs=[9],hs=[13],vs=[27],ys=[32],bs=[37],ws=[38],xs=[39],Ss=[40],Os=(us=Kc,function(e){return!us(e)}),ks=function(e,n,t,o){return yo(o.element,n.highlightClass)},Cs=function(e,n,t,o){n=Ac(e.element,"."+n.itemClass);return E.from(n[o]).fold(function(){return $.error(new Error("No element found with index "+o))},e.getSystem().getByDom)},Ls=function(n,e,t){return Nc(n.element,"."+e.itemClass).bind(function(e){return n.getSystem().getByDom(e).toOptional()})},Fs=function(n,e,t){e=Ac(n.element,"."+e.itemClass);return(0<e.length?E.some(e[e.length-1]):E.none()).bind(function(e){return n.getSystem().getByDom(e).toOptional()})},Ts=function(n,e,t){e=Ac(n.element,"."+e.itemClass);return Xc(O(e,function(e){return n.getSystem().getByDom(e).toOptional()}))},vi=Object.freeze({__proto__:null,dehighlightAll:function(e,n,t){return es(e,n,0,[])},dehighlight:function(e,n,t,o){ks(e,n,t,o)&&(vo(o.element,n.highlightClass),n.onDehighlight(e,o),ct(o,oi()))},highlight:ns,highlightFirst:function(n,t,o){Ls(n,t).each(function(e){ns(n,t,o,e)})},highlightLast:function(n,t,o){Fs(n,t).each(function(e){ns(n,t,o,e)})},highlightAt:function(n,t,o,e){Cs(n,t,o,e).fold(function(e){throw e},function(e){ns(n,t,o,e)})},highlightBy:function(n,t,o,e){var r=Ts(n,t);L(r,e).each(function(e){ns(n,t,o,e)})},isHighlighted:ks,getHighlighted:function(n,e,t){return Nc(n.element,"."+e.highlightClass).bind(function(e){return n.getSystem().getByDom(e).toOptional()})},getFirst:Ls,getLast:Fs,getPrevious:function(e,n,t){return ts(e,n,0,-1)},getNext:function(e,n,t){return ts(e,n,0,1)},getCandidates:Ts}),Di=[tn("highlightClass"),tn("itemClass"),Tn("onHighlight"),Tn("onDehighlight")],Ds=xt({fields:Di,name:"highlighting",apis:vi});(Ii=as=as||{}).OnFocusMode="onFocus",Ii.OnEnterOrSpaceMode="onEnterOrSpace",Ii.OnApiMode="onApi";function Bs(e,n,t,o,a){function c(n,t,e,o,r){var i;return e=e=e(n,t,o,r),i=t.event,L(e,function(e){return e.matches(i)}).map(function(e){return e.classification}).bind(function(e){return e(n,t,o,r)})}var r={schema:function(){return e.concat([pn("focusManager",rs()),gn("focusInside","onFocus",Ye(function(e){return S(["onFocus","onEnterOrSpace","onApi"],e)?$.value(e):$.error("Invalid value for focusInside")})),ba("handler",r),ba("state",n),ba("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var e=i.focusInside!==as.OnFocusMode?E.none():a(i).map(function(t){return dt(Rr(),function(e,n){t(e,i,u),n.stop()})}),n=[dt(Fr(),function(o,r){c(o,r,t,i,u).fold(function(){var n,t,e;n=o,t=r,e=Wc(ys.concat(hs))(t.event),i.focusInside===as.OnEnterOrSpaceMode&&e&&it(n,t)&&a(i).each(function(e){e(n,i,u),t.stop()})},function(e){r.stop()})}),dt(Tr(),function(e,n){c(e,n,o,i,u).each(function(e){n.stop()})})];return ii(e.toArray().concat(n))}};return r}function Ms(e){return"input"===Ct(e)&&"radio"!==Wt(e,"type")||"textarea"===Ct(e)}function Is(e,n){return E.some(!0)}function _s(e,n,t){return t.execute(e,n,e.element)}function Es(n,t){return function(e){return"rtl"===Bf(e)?t:n}}function As(i){return function(e,n,t,o){var r=i(e.element);return Mf(r,e,n,t,o)}}function zs(e,n){return n=Es(e,n),As(n)}function Ps(e,n){return e=Es(n,e),As(e)}function Ns(e){return!((e=e.dom).offsetWidth<=0&&e.offsetHeight<=0)}function Vs(e,n,t){var o,t=Ac(e,t),t=C(t,Ns);return g(o=t,function(e){return tt(e,n)}).map(function(e){return{index:e,candidates:o}})}function Rs(e,n){return g(e,function(e){return tt(n,e)})}function Hs(n,e,t,o){return o(Math.floor(e/t),e%t).bind(function(e){e=e.row*t+e.column;return 0<=e&&e<n.length?E.some(n[e]):E.none()})}function Us(o,e,r,i,u){return Hs(o,e,i,function(e,n){var t=e===r-1?o.length-e*i:i,t=Jc(n,u,0,t-1);return E.some({row:e,column:t})})}function js(o,e,r,i,u){return Hs(o,e,i,function(e,n){var t=Jc(e,u,0,r-1),e=t===r-1?o.length-t*i:i,e=Yc(n,0,e-1);return E.some({row:t,column:e})})}function Ws(n,t,e){Nc(n.element,t.selector).each(function(e){t.focusManager.set(n,e)})}function Gs(e,n,t,r){var i=function(e,n,t){var o=Jc(n,r,0,t.length-1);return o===e?E.none():(n=t[o],"button"===Ct(n)&&"disabled"===Wt(n,"disabled")?i(e,o,t):E.from(t[o]))};return Vs(e,t,n).bind(function(e){var n=e.index,e=e.candidates;return i(n,n,e)})}function Ks(n,t,o){return e=n,(r=o).focusManager.get(e).bind(function(e){return Vc(e,r.selector)}).bind(function(e){return o.execute(n,t,e)});var e,r}function qs(n,t,e){t.getInitial(n).orThunk(function(){return Nc(n.element,t.selector)}).each(function(e){t.focusManager.set(n,e)})}function Zs(e,n,t){return Gs(e,t.selector,n,-1)}function Js(e,n,t){return Gs(e,t.selector,n,1)}function Ys(r){return function(e,n,t,o){return r(e,n,t,o).bind(function(){return t.executeOnMove?Ks(e,n,t):E.some(!0)})}}function Xs(e,n,t){return t.onEscape(e,n)}function $s(e,n,t){return E.from(e[n]).bind(function(e){return E.from(e[t]).map(function(e){return{rowIndex:n,columnIndex:t,cell:e}})})}function Qs(e,n,t,o){var r=e[n].length,r=Jc(t,o,0,r-1);return $s(e,n,r)}function ef(e,n,t,o){return t=Jc(t,o,0,e.length-1),o=e[t].length,o=Yc(n,0,o-1),$s(e,t,o)}function nf(e,n,t,o){var r=e[n].length,r=Yc(t+o,0,r-1);return $s(e,n,r)}function tf(e,n,t,o){return t=Yc(t+o,0,e.length-1),o=e[t].length,o=Yc(n,0,o-1),$s(e,t,o)}function of(n,t,e){t.previousSelector(n).orThunk(function(){var e=t.selectors;return Nc(n.element,e.cell)}).each(function(e){t.focusManager.set(n,e)})}function rf(n,t,e){Nc(n.element,t.selector).each(function(e){t.focusManager.set(n,e)})}function uf(e,n,t){return Gs(e,t.selector,n,-1)}function af(e,n,t){return Gs(e,t.selector,n,1)}function cf(e){return pr().browser.isIE()?"text":e}function sf(e,n,t){var o,r,i,u,a=pr().browser,c=a.isFirefox()&&a.version.major<66;a.isIE()||a.isEdge()||c?(i=e,u=t,k(n,function(e){e=cf(e);try{i.setData(e,u)}catch(e){}})):(n=n,r=t,(o=e).items.clear(),k(n,function(e){o.items.add(r,e)}))}function ff(e){return!j(e.setDragImage)}function lf(e,n){e.dropEffect=n}function df(e){return e.event.raw.dataTransfer}function mf(e,n){lf(df(e),n)}function pf(e){return e=Zt(e.element),Lo(e,{position:"absolute",top:"-300px","max-width":"175px","max-height":"175px",overflow:"hidden"}),e}function gf(e,n,t){var o,r=pf(t);Fi(n,r),o=e,n=r.dom,e=t.x,t=t.y,ff(o)&&o.setDragImage(n,e,t),setTimeout(function(){Ti(r)},0)}function hf(t){var e=Zt(t),n=O(["position","visibility"],function(e){return{name:e,value:Do(t,e)}});zt(t,e),Lo(t,{position:"fixed",visibility:"hidden"}),setTimeout(function(){k(n,function(n){n.value.fold(function(){return Bo(t,n.name)},function(e){return Co(t,n.name,e)})}),Ti(e)},0)}function vf(e,n,t,o){var r,i,u,a,c;ff(e)?gf(e,t,n):pr().browser.isEdge()?(r=n,i=t,t=o,u=kt(E.none()),a=Ho(t,"drag",function(e){var n=e.x+Math.max(r.x+1,1),t=e.y+Math.max(r.y+1,1),e=u.get().getOrThunk(function(){var e=pf(r);return u.set(E.some(e)),Lo(e,{position:"fixed",margin:"0",opacity:"0.6"}),Ut(e,"role","presentation"),Fi(i,e),e});Lo(e,{left:n+"px",top:t+"px"})}),c=Ho(t,"dragend",function(e){u.get().each(Ti),a.unbind(),c.unbind()}),hf(t)):hf(o)}function yf(e,n){var e=function(e,n){n=e.getData(cf(n));return H(n)?"":n}(t=n.event.raw.dataTransfer,e.type),t=J(t.files);return Gn(Gn({},n),{data:e,files:t})}function bf(u,e){return e(function(o){var r=[],i=0;0===u.length?o([]):k(u,function(e,n){var t;e.get((t=n,function(e){r[t]=e,++i>=u.length&&o(r)}))})})}function wf(e){return bf(e,Xu)}function xf(e,n){return Pf(document.createElement("canvas"),e,n)}function Sf(e){var n=xf(e.width,e.height);return zf(n).drawImage(e,0,0),n}function Of(e){return e.naturalWidth||e.width}function kf(e){return e.naturalHeight||e.height}var Cf,Lf,Ff,Tf,Df,_i=function(e){function i(e,n){return e=e=e.visibilitySelector.bind(function(e){return Vc(n,e)}).getOr(n),0<ms.get(e)}function n(n,t,e){!function(e,n){e=Ac(e.element,n.selector),e=C(e,function(e){return i(n,e)});return E.from(e[n.firstTabstop])}(n,t).each(function(e){t.focusManager.set(n,e)})}function a(n,e,t,o,r){return r(e,t,function(e){return i(n=o,e=e)&&n.useTabstopAt(e);var n}).fold(function(){return o.cyclic?E.some(!0):E.none()},function(e){return o.focusManager.set(n,e),E.some(!0)})}function r(n,e,t,o){var r,i,u=Ac(n.element,t.selector);return r=n,(i=t).focusManager.get(r).bind(function(e){return Vc(e,i.selector)}).bind(function(e){return g(u,f(tt,e)).bind(function(e){return a(n,u,e,t,o)})})}var t=[ln("onEscape"),ln("onEnter"),pn("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),pn("firstTabstop",0),pn("useTabstopAt",x),ln("visibilitySelector")].concat([e]),o=w([Zc(Gc([Kc,Wc(gs)]),function(e,n,t){var o=t.cyclic?Rc:Hc;return r(e,0,t,o)}),Zc(Wc(gs),function(e,n,t){var o=t.cyclic?Uc:jc;return r(e,0,t,o)}),Zc(Wc(vs),function(n,t,e){return e.onEscape.bind(function(e){return e(n,t)})}),Zc(Gc([Os,Wc(hs)]),function(n,t,e){return e.onEnter.bind(function(e){return e(n,t)})})]),e=w([]);return Bs(t,Hn.init,o,e,function(){return E.some(n)})},nc=_i(vn("cyclic",s)),tc=_i(vn("cyclic",x)),rc=function(e,n,t){return Ms(t)&&Wc(ys)(n.event)?E.none():(lt(e,t,Wr()),E.some(!0))},nr=[pn("execute",rc),pn("useSpace",!1),pn("useEnter",!0),pn("useControlEnter",!1),pn("useDown",!1)],oc=Bs(nr,Hn.init,function(e,n,t,o){var r=t.useSpace&&!Ms(e.element)?ys:[],i=t.useEnter?hs:[],e=t.useDown?Ss:[],e=r.concat(i).concat(e);return[Zc(Wc(e),_s)].concat(t.useControlEnter?[Zc(Gc([qc,Wc(hs)]),_s)]:[])},function(e,n,t,o){return t.useSpace&&!Ms(e.element)?[Zc(Wc(ys),Is)]:[]},function(){return E.none()}),Za=function(){var t=kt(E.none());return Un({readState:function(){return t.get().map(function(e){return{numRows:String(e.numRows),numColumns:String(e.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(e,n){t.set(E.some({numRows:e,numColumns:n}))},getNumRows:function(){return t.get().map(function(e){return e.numRows})},getNumColumns:function(){return t.get().map(function(e){return e.numColumns})}})},z=Object.freeze({__proto__:null,flatgrid:Za,init:function(e){return e.state(e)}}),Bf=function(e){return"rtl"===To(e,"direction")?"rtl":"ltr"},Oi=function(r){return function(e,n,t,o){return Mf(r,e,n,t,o)}},Mf=function(n,t,e,o,r){return o.focusManager.get(t).bind(function(e){return n(t.element,e,o,r)}).map(function(e){return o.focusManager.set(t,e),!0})},gr=Oi,Vr=Oi,If=Oi,Di=[tn("selector"),pn("execute",rc),In("onEscape"),pn("captureTab",!1),er()],vi=function(r){return function(e,n,t,o){return Vs(e,n,t.selector).bind(function(e){return r(e.candidates,e.index,o.getNumRows().getOr(t.initSize.numRows),o.getNumColumns().getOr(t.initSize.numColumns))})}},Ii=function(e,n,t){return t.captureTab?E.some(!0):E.none()},_i=vi(function(e,n,t,o){return Us(e,n,t,o,-1)}),nr=vi(function(e,n,t,o){return Us(e,n,t,o,1)}),Oi=vi(function(e,n,t,o){return js(e,n,t,o,-1)}),vi=vi(function(e,n,t,o){return js(e,n,t,o,1)}),_i=w([Zc(Wc(bs),zs(_i,nr)),Zc(Wc(xs),Ps(_i,nr)),Zc(Wc(ws),gr(Oi)),Zc(Wc(Ss),Vr(vi)),Zc(Gc([Kc,Wc(gs)]),Ii),Zc(Gc([Os,Wc(gs)]),Ii),Zc(Wc(vs),function(e,n,t){return t.onEscape(e,n)}),Zc(Wc(ys.concat(hs)),function(n,t,o,e){return r=n,(i=o).focusManager.get(r).bind(function(e){return Vc(e,i.selector)}).bind(function(e){return o.execute(n,t,e)});var r,i})]),nr=w([Zc(Wc(ys),Is)]),Oi=Bs(Di,Za,_i,nr,function(){return E.some(Ws)}),vi=[tn("selector"),pn("getInitial",E.none),pn("execute",rc),In("onEscape"),pn("executeOnMove",!1),pn("allowVertical",!0)],Ii=w([Zc(Wc(ys),Is)]),Di=Bs(vi,Hn.init,function(e,n,t,o){var r=bs.concat(t.allowVertical?ws:[]),t=xs.concat(t.allowVertical?Ss:[]);return[Zc(Wc(r),Ys(zs(Zs,Js))),Zc(Wc(t),Ys(Ps(Zs,Js))),Zc(Wc(hs),Ks),Zc(Wc(ys),Ks),Zc(Wc(vs),Xs)]},Ii,function(){return E.some(qs)}),Za=[fn("selectors",[tn("row"),tn("cell")]),pn("cycles",!0),pn("previousSelector",E.none),pn("execute",rc)],_i=function(e,n){return function(t,o,i){var u=i.cycles?e:n;return Vc(o,i.selectors.row).bind(function(e){var n=Ac(e,i.selectors.cell);return Rs(n,o).bind(function(o){var r=Ac(t,i.selectors.row);return Rs(r,e).bind(function(e){var n,t=(n=i,O(r,function(e){return Ac(e,n.selectors.cell)}));return u(t,e,o).map(function(e){return e.cell})})})})}},nr=_i(function(e,n,t){return Qs(e,n,t,-1)},function(e,n,t){return nf(e,n,t,-1)}),vi=_i(function(e,n,t){return Qs(e,n,t,1)},function(e,n,t){return nf(e,n,t,1)}),Ii=_i(function(e,n,t){return ef(e,t,n,-1)},function(e,n,t){return tf(e,t,n,-1)}),_i=_i(function(e,n,t){return ef(e,t,n,1)},function(e,n,t){return tf(e,t,n,1)}),Vr=w([Zc(Wc(bs),zs(nr,vi)),Zc(Wc(xs),Ps(nr,vi)),Zc(Wc(ws),gr(Ii)),Zc(Wc(Ss),Vr(_i)),Zc(Wc(ys.concat(hs)),function(n,t,o){return Ka(n.element).bind(function(e){return o.execute(n,t,e)})})]),_i=w([Zc(Wc(ys),Is)]),Za=Bs(Za,Hn.init,Vr,_i,function(){return E.some(of)}),Vr=[tn("selector"),pn("execute",rc),pn("moveOnTab",!1)],_i=function(n,t,o){return o.focusManager.get(n).bind(function(e){return o.execute(n,t,e)})},rc=w([Zc(Wc(ws),If(uf)),Zc(Wc(Ss),If(af)),Zc(Gc([Kc,Wc(gs)]),function(e,n,t,o){return t.moveOnTab?If(uf)(e,n,t,o):E.none()}),Zc(Gc([Os,Wc(gs)]),function(e,n,t,o){return t.moveOnTab?If(af)(e,n,t,o):E.none()}),Zc(Wc(hs),_i),Zc(Wc(ys),_i)]),_i=w([Zc(Wc(ys),Is)]),rc=Bs(Vr,Hn.init,rc,_i,function(){return E.some(rf)}),_i=[In("onSpace"),In("onEnter"),In("onShiftEnter"),In("onLeft"),In("onRight"),In("onTab"),In("onShiftTab"),In("onUp"),In("onDown"),In("onEscape"),pn("stopSpaceKeyup",!1),ln("focusIn")],_i=Bs(_i,Hn.init,function(e,n,t){return[Zc(Wc(ys),t.onSpace),Zc(Gc([Os,Wc(hs)]),t.onEnter),Zc(Gc([Kc,Wc(hs)]),t.onShiftEnter),Zc(Gc([Kc,Wc(gs)]),t.onShiftTab),Zc(Gc([Os,Wc(gs)]),t.onTab),Zc(Wc(ws),t.onUp),Zc(Wc(Ss),t.onDown),Zc(Wc(bs),t.onLeft),Zc(Wc(xs),t.onRight),Zc(Wc(ys),t.onSpace),Zc(Wc(vs),t.onEscape)]},function(e,n,t){return t.stopSpaceKeyup?[Zc(Wc(ys),Is)]:[]},function(e){return e.focusIn}),nc=nc.schema(),tc=tc.schema(),Di=Di.schema(),Oi=Oi.schema(),Za=Za.schema(),oc=oc.schema(),rc=rc.schema(),_i=_i.schema(),_f=St({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:nc,cyclic:tc,flow:Di,flatgrid:Oi,matrix:Za,execution:oc,menu:rc,special:_i}),name:"keying",active:{events:function(e,n){return e.handler.toEvents(e,n)}},apis:{focusIn:function(n,t,o){t.sendFocusIn(t).fold(function(){n.getSystem().triggerFocus(n.element,n.element)},function(e){e(n,t,o)})},setGridSize:function(e,n,t,o,r){ce(t,"setGridSize")?t.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:z}),_i=[Nn("type","text/plain"),pn("phoneyTypes",[]),Vn("effectAllowed","all",["copy","move","link","all","copyLink","linkMove","copyMove"]),Pn("getData"),Pn("getImageParent"),Pn("getImage"),Rn("canDrag",x),Rn("onDragstart",l),Rn("onDragover",l),Rn("onDragend",l),vn("instance",function(){return{exhibit:function(){return ht({attributes:{draggable:"true"}})},handlers:function(c){return ii([dt(Mr(),c.onDragover),dt(Ir(),c.onDragend),dt(_r(),function(e,n){var t,o,r,i,u=n.event.target,a=df(n);c.canDrag(e,u)?(t=e,o=u,u=i=a,a=(r=c).effectAllowed,u.effectAllowed=a,r.getData.each(function(e){var n=e(t),e=[r.type].concat(r.phoneyTypes);sf(i,e,n)}),r.getImage.each(function(e){var n=e(t),e=r.getImageParent.fold(function(){return Dt(o).getOr(So())},function(e){return e(t)});vf(i,n,e,o)}),c.onDragstart(e,n)):n.event.prevent()})])}}})],Ef=St({branchKey:"mode",branches:{drag:_i,drop:[Nn("type","text/plain"),Vn("dropEffect","move",["copy","move","link","none"]),Tn("onDrop"),Tn("onDrag"),Tn("onDragover"),Tn("onDragenter"),Tn("onDragleave"),vn("instance",function(){return{exhibit:function(){return ht({})},handlers:function(r){return ii([dt(Mr(),function(e,n){n.stop(),mf(n,r.dropEffect),r.onDragover(e,n)}),dt(Er(),r.onDragleave),dt(Pr(),r.onDrag),dt(Ar(),function(e,n){var t=df(n);lf(t,r.dropEffect),n.stop(),mf(n,r.dropEffect),r.onDragenter(e,n)}),dt(zr(),function(e,n){var t,o;n.stop(),mf(n,r.dropEffect),t=df(n),o=t.effectAllowed.toLowerCase(),t=t.dropEffect.toLowerCase(),"all"!==o&&"uninitialized"!==o&&!Xn(o,t)||r.onDrop(e,yf(r,n))})])}}})]},name:"dragndrop",active:{exhibit:function(e,n){return n.instance.exhibit(e,n)},events:function(e){return e.instance.handlers(e)}}}),Af=function(e,n){return wf(O(e,n))},zf=function(e){return e.getContext("2d")},Pf=function(e,n,t){return e.width=n,e.height=t,e},Nf=window.Promise||(Cf=window,Lf=Vf.immediateFn||"function"==typeof Cf.setImmediate&&Cf.setImmediate||function(e){return setTimeout(e,1)},Ff=function(t,o){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(o,e)}},Tf=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Df=function(e,n,t){var o=!1;try{e(function(e){o||(o=!0,n(e))},function(e){o||(o=!0,t(e))})}catch(e){if(o)return;o=!0,t(e)}},Vf.prototype.catch=function(e){return this.then(null,e)},Vf.prototype.then=function(t,o){var r=this;return new Vf(function(e,n){Rf.call(r,new Wf(t,o,e,n))})},Vf.all=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=Array.prototype.slice.call(1===e.length&&Tf(e[0])?e[0]:e);return new Vf(function(o,r){if(0===a.length)return o([]);for(var i=a.length,u=function(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void t.call(e,function(e){u(n,e)},r)}a[n]=e,0==--i&&o(a)}catch(e){r(e)}},e=0;e<a.length;e++)u(e,a[e])})},Vf.resolve=function(n){return n&&"object"==typeof n&&n.constructor===Vf?n:new Vf(function(e){e(n)})},Vf.reject=function(t){return new Vf(function(e,n){n(t)})},Vf.race=function(r){return new Vf(function(e,n){for(var t=0,o=r;t<o.length;t++)o[t].then(e,n)})},Vf);function Vf(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],Df(e,Ff(Hf,this),Ff(Uf,this))}function Rf(t){var o=this;null!==this._state?Lf(function(){var e,n=o._state?t.onFulfilled:t.onRejected;if(null!==n){try{e=n(o._value)}catch(e){return void t.reject(e)}t.resolve(e)}else(o._state?t.resolve:t.reject)(o._value)}):this._deferreds.push(t)}function Hf(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void Df(Ff(n,e),Ff(Hf,this),Ff(Uf,this))}this._state=!0,this._value=e,jf.call(this)}catch(e){Uf.call(this,e)}}function Uf(e){this._state=!1,this._value=e,jf.call(this)}function jf(){for(var e=0,n=this._deferreds;e<n.length;e++){var t=n[e];Rf.call(this,t)}this._deferreds=[]}function Wf(e,n,t,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.resolve=t,this.reject=o}function Gf(a){return new Nf(function(e,n){function t(){r.removeEventListener("load",i),r.removeEventListener("error",u)}var o=URL.createObjectURL(a),r=new Image,i=function(){t(),e(r)},u=function(){t(),n("Unable to load data of type "+a.type+": "+o)};r.addEventListener("load",i),r.addEventListener("error",u),r.src=o,r.complete&&setTimeout(i,0)})}function Kf(t){return new Nf(function(e,n){!function(e){var n=e.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return E.none();for(var e=e[1],n=n[1],t=atob(n),o=t.length,r=Math.ceil(o/1024),i=new Array(r),u=0;u<r;++u){for(var a=1024*u,c=Math.min(1024+a,o),s=new Array(c-a),f=a,l=0;f<c;++l,++f)s[l]=t[f].charCodeAt(0);i[u]=new Uint8Array(s)}return E.some(new Blob(i,{type:e}))}(t).fold(function(){n("uri is not base64: "+t)},e)})}function qf(e,o,r){return o=o||"image/png",W(HTMLCanvasElement.prototype.toBlob)?new Nf(function(n,t){e.toBlob(function(e){e?n(e):t()},o,r)}):Kf(e.toDataURL(o,r))}function Zf(e,n,t){function o(o,r){return e.then(function(e){return n=o,t=r,e.toDataURL(n=n||"image/png",t);var n,t})}var r=n.type,i=w(r),r=w(t);return{getType:i,toBlob:function(){return Nf.resolve(n)},toDataURL:r,toBase64:function(){return t.split(",")[1]},toAdjustedBlob:function(n,t){return e.then(function(e){return qf(e,n,t)})},toAdjustedDataURL:o,toAdjustedBase64:function(e,n){return o(e,n).then(function(e){return e.split(",")[1]})},toCanvas:function(){return e.then(Sf)}}}function Jf(n,e){return qf(n,e).then(function(e){return Zf(Nf.resolve(n),e,n.toDataURL())})}function Yf(n){return t=n,new Nf(function(e){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsDataURL(t)}).then(function(e){return Zf(Gf(n).then(function(e){Xf(e);var n=xf(Of(e),kf(e));return zf(n).drawImage(e,0,0),n}),n,e)});var t}var Xf=function(e){URL.revokeObjectURL(e.src)},$f=(Qf.prototype.readByteAt=function(e){return this.dataView.getUint8(e)},Qf.prototype.read=function(e,n){if(e+n>this.length())return $.error("Read extends past buffer end");for(var t=this.littleEndian?0:-8*(n-1),o=0,r=0;r<n;r++)o|=this.readByteAt(e+r)<<Math.abs(t+8*r);return $.value(o)},Qf.prototype.segment=function(e,n){var t=this.dataView.buffer;return void 0!==e&&void 0!==n?t.slice(e,e+n):void 0!==e?t.slice(e):t},Qf.prototype.length=function(){return this.dataView.byteLength},Qf);function Qf(e){this.littleEndian=!1,this.dataView=new DataView(e)}function el(e,n,t,o,r){if(n+t*o>e.length())return $.error("Read would extend past end of buffer");for(var i=[],u=0;u<o;u++){var a=r(e,n+t*u);if(a.isError())return a.map(function(e){return[e]});i.push(a.getOrDie())}return $.value(i)}function nl(e,n){return e.read(n,1)}function tl(e,n){return e.read(n,2)}function ol(e,n){return e.read(n,4)}function rl(e){return $.value(String.fromCharCode(e))}function il(e){return $.value(2147483647<e?e-4294967296:e)}function ul(e,n){return ol(e,n).bind(il)}function al(e,n){return nl(e,n).bind(rl)}function cl(e,n,t){return el(e,n,1,t=void 0===t?1:t,al).map(function(e){return e.join("")})}function sl(e,t){return ol(e,t).bind(function(n){return ol(e,t+4).map(function(e){return n/e})})}function fl(e,t){return ul(e,t).bind(function(n){return ul(e,t+4).map(function(e){return n/e})})}function ll(c,r,s,f){function l(n){return function(e){return E.some([n,e])}}function d(e){return e.replace(/\0$/,"").trim()}var m={1:{name:"BYTE",size:1,read:nl},7:{name:"UNDEFINED",size:1,read:nl},2:{name:"ASCII",size:1,read:nl},3:{name:"SHORT",size:2,read:tl},4:{name:"LONG",size:4,read:ol},5:{name:"RATIONAL",size:8,read:sl},9:{name:"SLONG",size:4,read:ul},10:{name:"SRATIONAL",size:8,read:fl}};return tl(c,r).fold(function(){return $.value({})},function(e){for(var t={},n=0;n<e;n++){var o=function(e){var a=r+2+12*e,e=tl(c,a+0).bind(function(u){return tl(c,a+2).bind(function(i){return ol(c,a+4).bind(function(e){var n=f[u];if(void 0===n)return $.value(E.none());var t=m[i];if(void 0===t)return $.error("Tag with type number "+i+" was unrecognised.");var o=a+8;if(4<t.size*e){var r=ol(c,a+8);if(r.isError())return r.map(function(e){return E.none()});o=r.getOrDie()+s}return o+t.size*e>=c.length()?$.error("Invalid Exif data."):(1===e&&void 0!==nm[n]?t.read(c,o).map(function(e){return nm[n][e]}):"ASCII"===t.name?cl(c,o,e).map(d):1===e?t.read(c,o):el(c,o,t.size,e,t.read)).map(l(n))})})});if(e.isError())return{value:e.map(function(e){return t})};e.each(function(e){return e.each(function(e){var n=e[0],e=e[1];t[n]=e})})}(n);if("object"==typeof o)return o.value}return $.value(t)})}function dl(e){return{Orientation:E.from(e.Orientation).filter(G).getOrUndefined(),ImageDescription:E.from(e.ImageDescription).filter(N).getOrUndefined(),Make:E.from(e.Make).filter(N).getOrUndefined(),Model:E.from(e.Model).filter(N).getOrUndefined(),Software:E.from(e.Software).filter(N).getOrUndefined(),ExifIFDPointer:E.from(e.ExifIFDPointer).filter(G),GPSInfoIFDPointer:E.from(e.GPSInfoIFDPointer).filter(G)}}function ml(e){var n;return{ExifVersion:(n=e.ExifVersion,N(n)?n:R(n)?O(n,function(e){return G(e)?String.fromCharCode(e):""}).join(""):void 0),ColorSpace:E.from(e.ColorSpace).filter(N).getOrUndefined(),PixelXDimension:E.from(e.PixelXDimension).filter(G).getOrUndefined(),PixelYDimension:E.from(e.PixelYDimension).filter(G).getOrUndefined(),DateTimeOriginal:E.from(e.DateTimeOriginal).filter(N).getOrUndefined(),ExposureTime:E.from(e.ExposureTime).filter(G).getOrUndefined(),FNumber:E.from(e.FNumber).filter(G).getOrUndefined(),ISOSpeedRatings:E.from(e.ISOSpeedRatings).filter(G).getOrUndefined(),ShutterSpeedValue:E.from(e.ShutterSpeedValue).filter(G).getOrUndefined(),ApertureValue:E.from(e.ApertureValue).filter(G).getOrUndefined(),MeteringMode:E.from(e.MeteringMode).filter(N).getOrUndefined(),LightSource:E.from(e.LightSource).filter(N).getOrUndefined(),Flash:E.from(e.Flash).filter(N).getOrUndefined(),FocalLength:E.from(e.FocalLength).filter(G).getOrUndefined(),ExposureMode:E.from(e.ExposureMode).filter(N).getOrUndefined(),WhiteBalance:E.from(e.WhiteBalance).filter(N).getOrUndefined(),SceneCaptureType:E.from(e.SceneCaptureType).filter(N).getOrUndefined(),DigitalZoomRatio:E.from(e.DigitalZoomRatio).filter(G).getOrUndefined(),Contrast:E.from(e.Contrast).filter(N).getOrUndefined(),Saturation:E.from(e.Saturation).filter(N).getOrUndefined(),Sharpness:E.from(e.Sharpness).filter(N).getOrUndefined()}}function pl(e){var n;return{GPSVersionID:(n=e.GPSVersionID,N(n)?n:R(n)?O(n,function(e){return G(e)?""+e:N(e)?e:""}).join("."):void 0),GPSLatitudeRef:E.from(e.GPSLatitudeRef).filter(N).getOrUndefined(),GPSLatitude:E.from(e.GPSLatitude).filter(G).getOrUndefined(),GPSLongitudeRef:E.from(e.GPSLongitudeRef).filter(N).getOrUndefined(),GPSLongitude:E.from(e.GPSLongitude).filter(G).getOrUndefined()}}function gl(e){var n=e.JPEGInterchangeFormat;return void 0!==n&&G(n)&&void 0!==(e=e.JPEGInterchangeFormatLength)&&G(e)?$.value({JPEGInterchangeFormat:n,JPEGInterchangeFormatLength:e}):$.error("")}function hl(l){return t=l,new Nf(function(e){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsArrayBuffer(t)}).then(function(e){try{var n=new $f(e);if(tl(n,0).is(65496)){var t=tm(n),o=t.filter(function(e){return"APP1"===e.name}),r={rawHeaders:t};if(!o.length)return Nf.reject("Headers did not include required information");var i=(u=o[0].segment,a=new $f(u),c=tl(a,0).is(65505)&&cl(a,4,5).map(function(e){return e.toUpperCase()}).is("EXIF\0")?(a.littleEndian=tl(a,10).is(18761),tl(a,12).is(42)?ol(a,14).map(function(e){return 10+e}):$.error("Invalid Exif data.")):$.error("APP1 marker and EXIF marker cannot be read or not available."),s=c.bind(function(e){return ll(a,e,10,Xd).map(dl)}),f=s.bind(function(e){return e.ExifIFDPointer.fold(function(){return $.value(E.none())},function(e){return ll(a,10+e,10,$d).map(ml).map(E.some)})}),u=s.bind(function(e){return e.GPSInfoIFDPointer.fold(function(){return $.value(E.none())},function(e){return ll(a,10+e,10,Qd).map(pl).map(E.some)})}),{tiff:s,exif:f,gps:u,thumb:c.bind(function(n){return tl(a,n).map(function(e){return n+2+12*e})}).bind(function(e){return ol(a,e).map(function(e){return e+10})}).bind(function(e){return ll(a,e,10,em).bind(gl).map(function(e){return a.segment(10+e.JPEGInterchangeFormat,e.JPEGInterchangeFormatLength)}).map(E.some)})});return r.tiff=i.tiff.getOrDie(),r.exif=Qc(i.exif.toOptional()).getOrNull(),r.gps=Qc(i.gps.toOptional()).getOrNull(),r.thumb=Qc(i.thumb.toOptional()).getOrNull(),r}return Nf.reject("Image was not a jpeg")}catch(e){return Nf.reject("Unsupported format or not an image: "+l.type+" (Exception: "+e.message+")")}var u,a,c,s,f});var t}function vl(e,n,t){return r=n,i=t,(o=e).toCanvas().then(function(e){return om(e,r,i).then(function(e){return Jf(e,o.getType())})});var o,r,i}function yl(e,n){return o=n,(t=e).toCanvas().then(function(e){return im(e,t.getType(),o)});var t,o}function bl(n){return n.toBlob().then(hl).then(function(e){switch(e.tiff.Orientation){case 6:return yl(n,90);case 3:return yl(n,180);case 8:return yl(n,270);default:return n}},function(){return n})}function wl(e){return na.nu(function(n){e().then(function(e){return n($.value(e))}).catch(function(e){return n($.error(e))})})}function xl(e){return 0<(e=p(e,function(n,e){return e.fold(function(e){return{values:n.values,errors:n.errors.concat([e])}},function(e){return{values:n.values.concat([e]),errors:n.errors}})},{values:[],errors:[]})).errors.length?$.error(e.errors[0]):$.value(e.values)}function Sl(e){return p(e,function(e,t){return e.bind(function(n){return t.map(function(e){return n.concat([e])})})},$u([]))}function Ol(e,n){return Math.max(e.width/n.width,e.height/n.height)}function kl(o,r){return e=o,wl(function(){return um(e).then(function(e){var n=e.naturalWidth,t=e.naturalHeight;return URL.revokeObjectURL(e.src),{width:n,height:t}})}).bindFuture(function(e){return 1<Ol(e,r)?(n=o,t=function(e,n){n=Ol(e,n);return{width:Math.round(e.width/n),height:Math.round(e.height/n)}}(e,r),wl(function(){return Yf(n).then(function(e){return vl(e,t.width,t.height)}).then(function(e){return e.toAdjustedBlob(n.type,9)})})):na.value(o);var n,t});var e}function Cl(e){return na.fromPromise(Yf(e).then(pr().browser.isIE()?bl:l).then(function(e){return e.toBlob()}))}function Ll(e,n){return t=e,n.map(function(e){return kl(t,{width:e,height:e})}).getOr(na.pure(t)).bindFuture(Cl).bindFuture(function(n){return kl(n,{width:512,height:512}).mapResult(function(e){return{blob:n,thumbBlob:E.some(e)}})}).mapError(ru);var t}function Fl(e,n){return S(am,e.type)?Ll(e,n):na.pure({blob:e,thumbBlob:E.none()})}function Tl(e){var n,t,o;if(-1<e)for(o=["TB","GB","MB","KB","B"],n=0;n<o.length;n++)if((t=Math.pow(1024,4-n))<e)return Math.round(e/t)+" "+o[n];return""}function Dl(e){return 0<(e=p(e,function(e,n){var t=e.errors,o=e.values;return n.fold(function(e){return{values:o,errors:t.concat([e])}},function(e){return{values:o.concat([e]),errors:t}})},{values:[],errors:[]})).errors.length?$.error(e.errors):$.value(e.values)}function Bl(e,n){return e=e.replace(/\/$/,"").replace(/^.*[\/\\]/g,""),e=n&&e.substr(e.length-n.length)===n?e.substr(0,e.length-n.length):e}function Ml(e){var n=e.lastIndexOf(".");return-1!==n?e.substr(n):""}function Il(e){return Ml(e).substring(1).toLowerCase()}function _l(e){return e=Ml(e).substring(1).toLowerCase(),S(pm,e)?E.some("image"):S(gm,e)?E.some("document"):S(hm,e)?E.some("audio"):S(vm,e)?E.some("video"):S(ym,e)?E.some("archive"):E.none()}function El(e){switch(e){case"directory":return[];case"document":return gm;case"audio":return hm;case"video":return vm;case"image":return pm;case"archive":return ym}}function Al(e){switch(e){case"directory":return[];case"document":return we(fm);case"audio":return we(lm);case"video":return we(dm);case"image":return we(sm);case"archive":return we(mm)}}function zl(e){return e=0<e.length?F(e,El):Zn(Zn(Zn(Zn(Zn([],pm),gm),hm),vm),ym),O(e,function(e){return"."+e})}function Pl(e){return 0<e.length?F(e,Al):Zn(Zn(Zn(Zn(Zn([],we(sm)),we(fm)),we(lm)),we(dm)),we(mm))}function Nl(e,n,t,o){return cm<t?$.error('File too large: "'+n+'" maximum file size is: '+Tl(cm)):!1===function(n,e){e=_l(e);return 0<n.length?e.exists(function(e){return S(n,e)}):e.isSome()}(e,n)?$.error('Invalid file extension for file: "'+n+'"'):$.value(o)}function Vl(n,e){return Dl(O(e,function(e){return Nl(n,e.name,e.uploadSize,e)}))}function Rl(e){return{name:e.name,downloadSize:0,uploadSize:e.size,getBlob:function(){return na.value(e)},uuid:Yt("w3cfile")}}function Hl(e){return O(e,Rl)}function Ul(t,c,s){return function(i,n,u){var a=nu(n().path),e=O(J(t),function(o){return o.getBlob((t=o,r=i,function(e){var n=t.downloadSize+t.uploadSize;r(0===n?{type:oa.UploadProgress,payload:{loaded:10,total:100,name:t.name,uuid:t.uuid}}:{type:oa.UploadProgress,payload:{loaded:e,total:n,name:t.name,uuid:t.uuid}})})).mapError(iu).bindResult(function(e){return n=c,t=o.name,Nl(n,t,(e=e).size,e).mapError(ru);var n,t}).bindFuture(function(e){return Fl(e,s)}).bindFuture(function(e){return u.upload({blob:e.blob,thumbBlob:e.thumbBlob,name:o.name,progress:(n=o,t=i,function(e){t({type:oa.UploadProgress,payload:{loaded:n.downloadSize+e.loaded,total:n.downloadSize+e.total,name:e.name,uuid:n.uuid}})}),parent:a});var n,t});var t,r});wf(e).get(function(e){k(e,function(e){e.fold(fu(i),b)}),xu(i,n,u)})}}function jl(){function e(e,n){n.stop(),ft(e)}return[dt(Br(),e),dt(Kr(),e),pt(hr()),pt(wr())]}function Wl(e){return ii(h([e.map(function(t){return si(function(e,n){t(e),n.stop()})}).toArray(),jl()]))}function Gl(e,n){n.ignore||(Wa(e.element),n.onFocus(e))}function Kl(){return ip.sketch({iconHtml:np,classes:[bm.LocationIcon,bm.Star]})}function ql(e,n,t){n.store.manager.onLoad(e,n,t)}function Zl(e,n,t){n.store.manager.onUnload(e,n,t)}function Jl(e,n,t,o){var r=n.store;t.update([o]),r.setValue(e,o),n.onSetValue(e,o)}function Yl(){return function(e){e({type:"selectedFiles.clear",payload:""})}}function Xl(r){return function(n,e,t){var o=M(e().path.slice(0,r)).bind(function(e){return e.uuid}),o=pu(t,e().viewType,gu(e(),{parentUuid:o}));Yl()(n,e,t),wu(n,e(),o,function(e){n({type:ta.Slice,payload:{index:r}}),n(hu(e))})}}function $l(){return cp.sketch({dom:{tag:"li"},components:[{dom:{tag:"div",classes:[bm.Asset,bm.AssetBack]},components:[{dom:{tag:"div",classes:[bm.AssetIconContainer]},components:[{dom:{tag:"span",classes:[bm.AssetIcon],innerHtml:Lm}}]},{dom:{tag:"div",classes:[bm.AssetMetadata]},components:[{dom:{tag:"a",classes:[bm.AssetName]},components:[{dom:{tag:"span"},components:[sp("Move one folder up")]}]}]}]}],action:function(e){return Du(e,function(e,n,t){Xl(n().path.length-1)(e,n,t)})},buttonBehaviours:di([mp.config({store:{mode:"memory",initialValue:bp}})])})}function Ql(e){return Gn(Gn({},(n=e,di([ap.config({onFocus:n.selectOnFocus?function(e){var n=e.element,e=Mo(n);n.dom.setSelectionRange(0,e.length)}:b})]))),za(e.inputBehaviours,[mp.config({store:Gn(Gn({mode:"manual"},e.data.map(function(e){return{initialValue:e}}).getOr({})),{getValue:function(e){return Mo(e.element)},setValue:function(e,n){Mo(e.element)!==n&&Io(e.element,n)}}),onSetValue:e.onSetValue})]));var n}function ed(e){return kp.get(e)}function nd(e){return kp.getOuter(e)}function td(e,n,t){return xc(e,n,t).isSome()}function od(n,e){return xc(e,function(e){if(!yi(e))return!1;e=Wt(e,"id");return void 0!==e&&-1<e.indexOf("aria-owns")}).bind(function(e){var n=Wt(e,"id"),e=Ci(e);return Nc(e,'[aria-owns="'+n+'"]')}).exists(function(e){return Cp(n,e)})}function rd(e,n){return void 0!==e?e:void 0!==n?n:0}function id(e){var n=(i=e.dom.ownerDocument).body,t=i.defaultView,o=i.documentElement;if(n===e.dom)return Tp(n.offsetLeft,n.offsetTop);var r=rd(null==t?void 0:t.pageYOffset,o.scrollTop),i=rd(null==t?void 0:t.pageXOffset,o.scrollLeft),t=rd(o.clientTop,n.clientTop),n=rd(o.clientLeft,n.clientLeft);return Dp(e).translate(i-n,r-t)}function ud(e){var e=(n=void 0!==e?e.dom:document).body.scrollLeft||n.documentElement.scrollLeft,n=n.body.scrollTop||n.documentElement.scrollTop;return Tp(e,n)}function ad(e,n,t,o){return{x:e,y:n,width:t,height:o,right:e+t,bottom:n+o}}function cd(e){var t=void 0===e?window:e,e=t.document,o=ud(Wn.fromDom(e));return function(e){e=void 0===e?window:e;return E.from(e.visualViewport)}(t).fold(function(){var e=t.document.documentElement,n=e.clientWidth,e=e.clientHeight;return ad(o.left,o.top,n,e)},function(e){return ad(Math.max(e.pageLeft,o.left),Math.max(e.pageTop,o.top),e.width,e.height)})}function sd(t){var e=Wn.fromDom(document),o=ud(e);return function(e,n){e=n.owner(e),e=Bp(n,e);return E.some(e)}(t,Mp).fold(f(id,t),function(e){var n=Dp(t),e=m(e,function(e,n){n=Dp(n);return{left:e.left+n.left,top:e.top+n.top}},{left:0,top:0});return Tp(e.left+n.left+o.left,e.top+n.top+o.top)})}function fd(e,n,t,o){return{x:e,y:n,width:t,height:o,right:e+t,bottom:n+o}}function ld(e){var n=id(e),t=nd(e),e=_c(e);return fd(n.left,n.top,t,e)}function dd(){return cd(window)}function md(e,n,t,o,r){return{position:e,left:n,top:t,right:o,bottom:r}}function pd(e,n){function t(e){return e+"px"}Fo(e,{position:E.some(n.position),left:n.left.map(t),top:n.top.map(t),right:n.right.map(t),bottom:n.bottom.map(t)})}function gd(e,n,t,o,r,i){var u=n.x-t,a=n.y-o,c=r-(u+n.width),s=i-(a+n.height),f=E.some(u),l=E.some(a),d=E.some(c),m=E.some(s),p=E.none();return t=n.direction,o=function(){return md(e,f,l,p,p)},r=function(){return md(e,p,l,d,p)},i=function(){return md(e,f,p,p,m)},u=function(){return md(e,p,p,d,m)},a=function(){return md(e,f,l,p,p)},c=function(){return md(e,f,p,p,m)},s=function(){return md(e,f,l,p,p)},n=function(){return md(e,p,l,d,p)},t.fold(o,r,i,u,a,c,s,n)}function hd(e,n){var t=f(sd,n),o=e.fold(t,t,function(){var e=ud();return sd(n).translate(-e.left,-e.top)}),e=nd(n),t=_c(n);return fd(o.left,o.top,e,t)}function vd(n,t){return function(e,n){for(var t={},o=0,r=e.length;o<r;o++){var i=e[o];t[String(i)]=n(i,o)}return t}(["left","right","top","bottom"],function(e){return ae(t,e).map(function(e){return function(e,n){switch(n){case 1:return e.x;case 0:return e.x+e.width;case 2:return e.y;case 3:return e.y+e.height}}(n,e)})})}function yd(e,r,i){function n(n,t){var o="top"===n||"bottom"===n?i.top:i.left;return ae(r,n).bind(l).bind(function(e){return"left"===n||"top"===n?t<=e?E.some(e):E.none():e<=t?E.some(e):E.none()}).map(function(e){return e+o}).getOr(t)}var t=n("left",e.x),o=n("top",e.y),u=n("right",e.right),e=n("bottom",e.bottom);return fd(t,o,u-t,e-o)}function bd(e,n,t,o){var r=e.x,i=e.y,u=(h=e.bubble.offset).left,a=h.top,c=(v=yd(o,e.boundsRestriction,h)).y,s=v.bottom,f=v.x,l=v.right,d=(v=(d=r+u,p=y=i+a,m=n,g=t,h=(o=v).x,i=o.y,a=o.width,r=o.height,u=i<=p,t=(n=h<=d)&&u,v=d+m<=h+a&&p+g<=i+r,h=Math.abs(Math.min(m,n?h+a-d:h-(d+m))),i=Math.abs(Math.min(g,u?i+r-p:i-(p+g))),m=Math.max(o.x,o.right-m),g=Math.max(o.y,o.bottom-g),{originInBounds:t,sizeInBounds:v,limitX:Yc(d,o.x,m),limitY:Yc(p,o.y,g),deltaW:h,deltaH:i})).originInBounds,m=v.sizeInBounds,p=v.limitX,o=v.limitY,g=v.deltaW,h=v.deltaH,i=w(o+h-c),v=w(s-o),v=(c=e.direction,v=s=v,i=i,c.fold(s,s,i,i,s,i,v,v)),f=w(p+g-f),l=w(l-p),y={x:p,y:o,width:g,height:h,maxHeight:v,maxWidth:(o=e.direction,l=v=l,f=f,o.fold(v,f,v,f,l,l,v,f)),direction:e.direction,classes:{on:e.bubble.classesOn,off:e.bubble.classesOff},label:e.label,candidateYforTest:y};return d&&m?jp.fit(y):jp.nofit(y,g,h)}function wd(e,n,t,u,a){function o(e,o,r,i){return e=e(n,t,u),bd(e,c,s,a).fold(jp.fit,function(e,n,t){return i<t||r<n?jp.nofit(e,n,t):jp.nofit(o,r,i)})}var c=t.width,s=t.height;return p(e,function(e,n){n=f(o,n);return e.fold(jp.fit,n)},jp.nofit({x:n.x,y:n.y,width:t.width,height:t.height,maxHeight:t.height,maxWidth:t.width,direction:Ip(),classes:{on:[],off:[]},label:"none",candidateYforTest:n.y},-1,-1)).fold(l,l)}function xd(e,n,t,o){return Bo(n,"max-height"),Bo(n,"max-width"),n={width:nd(n=n),height:_c(n)},wd(o.preference,e,n,t,o.bounds)}function Sd(e,n,t){var r;pd(e,(t=t.origin,r=n,t.fold(function(){return md("absolute",E.some(r.x),E.some(r.y),E.none(),E.none())},function(e,n,t,o){return gd("absolute",r,e,n,t,o)},function(e,n,t,o){return gd("fixed",r,e,n,t,o)})))}function Od(e,n){!function(e,n){n=ms.max(e,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Co(e,"max-height",n+"px")}(e,Math.floor(n))}function kd(e,n,t){return void 0===e[n]?t:e[n]}function Cd(e,n,t,o,r,i){var u,a=kd(i,"maxHeightFunction",Wp()),c=kd(i,"maxWidthFunction",b),i=e.anchorBox,e=e.origin,c={bounds:(u=e,r.fold(function(){return u.fold(dd,dd,fd)},function(t){return u.fold(t,t,function(){var e=t(),n=Rp(u,e.x,e.y);return fd(n.left,n.top,e.width,e.height)})})),origin:e,preference:o,maxHeightFunction:a,maxWidthFunction:c};Gp(i,n,t,c)}function Ld(e,n,t){function r(e){return ae(t,e).getOr([])}function o(e,n,t){var o=y(Kp,t);return{offset:Tp(e,n),classesOn:F(t,r),classesOff:F(o,r)}}return{southeast:function(){return o(-e,n,["top","alignLeft"])},southwest:function(){return o(e,n,["top","alignRight"])},south:function(){return o(-e/2,n,["top","alignCentre"])},northeast:function(){return o(-e,-n,["bottom","alignLeft"])},northwest:function(){return o(e,-n,["bottom","alignRight"])},north:function(){return o(-e/2,-n,["bottom","alignCentre"])},east:function(){return o(e,-n/2,["valignCentre","left"])},west:function(){return o(-e,-n/2,["valignCentre","right"])},innerNorthwest:function(){return o(-e,n,["top","alignRight"])},innerNortheast:function(){return o(e,n,["top","alignLeft"])},innerNorth:function(){return o(-e/2,n,["top","alignCentre"])},innerSouthwest:function(){return o(-e,-n,["bottom","alignRight"])},innerSoutheast:function(){return o(e,-n,["bottom","alignLeft"])},innerSouth:function(){return o(-e/2,-n,["bottom","alignCentre"])},innerWest:function(){return o(e,-n/2,["valignCentre","right"])},innerEast:function(){return o(-e,-n/2,["valignCentre","left"])}}}function Fd(){return Ld(0,0,{})}function Td(e,n,t,o,r,i){return{x:e,y:n,bubble:t,direction:o,boundsRestriction:r,label:i}}function Dd(e,n){return e.x+e.width/2-n.width/2}function Bd(e,n){return e.x+e.width-n.width}function Md(e,n){return e.y-n.height}function Id(e){return e.y+e.height}function _d(e,n){return e.y+e.height/2-n.height/2}function Ed(e,n,t){return Td(e.x,Id(e),t.southeast(),Ip(),vd(e,{left:1,top:3}),"layout-se")}function Ad(e,n,t){return Td(Bd(e,n),Id(e),t.southwest(),_p(),vd(e,{right:0,top:3}),"layout-sw")}function zd(e,n,t){return Td(e.x,Md(e,n),t.northeast(),Ep(),vd(e,{left:1,bottom:2}),"layout-ne")}function Pd(e,n,t){return Td(Bd(e,n),Md(e,n),t.northwest(),Ap(),vd(e,{right:0,bottom:2}),"layout-nw")}function Nd(e,n,t){return Td(Dd(e,n),Md(e,n),t.north(),Pp(),vd(e,{bottom:2}),"layout-n")}function Vd(e,n,t){return Td(Dd(e,n),Id(e),t.south(),zp(),vd(e,{top:3}),"layout-s")}function Rd(e,n,t){return Td((o=e).x+o.width,_d(e,n),t.east(),Np(),vd(e,{left:0}),"layout-e");var o}function Hd(e,n,t){return Td((o=n,e.x-o.width),_d(e,n),t.west(),Vp(),vd(e,{right:1}),"layout-w");var o}function Ud(){return[Ed,Ad,zd,Pd,Vd,Nd,Rd,Hd]}function jd(){return[Ad,Ed,Pd,zd,Vd,Nd,Rd,Hd]}function Wd(){return[zd,Pd,Ed,Ad,Nd,Vd]}function Gd(){return[Pd,zd,Ad,Ed,Nd,Vd]}function Kd(){return[Ed,Ad,zd,Pd,Vd,Nd]}function qd(){return[Ad,Ed,Pd,zd,Vd,Nd]}var Zd,Jd,Yd,Xd={274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},$d={36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},Qd={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},em={513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"},nm={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{78:"North latitude",83:"South latitude"},GPSLongitudeRef:{69:"East longitude",87:"West longitude"}},tm=function(e){for(var n=[],t=2;t+2<=e.length();){var o=tl(e,t).toOptional().getOrNull();if(null===o)throw new Error("Invalid Exif data.");if(65488<=o&&o<=65495)t+=2;else{if(65498===o||65497===o)break;var r=tl(e,t+2).toOptional().getOrNull();if(null===r)throw new Error("Invalid Exif data.");r=r+2;65505<=o&&o<=65519&&n.push({hex:o,name:"APP"+(15&o),start:t,length:r,segment:e.segment(t,r)}),t+=r}}return n},om=function(e,n,t){var o=Of(e),r=kf(e),i=n/o,o=t/r,r=!1;(i<.5||2<i)&&(i=i<.5?.5:2,r=!0),(o<.5||2<o)&&(o=o<.5?.5:2,r=!0);o=rm(e,i,o);return r?o.then(function(e){return om(e,n,t)}):o},rm=function(u,a,c){return new Nf(function(e){var n=Of(u),t=kf(u),o=Math.floor(n*a),r=Math.floor(t*c),i=xf(o,r);zf(i).drawImage(u,0,0,n,t,0,0,o,r),e(i)})},im=function(e,n,t){var o=xf(e.width,e.height),r=zf(o),i=0,u=0;return 90!==(t=t<0?360+t:t)&&270!==t||Pf(o,o.height,o.width),90!==t&&180!==t||(i=o.width),270!==t&&180!==t||(u=o.height),r.translate(i,u),r.rotate(t*Math.PI/180),r.drawImage(e,0,0),Jf(o,n)},um=Gf,am=["image/jpeg","image/png","image/gif"],cm=104857600,sm={"image/gif":["gif"],"image/jpeg":["jpeg","jpg"],"image/png":["png"],"image/tiff":["tif","tiff"],"image/bmp":["bmp"]},fm={"application/msword":["doc"],"application/vnd.ms-excel":["xls"],"application/vnd.ms-powerpoint":["ppt","pps"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/pdf":["pdf"],"application/rtf":["rtf"],"text/plain":["txt"],"application/x-iwork-keynote-sffkey":["key"],"application/x-iwork-pages-sffpages":["pages"],"application/x-iwork-numbers-sffnumbers":["numbers"]},lm={"audio/wav":["wav","wave"],"audio/mpeg":["mp3"],"audio/ogg":["ogg","oga","ogx","ogm","spx","opus"]},dm={"video/mp4":["mp4","m4v"],"video/ogg":["ogv"],"video/webm":["webm"],"video/quicktime":["mov"]},mm={"application/zip":["zip"]},pm=h(ue(sm)),gm=h(ue(fm)),hm=h(ue(lm)),vm=h(ue(dm)),ym=h(ue(mm)),bm={AssetmanagerRoot:"tam-assetmanager-root",AssetmanagerModal:"tam-assetmanager-modal",AssetmanagerFullscreen:"tam-assetmanager-fullscreen",Checkbox:"tam-checkbox",CheckboxInput:"tam-checkbox-input",Checkbox__Input:"tam-checkbox__input",AssetmanagerAux:"tam-assetmanager-aux",MenuIcon:"tam-menu__icon",MenuLabel:"tam-menu__label",LocationIcon:"tam-location__icon",Location:"tam-location",NavbarContainer:"tam-navbar__main",LocationButton:"tam-location__button",LocationButtonLabel:"tam-location__button-label",LocationStarred:"tam-location--starred",LocationFiles:"tam-location--files",LocationSearchResult:"tam-location--search-result",LocationLabel:"tam-location__label",ButtonSelected:"tam-button--selected",Menu:"tam-menu",MenuHasIcons:"tam-menu--has-icons",Breadcrumb:"tam-breadcrumb",CheckboxIcons:"tam-checkbox__icons",CheckboxIconChecked:"tam-checkbox-icon__checked",CheckboxIconUnchecked:"tam-checkbox-icon__unchecked",AssetsHeaderTh:"tam-assets-header-th",AssetsHeaderButton:"tam-assets-header__button",DialogTitle:"tam-dialog__title",Button:"tam-button",ButtonIcon:"tam-button--icon",ButtonNaked:"tam-button--naked",DialogBody:"tam-dialog__body",ButtonSecondary:"tam-button--secondary",DialogFooter:"tam-dialog__footer",Dialog:"tam-dialog",DialogDialog:"tam-dialog__dialog",DialogHeader:"tam-dialog__header",DialogBackdrop:"tam-dialog__backdrop",Form:"tam-form",FormGroup:"tam-form-group",InputLabel:"tam-input-label",InputField:"tam-input-field",InputMsgError:"tam-input-msg--error",MenuSeparator:"tam-menu__separator",AssetActionMore:"tam-asset__action-more",Assets:"tam-assets",AssetsHidden:"tam-assets--hidden",AssetsContainer:"tam-assets-container",Grid:"tam-grid",List:"tam-list",Asset:"tam-asset",AssetBack:"tam-asset--back",AssetIconContainer:"tam-asset__icon-container",AssetMetadata:"tam-asset__metadata",AssetName:"tam-asset__name",AssetSize:"tam-asset__size",AssetDate:"tam-asset__date",AssetsHeaderButtonArrowDesc:"tam-assets-header__button-arrow-desc",AssetsHeaderThName:"tam-assets-header-th-name",AssetActionSelect:"tam-asset__action-select",AssetsHeader:"tam-assets-header",AssetThumbnailContainer:"tam-asset__thumbnail-container",Star:"tam-star",AssetActions:"tam-asset__actions",AssetActionPrimary:"tam-asset__action-primary",AssetFolder:"tam-asset--folder",AssetFile:"tam-asset--file",AssetSelected:"tam-asset--selected",Icon:"tam-icon",AssetIcon:"tam-asset__icon",AssetsHeaderButtonChevron:"tam-assets-header__button-chevron",AssetmanagerContainer:"tam-assetmanager-container",Assetmanager:"tam-assetmanager",AssetmanagerOpen:"tam-assetmanager-open",AssetmanagerHasToolbar:"tam-assetmanager-has-toolbar",MenuItem:"tam-menu__item",MenuSelected:"tam-menu--selected",MenuItemUnselected:"tam-menu--",MenuBackground:"tam-menu__background",MenuContainer:"tam-menu-container",MenuBackdrop:"tam-menu__backdrop",NavbarToolbarButton:"tam-navbar__toolbar-button",NavbarMainMode:"tam-navbar--main-mode",NavbarCopyMode:"tam-navbar--copy-mode",NavbarMoveMode:"tam-navbar--move-mode",NavbarSelectMode:"tam-navbar--select-mode",BreadcrumbSeparator:"tam-breadcrumb__separator",NavbarNavFilename:"tam-navbar-nav__filename",NavbarActions:"tam-navbar__actions",NavbarToolbar:"tam-navbar__toolbar",ButtonPrimary:"tam-button--primary",NavbarNav:"tam-navbar-nav",NavbarNavBack:"tam-navbar-nav__back",Navbar:"tam-navbar",Status:"tam-status",StatusError:"tam-status--error",StatusDismiss:"tam-status__dismiss",Notifications:"tam-notifications",PreviewContainer:"tam-preview-container",Preview:"tam-preview",PreviewImage:"tam-preview__image",PreviewIcon:"tam-preview__icon",PreviewVideo:"tam-preview__video",PreviewControls:"tam-preview-controls",PreviewControl:"tam-preview-controls__control",PdfViewer:"tam-pdf-viewer",PdfViewerCanvasContainer:"tam-pdf-viewer__canvas-container",PdfViewerCanvas:"tam-pdf-viewer__canvas",MenuItemSelected:"tam-menu__item--selected",MenuAccessory:"tam-menu__accessory",StaticValue:"tam-static-value",Details:"tam-details",Progressbar:"tam-progressbar",ProgressbarProgress:"tam-progressbar__progress",AssetmanagerBody:"tam-assetmanager-body",SearchExpanded:"tam-search--expanded",InputFieldSearchExpanded:"tam-input-field--search-expanded",InputFieldSearch:"tam-input-field--search",Search:"tam-search",SearchIcon:"tam-search__icon",SearchErrorMsg:"tam-search__error-msg",UploadDone:"tam-upload--done",UploadUploading:"tam-upload--uploading",UploadIdle:"tam-upload--idle",UploadLabel:"tam-upload__label",UploadIcon:"tam-upload__icon",Upload:"tam-upload",DropArea:"tam-droparea",DropAreaIcon:"tam-droparea__icon",DropAreaLabel:"tam-droparea__label",DropAreaShim:"tam-droparea__shim",InfiniteLoadingIndicator:"tam-assets__infinite-loading-indicator",Spinner:"tam-spinner",FocusStop:"tam-focus-stop",Wrap:"tam"},wm='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 11h6a1 1 0 0 1 0 2h-6v6a1 1 0 0 1-2 0v-6H5a1 1 0 0 1 0-2h6V5a1 1 0 0 1 2 0v6z"/></svg>',xm='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 6h-8l-2-2H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-2 8h-2v2a1 1 0 0 1-2 0v-2h-2a1 1 0 0 1 0-2h2v-2a1 1 0 0 1 2 0v2h2a1 1 0 0 1 0 2z"/></svg>',Sm='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 10.12V16a1 1 0 0 1-2 0v-5.88l-1.91 1.91a.75.75 0 0 1-1.06-1.06L12 7l3.97 3.97a.75.75 0 0 1-1.06 1.06L13 10.12z"/></svg>',Om='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><g id="asset-file-archive" fill="none" fill-rule="evenodd" stroke="none" stroke-width="1"><path id="Rectangle-5-Copy" fill="#000" fill-opacity=".2" d="M8,6 L37.4361148,6 C38.3276335,6 38.6509198,6.09282561 38.9768457,6.2671327 C39.3027716,6.4414398 39.5585602,6.69722837 39.7328673,7.0231543 C39.9071744,7.34908022 40,7.67236646 40,8.5638852 L40,31.4361148 C40,32.3276335 39.9071744,32.6509198 39.7328673,32.9768457 C39.5585602,33.3027716 39.3027716,33.5585602 38.9768457,33.7328673 C38.6509198,33.9071744 38.3276335,34 37.4361148,34 L2.5638852,34 C1.67236646,34 1.34908022,33.9071744 1.0231543,33.7328673 C0.697228371,33.5585602 0.441439796,33.3027716 0.267132704,32.9768457 C0.0928256111,32.6509198 4.01235366e-17,32.3276335 -6.90560205e-17,31.4361148 L0,14 L8,6 Z" transform="rotate(90 20 20)"/><path id="Rectangle-5-Copy-2" fill="#000" fill-opacity=".2" d="M28.5638852,-1.03584031e-16 L34,0 L26,8 L26,2.5638852 C26,1.67236646 26.0928256,1.34908022 26.2671327,1.0231543 C26.4414398,0.697228371 26.6972284,0.441439796 27.0231543,0.267132704 C27.3490802,0.0928256111 27.6723665,6.01853049e-17 28.5638852,-1.03584031e-16 Z" transform="rotate(-90 30 4)"/><path id="Path-3" fill="#000" d="M11,2 L10.2828427,7.02010101 C10.1473627,7.9684608 10.806332,8.84708652 11.7546918,8.98256648 C11.8359458,8.99417419 11.9179211,9 12,9 L12,9 C12.957988,9 13.7345908,8.22339724 13.7345908,7.2654092 C13.7345908,7.18333032 13.728765,7.10135495 13.7171573,7.02010101 L13,2 L11,2 Z" opacity=".2"/><rect id="Rectangle" width="2" height="3" x="10" y="10" fill="#000" opacity=".2"/><rect id="Rectangle-Copy" width="2" height="3" x="12" y="13" fill="#000" opacity=".2"/><rect id="Rectangle-Copy-2" width="2" height="3" x="10" y="16" fill="#000" opacity=".2"/><rect id="Rectangle-Copy-3" width="2" height="3" x="12" y="19" fill="#000" opacity=".2"/><rect id="Rectangle-Copy-4" width="2" height="3" x="10" y="22" fill="#000" opacity=".2"/></g></svg>',km='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><g id="asset-file-audio" fill="none" fill-opacity=".2" fill-rule="evenodd" stroke="none" stroke-width="1"><path id="Rectangle-5-Copy" fill="#000" d="M8,6 L37.4361148,6 C38.3276335,6 38.6509198,6.09282561 38.9768457,6.2671327 C39.3027716,6.4414398 39.5585602,6.69722837 39.7328673,7.0231543 C39.9071744,7.34908022 40,7.67236646 40,8.5638852 L40,31.4361148 C40,32.3276335 39.9071744,32.6509198 39.7328673,32.9768457 C39.5585602,33.3027716 39.3027716,33.5585602 38.9768457,33.7328673 C38.6509198,33.9071744 38.3276335,34 37.4361148,34 L2.5638852,34 C1.67236646,34 1.34908022,33.9071744 1.0231543,33.7328673 C0.697228371,33.5585602 0.441439796,33.3027716 0.267132704,32.9768457 C0.0928256111,32.6509198 4.01235366e-17,32.3276335 -6.90560205e-17,31.4361148 L0,14 L8,6 Z" transform="rotate(90 20 20)"/><path id="Combined-Shape" fill="#000" d="M17,17.7 L17,25 L17,27.5 C17,28.8807119 15.8807119,30 14.5,30 C13.1192881,30 12,28.8807119 12,27.5 C12,26.1192881 13.1192881,25 14.5,25 L16,25 L16,16 L16,13 L26,10 L26,13 L26,23 L26,25.5 C26,26.8807119 24.8807119,28 23.5,28 C22.1192881,28 21,26.8807119 21,25.5 C21,24.1192881 22.1192881,23 23.5,23 L25,23 L25,15.3 L17,17.7 Z"/><path id="Rectangle-5-Copy-2" fill="#000" d="M28.5638852,-1.03584031e-16 L34,0 L26,8 L26,2.5638852 C26,1.67236646 26.0928256,1.34908022 26.2671327,1.0231543 C26.4414398,0.697228371 26.6972284,0.441439796 27.0231543,0.267132704 C27.3490802,0.0928256111 27.6723665,6.01853049e-17 28.5638852,-1.03584031e-16 Z" transform="rotate(-90 30 4)"/></g></svg>',Cm='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><g id="asset-file-video" fill="none" fill-opacity=".2" fill-rule="evenodd" stroke="none" stroke-width="1"><path id="Rectangle-5-Copy" fill="#000" d="M8,6 L37.4361148,6 C38.3276335,6 38.6509198,6.09282561 38.9768457,6.2671327 C39.3027716,6.4414398 39.5585602,6.69722837 39.7328673,7.0231543 C39.9071744,7.34908022 40,7.67236646 40,8.5638852 L40,31.4361148 C40,32.3276335 39.9071744,32.6509198 39.7328673,32.9768457 C39.5585602,33.3027716 39.3027716,33.5585602 38.9768457,33.7328673 C38.6509198,33.9071744 38.3276335,34 37.4361148,34 L2.5638852,34 C1.67236646,34 1.34908022,33.9071744 1.0231543,33.7328673 C0.697228371,33.5585602 0.441439796,33.3027716 0.267132704,32.9768457 C0.0928256111,32.6509198 4.01235366e-17,32.3276335 -6.90560205e-17,31.4361148 L0,14 L8,6 Z" transform="rotate(90 20 20)"/><path id="Rectangle-5-Copy-2" fill="#000" d="M28.5638852,-1.03584031e-16 L34,0 L26,8 L26,2.5638852 C26,1.67236646 26.0928256,1.34908022 26.2671327,1.0231543 C26.4414398,0.697228371 26.6972284,0.441439796 27.0231543,0.267132704 C27.3490802,0.0928256111 27.6723665,6.01853049e-17 28.5638852,-1.03584031e-16 Z" transform="rotate(-90 30 4)"/><path id="Path" fill="#000" d="M24,19 L28,15 L28,25 L24,21 L24,24 C24,24.5522847 23.5522847,25 23,25 L13,25 C12.4477153,25 12,24.5522847 12,24 L12,16 C12,15.4477153 12.4477153,15 13,15 L23,15 C23.5522847,15 24,15.4477153 24,16 L24,19 Z"/></g></svg>',Lm='<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><g><path d="M34.872 9h-16.49l-.94-1.88c-.436-.872-.634-1.17-.918-1.447a2.115 2.115 0 0 0-.807-.5c-.376-.13-.73-.173-1.705-.173H3.908c-.688 0-1.214.118-1.646.35a2.18 2.18 0 0 0-.913.912C1.12 6.694 1 7.22 1 7.908v22.964c0 1.475.108 2.034.416 2.61.255.478.624.847 1.102 1.102.576.308 1.135.416 2.61.416h29.744c1.475 0 2.034-.108 2.61-.416a2.635 2.635 0 0 0 1.102-1.102c.308-.576.416-1.135.416-2.61V13.128c0-1.475-.108-2.034-.416-2.61a2.635 2.635 0 0 0-1.102-1.102C36.906 9.108 36.347 9 34.872 9zM19 8h15.872c1.783 0 2.43.186 3.082.534.652.349 1.163.86 1.512 1.512.348.652.534 1.299.534 3.082v17.744c0 1.783-.186 2.43-.534 3.082a3.635 3.635 0 0 1-1.512 1.512c-.652.348-1.299.534-3.082.534H5.128c-1.783 0-2.43-.186-3.082-.534a3.635 3.635 0 0 1-1.512-1.512C.186 33.302 0 32.655 0 30.872V7.908c0-.866.162-1.547.467-2.117a3.18 3.18 0 0 1 1.324-1.324C2.36 4.162 3.042 4 3.908 4h10.104c1.163 0 1.582.073 2.032.229.45.156.838.395 1.179.728.34.333.593.675 1.113 1.716L19 8z"/><path d="M22.293 19.707l-.005.005a1 1 0 0 1-1.415-.001L18 16.83V26h9a1 1 0 0 1 0 2H16V16.83l-2.873 2.88a1 1 0 0 1-1.415.002l-.005-.005a1 1 0 0 1 0-1.414L17 13l5.293 5.293a1 1 0 0 1 0 1.414z"/></g></svg>',Fm='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 11H7.83l4.882-4.882a.997.997 0 0 0-.002-1.413l-.003-.003a1 1 0 0 0-1.412.003L4 12l7.295 7.295a.998.998 0 0 0 1.41-1.41L7.83 13H19a1 1 0 0 0 0-2z"/></svg>',Tm='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.168 5.445a1 1 0 0 1 1.664 1.11l-8 12a1 1 0 0 1-1.536.156L5.3 13.762a1 1 0 1 1 1.407-1.42l4.135 4.093 7.327-10.99z"/></svg>',Dm='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.667 9.217a.773.773 0 0 1 1.1.02c.303.313.311.818.02 1.141L12.56 14.76c-.31.32-.81.32-1.12 0l-4.227-4.382a.843.843 0 0 1 .02-1.14.773.773 0 0 1 1.1-.02l3.667 3.8 3.667-3.8z"/></svg>',Bm='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10.218 8.335a.773.773 0 0 1 .02-1.1.843.843 0 0 1 1.142-.02l4.382 4.227c.32.31.32.81 0 1.12L11.38 16.79a.843.843 0 0 1-1.141-.02.773.773 0 0 1-.02-1.1l3.8-3.667-3.8-3.667z"/></svg>',Mm='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17.251 8.157L13.421 12l3.83 3.843a.996.996 0 0 1-1.408 1.408L12 13.421l-3.843 3.83a.996.996 0 0 1-1.408-1.408L10.579 12l-3.83-3.843A.996.996 0 0 1 8.157 6.75L12 10.579l3.843-3.83a.996.996 0 0 1 1.408 1.408z" fill-rule="evenodd"/></svg>',Im='<svg viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .86-2 1.91v13.176h2V2.91h12V1zm3 3.818c1.1 0 2 .86 2 1.91V20.09C21 21.14 20.1 22 19 22H8c-1.1 0-2-.86-2-1.91V6.728c0-1.05.9-1.909 2-1.909h11zm0 15.273V6.727H8v13.364h11z" fill-rule="nonzero"/></svg>',_m='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6h3a1 1 0 0 1 0 2h-1v11a3 3 0 0 1-3 3H8a3 3 0 0 1-3-3V8H4a1 1 0 1 1 0-2h3V5a3 3 0 0 1 3-3h4a3 3 0 0 1 3 3v1zm-2 0V5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v1h6zm2 2H7v11a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V8zm-8 3a1 1 0 0 1 2 0v6a1 1 0 0 1-2 0v-6zm4 0a1 1 0 0 1 2 0v6a1 1 0 0 1-2 0v-6z"/></svg>',Em='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 19v-2a1 1 0 0 1 2 0v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 2 0v2h12zm-7-5.414V4a1 1 0 0 1 2 0v9.586l2.293-2.293a1 1 0 0 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4a1 1 0 0 1 1.414-1.414L11 13.586z"/></svg>',Am='<svg id="media-droparea" viewBox="0 0 48 48" width="100%" height="100%"><<path d="M38.71,24.07 C43.89,24.44 48,28.72 48,34 C48,39.52 43.52,44 38,44 L12,44 C5.37,44 0,38.63 0,32 C0,25.81 4.69,20.72 10.7,20.07 C13.21,15.28 18.22,12 24,12 C31.28,12 37.35,17.19 38.71,24.07 Z M28,30 L34,30 L24,20 L14,30 L20,30 L20,38 L28,38 L28,30 Z" id="Shape" fill-rule="nonzero"></path></svg>',zm='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g id="icon-dropbox" fill="none" fill-rule="evenodd"><path id="Shape" fill="#000" fill-rule="nonzero" d="M7,2 L1,6.10126582 L5.51415094,9.64556962 L12,5.69620253 L7,2 Z M1,13.0886076 L7.48584906,17.2405063 L12,13.5443038 L5.51415094,9.64556962 L1,13.0886076 Z M16.5660377,17.2405063 L23,13.1392405 L18.5377358,9.64556962 L12,13.5443038 L16.5660377,17.2405063 Z M23,6.10126582 L17.5660377,2 L12,5.69620253 L18.5377358,9.64556962 L23,6.10126582 Z M11.9990234,15.0235692 L7.48584906,18.7457109 L6,17.7726537 L6,19.0117846 L11.9990234,23 L17.9980469,19.0117846 L17.9980469,17.7726537 L16.5660377,18.7457109 L11.9990234,15.0235692 Z"/></g></svg>',Pm='<svg viewBox="0 0 40 40"><g fill-rule="evenodd"><path d="M34 8v29.436c0 .892-.093 1.215-.267 1.54-.174.327-.43.583-.756.757-.326.174-.65.267-1.54.267H8.563c-.892 0-1.215-.093-1.54-.267a1.817 1.817 0 0 1-.757-.756c-.174-.326-.267-.65-.267-1.54V2.563c0-.892.093-1.215.267-1.54.174-.327.43-.583.756-.757C7.35.093 7.673 0 8.563 0H26l8 8z"/><path d="M26 5.436V0l8 8h-5.436c-.892 0-1.215-.093-1.54-.267a1.817 1.817 0 0 1-.757-.756c-.174-.326-.267-.65-.267-1.54z"/></g></svg>',Nm='<svg viewBox="0 0 40 40"><g fill-rule="evenodd"><path d="M3.908 4h10.104c1.163 0 1.582.073 2.032.229.45.156.838.395 1.179.728.34.333.593.675 1.113 1.716L19 8H0v-.092c0-.866.162-1.547.467-2.117a3.18 3.18 0 0 1 1.324-1.324C2.36 4.162 3.042 4 3.908 4zM0 8h34.872c1.783 0 2.43.186 3.082.534.652.349 1.163.86 1.512 1.512.348.652.534 1.299.534 3.082v17.744c0 1.783-.186 2.43-.534 3.082a3.635 3.635 0 0 1-1.512 1.512c-.652.348-1.299.534-3.082.534H5.128c-1.783 0-2.43-.186-3.082-.534a3.635 3.635 0 0 1-1.512-1.512C.186 33.302 0 32.655 0 30.872V8z"/></g></svg>',Vm='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g id="icon-googledrive" fill="none" fill-rule="evenodd"><path id="Shape" fill="#000" fill-rule="nonzero" d="M8.42436772,2.4 L1,15.509164 L4.05322951,21.0936453 L19.2798462,21.0905636 L23,14.758396 L15.4935951,2.41891532 L8.42436772,2.4 Z M2.82415905,15.5226597 L8.89214985,4.80670827 L10.6925054,7.94983867 L4.53227583,18.6469811 L2.82415905,15.5226597 Z M11.6096856,9.55105203 L14.1393435,13.9672469 L9.06706339,13.9666093 L11.6096856,9.55105203 Z M18.3674479,19.4966826 L5.89906679,19.499233 L8.18696988,15.5604904 L20.6772417,15.5649535 L18.3674479,19.4966826 Z M15.9762544,13.9674595 L10.265423,3.99738779 L14.5958614,4.01024596 L20.6533319,13.9679908 L15.9762544,13.9674595 Z"/></g></svg>',Rm='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8 11h2a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1zm0 7h2a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1zm6 0h2a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1zm0-7h2a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1h-2a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1z"/></svg>',Hm='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g id="icon-preview-next" fill-rule="evenodd" stroke="none" stroke-width="1"><path id="Shape" fill-rule="nonzero" d="M19,11 L7.83,11 L12.7124956,6.11750442 C13.1018612,5.7281388 13.1018612,5.0968524 12.7124956,4.70748678 C12.7116652,4.70665638 12.7108333,4.70582746 12.71,4.705 L12.707098,4.7021184 C12.316175,4.31394844 11.6849363,4.3150637 11.2953874,4.70461259 L4,12 L11.295,19.295 C11.6843607,19.6843607 12.3156393,19.6843607 12.705,19.295 L12.705,19.295 C13.0944628,18.9055372 13.0947454,18.2741804 12.7056314,17.8843691 L7.83,13 L19,13 C19.5522847,13 20,12.5522847 20,12 L20,12 C20,11.4477153 19.5522847,11 19,11 Z" transform="matrix(0 -1 -1 0 24 24)"/></g></svg>',Um='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g id="icon-preview-prev" fill-rule="evenodd" stroke="none" stroke-width="1"><path id="Shape" fill-rule="nonzero" d="M19,11 L7.83,11 L12.7124956,6.11750442 C13.1018612,5.7281388 13.1018612,5.0968524 12.7124956,4.70748678 C12.7116652,4.70665638 12.7108333,4.70582746 12.71,4.705 L12.707098,4.7021184 C12.316175,4.31394844 11.6849363,4.3150637 11.2953874,4.70461259 L4,12 L11.295,19.295 C11.6843607,19.6843607 12.3156393,19.6843607 12.705,19.295 L12.705,19.295 C13.0944628,18.9055372 13.0947454,18.2741804 12.7056314,17.8843691 L7.83,13 L19,13 C19.5522847,13 20,12.5522847 20,12 L20,12 C20,11.4477153 19.5522847,11 19,11 Z" transform="rotate(90 12 12)"/></g></svg>',jm='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g id="icon-preview-print" fill-rule="evenodd" stroke="none" stroke-width="1"><path id="Shape" fill-rule="nonzero" d="M18,7 L6,7 C4.34,7 3,8.34 3,10 L3,16 L5,16 L5,19 L19,19 L19,16 L21,16 L21,10 C21,8.34 19.66,7 18,7 Z M17,17 L7,17 L7,13 L17,13 L17,17 Z M17.5,12 C16.675,12 16,11.325 16,10.5 C16,9.675 16.675,9 17.5,9 C18.325,9 19,9.675 19,10.5 C19,11.325 18.325,12 17.5,12 Z M18,4 L6,4 L6,6 L18,6 L18,4 Z"/></g></svg>',Wm='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g id="icon-preview-zoom-in"fill-rule="evenodd" stroke="none" stroke-width="1"><path id="Combined-Shape" fill-rule="nonzero" d="M11,11 L11,8 C11,7.44771525 11.4477153,7 12,7 C12.5522847,7 13,7.44771525 13,8 L13,11 L16,11 C16.5522847,11 17,11.4477153 17,12 C17,12.5522847 16.5522847,13 16,13 L13,13 L13,16 C13,16.5522847 12.5522847,17 12,17 C11.4477153,17 11,16.5522847 11,16 L11,13 L8,13 C7.44771525,13 7,12.5522847 7,12 C7,11.4477153 7.44771525,11 8,11 L11,11 Z M12,21 C7.02943725,21 3,16.9705627 3,12 C3,7.02943725 7.02943725,3 12,3 C16.9705627,3 21,7.02943725 21,12 C21,16.9705627 16.9705627,21 12,21 Z M12,19 C15.8659932,19 19,15.8659932 19,12 C19,8.13400675 15.8659932,5 12,5 C8.13400675,5 5,8.13400675 5,12 C5,15.8659932 8.13400675,19 12,19 Z"/></g></svg>',Gm='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g id="icon-preview-zoom-out" fill-rule="evenodd" stroke="none" stroke-width="1"><path id="Combined-Shape" fill-rule="nonzero" d="M12,21 C7.02943725,21 3,16.9705627 3,12 C3,7.02943725 7.02943725,3 12,3 C16.9705627,3 21,7.02943725 21,12 C21,16.9705627 16.9705627,21 12,21 Z M12,19 C15.8659932,19 19,15.8659932 19,12 C19,8.13400675 15.8659932,5 12,5 C8.13400675,5 5,8.13400675 5,12 C5,15.8659932 8.13400675,19 12,19 Z M8,13 C7.44771525,13 7,12.5522847 7,12 C7,11.4477153 7.44771525,11 8,11 L16,11 C16.5522847,11 17,11.4477153 17,12 C17,12.5522847 16.5522847,13 16,13 L8,13 Z"/></g></svg>',Km='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 13a1 1 0 0 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 0 0 0-2 1 1 0 0 0 0 2zm0-8a1 1 0 1 0 0-2 1 1 0 1 0 0 2zm4 4h12a1 1 0 0 0 0-2H8a1 1 0 0 0 0 2zm0 4h12a1 1 0 0 0 0-2H8a1 1 0 0 0 0 2zM7 8a1 1 0 0 0 1 1h12a1 1 0 0 0 0-2H8a1 1 0 0 0-1 1z"/></svg>',qm='<svg width="30" height="30" xmlns="http://www.w3.org/2000/svg"><path d="M15 23.114l8.343 5.036-2.214-9.49 7.371-6.386-9.706-.823L15 2.5l-3.793 8.95-9.707.824 7.371 6.386-2.214 9.49z"/></svg>',Zm='<svg viewBox="0 0 24 24"><path d="M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z" fill-rule="nonzero"/></svg>',Jm='<svg viewBox="0 0 24 24"><path d="M12 2.91h-2V1h2v1.91zm2 0V1h2v1.91h-2zm-6 0H6V1h2v1.91zm-4 0V3H2v-.09C2 1.86 2.9 1 4 1v1.91zM4 5v2H2V5h2zm0 4v2H2V9h2zm0 4v2.022H2V13h2zm15-8.182H8c-1.1 0-2 .86-2 1.91V20.09C6 21.14 6.9 22 8 22h11c1.1 0 2-.86 2-1.91V6.728c0-1.05-.9-1.909-2-1.909zm0 15.273H8V6.727h11v13.364z" fill-rule="nonzero"/></svg>',Ym='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.498 12.537a16.178 16.178 0 0 0 1.832 2.265C7.289 16.813 9.523 18 12 18c2.477 0 4.711-1.187 6.67-3.198A16.178 16.178 0 0 0 20.847 12a16.178 16.178 0 0 0-2.177-2.802C16.711 7.187 14.477 6 12 6 9.523 6 7.289 7.187 5.33 9.198A16.178 16.178 0 0 0 3.153 12c.095.155.21.335.345.537zm-2.385-.998c.13-.25.372-.665.724-1.19a18.159 18.159 0 0 1 2.06-2.547C6.2 5.438 8.908 4 12 4c3.092 0 5.8 1.438 8.103 3.802.79.812 1.478 1.68 2.06 2.547.352.525.594.94.724 1.19a1 1 0 0 1 0 .922c-.13.25-.372.665-.724 1.19a18.159 18.159 0 0 1-2.06 2.547C17.8 18.562 15.092 20 12 20c-3.092 0-5.8-1.438-8.103-3.802a18.159 18.159 0 0 1-2.06-2.547c-.352-.525-.594-.94-.724-1.19a1 1 0 0 1 0-.922zm12.065-3.363a2 2 0 1 0 2.646 2.646 4 4 0 1 1-2.646-2.646z"/></svg>',Xm='<svg viewBox="0 0 24 24"><path d="M12.19 3.734c.125-.292.315-.535.568-.729.253-.193.51-.322 1.256-.508L16 2v1.03l-1.744.437c-.565.14-.731.211-.89.333a.8.8 0 0 0-.259.33c-.08.185-.107.363-.107.946v13.848c0 .583.028.761.107.946a.8.8 0 0 0 .258.33c.16.122.326.192.891.333L16 20.97V22l-1.986-.497c-.747-.186-1.003-.315-1.256-.508a1.799 1.799 0 0 1-.569-.73c-.126-.292-.252-.292-.378 0a1.799 1.799 0 0 1-.57.73c-.252.193-.508.322-1.255.508L8 22v-1.03l1.744-.437c.565-.14.731-.211.89-.333a.8.8 0 0 0 .259-.33c.08-.185.107-.363.107-.946V5.076c0-.583-.028-.761-.107-.946a.8.8 0 0 0-.258-.33c-.16-.122-.326-.192-.891-.333L8 3.03V2l1.986.497c.747.186 1.003.315 1.256.508.253.194.443.437.569.73.126.292.252.292.378 0z" fill-rule="nonzero"/></svg>',$m='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.907 17.319a8 8 0 1 1 1.412-1.412c.013.011.026.023.038.036l4.35 4.35a1 1 0 0 1-1.414 1.414l-4.35-4.35a1.016 1.016 0 0 1-.036-.038zM11 17a6 6 0 1 0 0-12 6 6 0 0 0 0 12z"/></svg>',Qm='<svg width="30" height="30" xmlns="http://www.w3.org/2000/svg"><path d="M20.582 18.352h-1.174l-.417-.401a9.62 9.62 0 0 0 2.334-6.288A9.662 9.662 0 0 0 11.663 2 9.662 9.662 0 0 0 2 11.663a9.662 9.662 0 0 0 9.663 9.662 9.62 9.62 0 0 0 6.288-2.334l.401.417v1.174L25.785 28 28 25.785l-7.418-7.433zm-8.92 0a6.68 6.68 0 0 1-6.689-6.69 6.68 6.68 0 0 1 6.69-6.689 6.68 6.68 0 0 1 6.69 6.69 6.68 6.68 0 0 1-6.69 6.69z" fill-rule="nonzero"/></svg>',ep='<svg viewBox="0 0 24 24"><path d="M12 21a9 9 0 1 1 0-18 9 9 0 0 1 0 18zm-2.39-6.11L6.5 11.78l-1.06 1.06L9.61 17l8.95-8.95L17.5 7l-7.89 7.89z" fill-rule="evenodd"/></svg>',np='<svg viewBox="0 0 24 24"><path fill-rule="nonzero" d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>',tp='<svg viewBox="0 0 24 24"><path d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z" fill-rule="nonzero"/></svg>',op='<svg viewBox="0 0 24 24"><path d="M12 21a9 9 0 1 1 0-18 9 9 0 0 1 0 18zm0-1a8 8 0 1 0 0-16 8 8 0 0 0 0 16z" fill-rule="evenodd"/></svg>',rp='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 19v-2a1 1 0 0 1 2 0v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 2 0v2h12zM11 6.414L8.707 8.707a1 1 0 0 1-1.414-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 1 1-1.414 1.414L13 6.414V16a1 1 0 0 1-2 0V6.414z"/></svg>',ip=e({name:"Icon",factory:function(e){return{uid:e.uid,dom:{tag:"span",classes:[bm.Icon].concat(e.classes),innerHtml:e.iconHtml}}},configFields:[un("iconHtml"),pn("classes",[])]}),up=e({name:"FileIcon",factory:function(e){return{uid:e.uid,dom:{tag:"span",classes:[bm.AssetIcon].concat(e.classes),innerHtml:function(e){switch(e){case"directory":return Nm;case"video":return Cm;case"audio":return km;case"archive":return Om;default:return Pm}}(e.type)}}},configFields:[un("type"),pn("classes",[])]}),z=Object.freeze({__proto__:null,focus:Gl,blur:function(e,n){n.ignore||e.element.dom.blur()},isFocused:function(e){return n=e.element,e=Ci(n).dom,n.dom===e.activeElement;var n}}),_i=Object.freeze({__proto__:null,exhibit:function(e,n){n=n.ignore?{}:{attributes:{tabindex:"-1"}};return ht(n)},events:function(t){return ii([dt(Rr(),function(e,n){Gl(e,t),n.stop()})].concat(t.stopMousedown?[dt(wr(),function(e,n){n.event.prevent()})]:[]))}}),Nn=[Tn("onFocus"),pn("stopMousedown",!1),pn("ignore",!1)],ap=xt({fields:Nn,name:"focusing",active:_i,apis:z}),cp=e({name:"Button",factory:function(e){function t(n){return ae(e.dom,"attributes").bind(function(e){return ae(e,n)})}var n=Wl(e.action),o=e.dom.tag;return{uid:e.uid,dom:e.dom,components:e.components,events:n,behaviours:dc(e.buttonBehaviours,[ap.config({}),_f.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==o)return{role:t("role").getOr("button")};var e=t("type").getOr("button"),n=t("role").map(function(e){return{role:e}}).getOr({});return Gn({type:e},n)}()},eventOrder:e.eventOrder}},configFields:[pn("uid",void 0),tn("dom"),pn("components",[]),lc("buttonBehaviours",[ap,_f]),ln("action"),ln("role"),pn("eventOrder",{})]}),sp=Ki,fp=Ki,lp=e({name:"Label",factory:function(t){return t.action.fold(function(){return{uid:(e=t).uid,dom:{tag:"span",classes:e.classes},components:Zn([sp(e.text)],e.starred?[Kl()]:[]),behaviours:Fe(di([ss.config({})]),Aa(e.labelBehaviours))};var e},function(e){return n=t,e=e,cp.sketch({uid:n.uid,dom:{tag:"a",classes:[bm.AssetName,bm.FocusStop]},components:[{dom:{tag:"span"},components:Zn([sp(n.text)],n.starred?[Kl()]:[])}],buttonBehaviours:Fe(di([ss.config({})]),Aa(n.labelBehaviours)),action:e});var n})},configFields:[un("text"),gn("starred",!1,An),pn("classes",[]),Pn("action"),P("labelBehaviours",[])],apis:{setText:function(e,n,t,o){ss.set(n,Zn([sp(t)],o?[Kl()]:[]))}}}),dp=e({name:"Droparea",factory:function(e){return{uid:e.uid,dom:{tag:"div",classes:[bm.DropArea]},components:[ip.sketch({iconHtml:Am,classes:[bm.DropAreaIcon]}),lp.sketch({text:"Drop to upload here",classes:[bm.DropAreaLabel]}),{dom:{tag:"div",classes:[bm.DropAreaShim]}}]}},configFields:[]}),Vn=Object.freeze({__proto__:null,onLoad:ql,onUnload:Zl,setValue:function(e,n,t,o){n.store.manager.setValue(e,n,t,o)},getValue:function(e,n,t){return n.store.manager.getValue(e,n,t)},getState:function(e,n,t){return t}}),Nn=Object.freeze({__proto__:null,events:function(t,o){var e=t.resetOnDom?[ui(function(e,n){ql(e,t,o)}),ai(function(e,n){Zl(e,t,o)})]:[vt(t,o,ql)];return ii(e)}}),_i=function(){var e=kt(null);return Un({set:e.set,get:e.get,isNotSet:function(){return null===e.get()},clear:function(){e.set(null)},readState:function(){return{mode:"memory",value:e.get()}}})},z=function(){var i=kt({}),u=kt({});return Un({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(e){return ae(i.get(),e).orThunk(function(){return ae(u.get(),e)})},update:function(e){var n=i.get(),t=u.get(),o={},r={};k(e,function(n){o[n.value]=n,ae(n,"meta").each(function(e){ae(e,"text").each(function(e){r[e]=n})})}),i.set(Gn(Gn({},n),o)),u.set(Gn(Gn({},t),r))},clear:function(){i.set({}),u.set({})}})},Ki=Object.freeze({__proto__:null,memory:_i,dataset:z,manual:function(){return Un({readState:b})},init:function(e){return e.store.manager.state(e)}}),Pn=[ln("initialValue"),tn("getFallbackEntry"),tn("getDataKey"),tn("setValue"),ba("manager",{setValue:Jl,getValue:function(e,n,t){var o=n.store,r=o.getDataKey(e);return t.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(e){return e})},onLoad:function(n,t,o){t.store.initialValue.each(function(e){Jl(n,t,o,e)})},onUnload:function(e,n,t){t.clear()},state:z})],z=[tn("getValue"),pn("setValue",b),ln("initialValue"),ba("manager",{setValue:function(e,n,t,o){n.store.setValue(e,o),n.onSetValue(e,o)},getValue:function(e,n,t){return n.store.getValue(e)},onLoad:function(n,t,e){t.store.initialValue.each(function(e){t.store.setValue(n,e)})},onUnload:b,state:Hn.init})],_i=[ln("initialValue"),ba("manager",{setValue:function(e,n,t,o){t.set(o),n.onSetValue(e,o)},getValue:function(e,n,t){return t.get()},onLoad:function(e,n,t){n.store.initialValue.each(function(e){t.isNotSet()&&t.set(e)})},onUnload:function(e,n,t){t.clear()},state:_i})],Pn=[gn("store",{mode:"memory"},en("mode",{memory:_i,manual:z,dataset:Pn})),Tn("onSetValue"),pn("resetOnDom",!1)],mp=xt({fields:Pn,name:"representing",active:Nn,apis:Vn,extra:{setValueFrom:function(e,n){n=mp.getValue(n);mp.setValue(e,n)}},state:Ki}),Pn=Object.freeze({__proto__:null,exhibit:function(e,n){return ht({attributes:ze([{key:n.tabAttr,value:"true"}])})}}),Nn=[pn("tabAttr","data-alloy-tabstop")],pp=xt({fields:Nn,name:"tabstopping",active:Pn}),Vn=Object.freeze({__proto__:null,events:function(n,t){return ii([ui(function(e){return function(t,e,n){e=O(e.events,function(n){return Ho(t.element,n.native,function(e){t.getSystem().triggerEvent(n.simulated,t.element,e)})});n.set(e)}(e,n,t)}),ai(function(){k(t.get(),function(e){e.unbind()})})])}}),Ki=[(Zd="events",Jd=kn([un("native"),un("simulated")]),Fn(Zd,Zd,Be(),Ke(Jd)))],gp=xt({fields:Ki,name:"allowbubbling",active:Vn,state:Ie([])}),hp=function(t){return function(n,e){L(e().fileState.files,function(e){return e.uuid===t}).each(function(e){n({type:"selectedFiles.select",payload:{file:e}})})}},vp=function(t){return function(n,e){L(e().fileState.files,function(e){return e.uuid===t}).each(function(e){n({type:"selectedFiles.unselect",payload:{uuid:e.uuid}})})}},yp=function(){return function(e,n){e({type:"selectedFiles.selectAll",payload:{files:n().fileState.files}})}},bp=Yt("backitem"),Nn=Object.freeze({__proto__:null,getCurrent:function(e,n,t){return n.find(e)}}),Pn=[tn("find")],wp=xt({fields:Pn,name:"composing",apis:Nn}),Ki=w([pn("prefix","form-field"),P("fieldBehaviours",[wp,mp])]),Vn=w([Nu({schema:[tn("dom")],name:"label"}),Nu({factory:{sketch:function(e){return{uid:e.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:e.text}}}},schema:[tn("text")],name:"aria-descriptor"}),ic({factory:{sketch:function(e){var n=Ae(e,["factory"]);return e.factory.sketch(n)}},schema:[tn("factory")],name:"field"})]),xp=A({name:"FormField",configFields:Ki(),partFields:Vn(),factory:function(a,e,n,t){var o=za(a.fieldBehaviours,[wp.config({find:function(e){return Da(e,a,"field")}}),mp.config({store:{mode:"manual",getValue:function(e){return wp.getCurrent(e).bind(mp.getValue)},setValue:function(e,n){wp.getCurrent(e).each(function(e){mp.setValue(e,n)})}}})]),r=ii([ui(function(e,n){var t,o,r,i,u=(t=e,e=["label","field","aria-descriptor"],o={},r=a.partUids,i=t.getSystem(),k(e,function(e){o[e]=w(i.getByUid(r[e]))}),o);u.field().each(function(t){var n=Yt(a.prefix);u.label().each(function(e){Ut(e.element,"for",n),Ut(t.element,"id",n)}),u["aria-descriptor"]().each(function(e){var n=Yt(a.prefix);Ut(e.element,"id",n),Ut(t.element,"aria-describedby",n)})})})]);return{uid:a.uid,dom:a.dom,components:e,behaviours:o,events:r,apis:{getField:function(e){return Da(e,a,"field")},getLabel:function(e){return Da(e,a,"label")}}}},apis:{getField:function(e,n){return e.getField(n)},getLabel:function(e,n){return e.getLabel(n)}}}),Ie=w([ln("data"),pn("inputAttributes",{}),pn("inputStyles",{}),pn("tag","input"),pn("inputClasses",[]),Tn("onSetValue"),pn("styles",{}),pn("eventOrder",{}),P("inputBehaviours",[mp,ap]),pn("selectOnFocus",!0)]),Sp=e({name:"Input",configFields:Ie(),factory:function(e,n){return{uid:e.uid,dom:{tag:(t=e).tag,attributes:Gn({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses},components:[],behaviours:Ql(e),eventOrder:e.eventOrder};var t}}),Op=e({name:"Checkbox",factory:function(t){return xp.sketch({dom:{tag:"label",classes:[bm.Checkbox].concat(t.classes)},components:[xp.parts.field({factory:{sketch:Sp.sketch},inputAttributes:{type:"checkbox"},inputClasses:[bm.Checkbox__Input]}),xp.parts.label(cp.sketch({dom:{tag:"div",classes:[bm.CheckboxIcons,bm.FocusStop]},components:[ip.sketch({iconHtml:t.checkedIcon,classes:[bm.CheckboxIconChecked]}),ip.sketch({iconHtml:t.uncheckedIcon,classes:[bm.CheckboxIconUnchecked]})]}))],fieldBehaviours:di([ap.config({ignore:!0}),Ot("field-behaviours",[dt(Br(),function(e,n){n.stop()}),si(function(n,e){xp.getField(n).each(function(e){!function(e,n){e=e.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)}(e.element,"checked")?Ut(e.element,"checked","checked"):Kt(e.element,"checked"),t.onCheckedChange(n)})})])])})},configFields:[pn("classes",[]),un("checkedIcon"),un("uncheckedIcon"),cn("onCheckedChange")]}),kp=Nr("width",function(e){return e.dom.offsetWidth}),Cp=function(n,e){return td(e,function(e){return tt(e,n.element)},s)||od(n,e)},Pn=Object.freeze({__proto__:null,getCoupled:function(e,n,t,o){return t.getOrCreate(e,n,o)}}),Nn=[on("others",Dn($.value,Mn()))],Lp=xt({fields:Nn,name:"coupling",apis:Pn,state:Object.freeze({__proto__:null,init:function(){var r={},e=w({});return Un({readState:e,getOrCreate:function(n,t,o){var e=we(t.others);if(e)return ae(r,o).getOrThunk(function(){var e=ae(t.others,o).getOrDie("No information found for coupled component: "+o)(n),e=n.getSystem().build(e);return r[o]=e});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(e,null,2))}})}})}),Ki=Object.freeze({__proto__:null,exhibit:function(e,n){return ht({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Fp=function(t,o){return{left:t,top:o,translate:function(e,n){return Fp(t+e,o+n)}}},Tp=Fp,Dp=function(e){var n=e.dom,t=n.ownerDocument.body;return t===n?Tp(t.offsetLeft,t.offsetTop):ji(e)?function(e){e=e.getBoundingClientRect();return Tp(e.left,e.top)}(n):Tp(0,0)},Bp=function(t,e){return t.view(e).fold(w([]),function(e){var n=t.owner(e),n=Bp(t,n);return[e].concat(n)})},Mp=Object.freeze({__proto__:null,view:function(e){return(e.dom===document?E.none():E.from(null===(e=e.dom.defaultView)||void 0===e?void 0:e.frameElement)).map(Wn.fromDom)},owner:Lt}),Vn=ke([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Ip=Vn.southeast,_p=Vn.southwest,Ep=Vn.northeast,Ap=Vn.northwest,zp=Vn.south,Pp=Vn.north,Np=Vn.east,Vp=Vn.west,Ie=ke([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Rp=function(e,n,t){var o=Tp(n,t);return e.fold(w(o),w(o),function(){var e=ud();return o.translate(-e.left,-e.top)})},Hp=Ie.relative,Up=Ie.fixed,jp=ke([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Wp=w(function(e,n){Od(e,n),Lo(e,{"overflow-x":"hidden","overflow-y":"auto"})}),Gp=function(e,n,t,o){var r=xd(e,n,t,o);Sd(n,r,o),function(e,n){n=n.classes;wo(e,n.off),bo(e,n.on)}(n,r),e=n,t=r,(0,o.maxHeightFunction)(e,t.maxHeight),n=n,r=r,(0,o.maxWidthFunction)(n,r.maxWidth)},Kp=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"];(Nr=Yd=Yd||{}).TopToBottom="toptobottom",Nr.BottomToTop="bottomtotop";function qp(e){return td(e,function(e){return yi(e)&&Wt(e,"data-alloy-vertical-dir")===Yd.BottomToTop})}function Zp(n,e,t,o,r,i,u){var a=u.map(qp).getOr(!1),c=e.layouts.map(function(e){return e.onLtr(n)}),u=e.layouts.map(function(e){return e.onRtl(n)}),t=a?e.layouts.bind(function(e){return e.onBottomLtr.map(function(e){return e(n)})}).or(c).getOr(r):c.getOr(t),o=a?e.layouts.bind(function(e){return e.onBottomRtl.map(function(e){return e(n)})}).or(u).getOr(i):u.getOr(o);return Es(t,o)(n)}function Jp(e){return e.fold(l,function(e,n,t){return e.translate(-n,-t)})}function Yp(e){return e.fold(l,l)}function Xp(e){return p(e,function(e,n){return e.translate(n.left,n.top)},Tp(0,0))}function $p(e){return e=O(e,Yp),Xp(e)}function Qp(e,n,t){var o=Lt(e.element),o=ud(o),t=function(t,e){e=Tt(e.root).dom;return E.from(e.frameElement).map(Wn.fromDom).filter(function(e){var n=Lt(e),e=Lt(t.element);return tt(n,e)}).map(id)}(e,t).getOr(o);return Ng(t,o.left,o.top)}function eg(e,n,t,o){var r=e,i=n,u=t,a=o;return e<0&&(r=0,u=t+e),n<0&&(i=0,a=o+n),i=Pg(Tp(r,i)),E.some({point:i,width:u,height:a})}function ng(e,i,u,a,c){return e.map(function(e){var n,t=[i,e.point],o=(n=function(){return $p(t)},o=function(){return $p(t)},r=function(){return function(e){e=O(e,Jp);return Xp(e)}(t)},a.fold(n,o,r)),r={x:o.left,y:o.top,width:e.width,height:e.height},o=(u.showAbove?Wd:Kd)(),e=(u.showAbove?Gd:qd)(),e=Zp(c,u,o,e,o,e,E.none());return{anchorBox:r,bubble:u.bubble.getOr(Fd()),overrides:u.overrides,layouts:e,placer:E.none()}})}function tg(e,n,t){var o,r,e=e.document.createRange();return o=e,n.fold(function(e){o.setStartBefore(e.dom)},function(e,n){o.setStart(e.dom,n)},function(e){o.setStartAfter(e.dom)}),r=e,t.fold(function(e){r.setEndBefore(e.dom)},function(e,n){r.setEnd(e.dom,n)},function(e){r.setEndAfter(e.dom)}),e}function og(e,n,t,o,r){return(e=e.document.createRange()).setStart(n.dom,t),e.setEnd(o.dom,r),e}function rg(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function ig(e,n,t){return n(Wn.fromDom(t.startContainer),t.startOffset,Wn.fromDom(t.endContainer),t.endOffset)}function ug(e,n){var r,t,n=(r=e,n.match({domRange:function(e){return{ltr:w(e),rtl:E.none}},relative:function(e,n){return{ltr:se(function(){return tg(r,e,n)}),rtl:se(function(){return E.some(tg(r,n,e))})}},exact:function(e,n,t,o){return{ltr:se(function(){return og(r,e,n,t,o)}),rtl:se(function(){return E.some(og(r,t,o,e,n))})}}}));return(t=(n=n).ltr()).collapsed?n.rtl().filter(function(e){return!1===e.collapsed}).map(function(e){return jg.rtl(Wn.fromDom(e.endContainer),e.endOffset,Wn.fromDom(e.startContainer),e.startOffset)}).getOrThunk(function(){return ig(0,jg.ltr,t)}):ig(0,jg.ltr,t)}function ag(e,n,t,o){var r,i,u,a,c=(i=n,u=t,a=o,(c=Lt(r=e).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),o=tt(e,t)&&n===o;return c.collapsed&&!o}function cg(e){if(0<e.rangeCount){var n=e.getRangeAt(0),e=e.getRangeAt(e.rangeCount-1);return E.some(Vg(Wn.fromDom(n.startContainer),n.startOffset,Wn.fromDom(e.endContainer),e.endOffset))}return E.none()}function sg(e){if(null===e.anchorNode||null===e.focusNode)return cg(e);var n=Wn.fromDom(e.anchorNode),t=Wn.fromDom(e.focusNode);return ag(n,e.anchorOffset,t,e.focusOffset)?E.some(Vg(n,e.anchorOffset,t,e.focusOffset)):cg(e)}function fg(e){return e=e,E.from(e.getSelection()).filter(function(e){return 0<e.rangeCount}).bind(sg)}function lg(e,n){var i,e=ug(i=e,n).match({ltr:function(e,n,t,o){var r=i.document.createRange();return r.setStart(e.dom,n),r.setEnd(t.dom,o),r},rtl:function(e,n,t,o){var r=i.document.createRange();return r.setStart(t.dom,o),r.setEnd(e.dom,n),r}});return 0<(n=0<(e=(n=e).getClientRects()).length?e[0]:n.getBoundingClientRect()).width||0<n.height?E.some(n).map(rg):E.none()}function dg(e,n){return{element:e,offset:n}}function mg(e,n){if(0===(t=Mt(e)).length)return dg(e,n);if(n<t.length)return dg(t[n],0);var t=t[t.length-1],o=bi(t)?(o=t,Wg.get(o).length):Mt(t).length;return dg(t,o)}function pg(e,n){return(bi(e)?dg:mg)(e,n)}function gg(e,n){return n.getSelection.getOrThunk(function(){return function(){return fg(e)}})().map(function(e){var n=pg(e.start,e.soffset),e=pg(e.finish,e.foffset);return Ug.range(n.element,n.offset,e.element,e.offset)})}function hg(e){return e.x+e.width}function vg(e,n){return e.x-n.width}function yg(e,n){return e.y-n.height+e.height}function bg(e,n,t){return Td(hg(e),e.y,t.southeast(),Ip(),vd(e,{left:0,top:2}),"link-layout-se")}function wg(e,n,t){return Td(vg(e,n),e.y,t.southwest(),_p(),vd(e,{right:1,top:2}),"link-layout-sw")}function xg(e,n,t){return Td(hg(e),yg(e,n),t.northeast(),Ep(),vd(e,{left:0,bottom:3}),"link-layout-ne")}function Sg(e,n,t){return Td(vg(e,n),yg(e,n),t.northwest(),Ap(),vd(e,{right:1,bottom:3}),"link-layout-nw")}function Og(){return[bg,wg,xg,Sg]}function kg(){return[wg,bg,Sg,xg]}function Cg(e,n,t,o,r){n={anchorBox:t.anchorBox,origin:n},Cd(n,r.element,t.bubble,t.layouts,o,t.overrides)}function Lg(n,e,t,o){return t.get().each(function(e){Ua(n)}),e=e.getAttachPoint(n),Va(e,n),o=n.getSystem().build(o),Va(n,o),t.set(o),o}function Fg(e,n,t,o){return o=Lg(e,n,t,o),n.onOpen(e,o),o}function Tg(n,t,o){o.get().each(function(e){Ua(n),Ha(n),t.onClose(n,e),o.clear()})}function Dg(e,n,t){return t.isOpen()}function Bg(e){(Ka(e.element).isNone()||ap.isFocused(e))&&(ap.isFocused(e)||ap.focus(e),st(e,$g,{item:e}))}function Mg(e){st(e,Qg,{item:e})}function Ig(e,n){var t={};te(e,function(e,n){k(e,function(e){t[e]=n})});var o=n,r=Se(n,function(e,n){return{k:e,v:n}}),i=oe(r,function(e,n){return[n].concat(ah(t,o,r,n))});return oe(t,function(e){return ae(i,e).getOr([e])})}var _g,Eg,Ag,zg,Dn=function(){return mn("layouts",[tn("onLtr"),tn("onRtl"),ln("onBottomLtr"),ln("onBottomRtl")])},Nn=[tn("hotspot"),ln("bubble"),pn("overrides",{}),Dn(),ba("placement",function(e,n,t){var o=n.hotspot,o=hd(t,o.element),e=Zp(e.element,n,Kd(),qd(),Wd(),Gd(),E.some(n.hotspot.element));return E.some({anchorBox:o,bubble:n.bubble.getOr(Fd()),overrides:n.overrides,layouts:e,placer:E.none()})})],Pn=[tn("x"),tn("y"),pn("height",0),pn("width",0),pn("bubble",Fd()),pn("overrides",{}),Dn(),ba("placement",function(e,n,t){t=Rp(t,n.x,n.y),t=fd(t.left,t.top,n.width,n.height),e=Zp(e.element,n,Ud(),jd(),Ud(),jd(),E.none());return E.some({anchorBox:t,bubble:n.bubble,overrides:n.overrides,layouts:e,placer:E.none()})})],Vn=ke([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Pg=Vn.screen,Ng=Vn.absolute,Ie=[tn("node"),tn("root"),ln("bubble"),Dn(),pn("overrides",{}),pn("showAbove",!1),ba("placement",function(t,o,r){var i=Qp(t,0,o);return o.node.filter(ji).bind(function(e){var n=e.dom.getBoundingClientRect(),e=eg(n.left,n.top,n.width,n.height),n=o.node.getOr(t.element);return ng(e,i,o,r,n)})})],Vg=function(e,n,t,o){return{start:e,soffset:n,finish:t,foffset:o}},Nr=ke([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Rg=(Nr.before,Nr.on,Nr.after,function(e){return e.fold(l,l,l)}),Hg=ke([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ug={domRange:Hg.domRange,relative:Hg.relative,exact:Hg.exact,exactFromRange:function(e){return Hg.exact(e.start,e.soffset,e.finish,e.foffset)},getWin:function(e){e=e.match({domRange:function(e){return Wn.fromDom(e.startContainer)},relative:function(e,n){return Rg(e)},exact:function(e,n,t,o){return e}});return Tt(e)},range:Vg},jg=ke([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Wg=(_g=bi,Eg="text",{get:function(e){if(!_g(e))throw new Error("Can only get "+Eg+" value of a "+Eg+" node");return Ag(e).getOr("")},getOption:Ag=function(e){return _g(e)?E.from(e.dom.nodeValue):E.none()},set:function(e,n){if(!_g(e))throw new Error("Can only set raw "+Eg+" value of a "+Eg+" node");e.dom.nodeValue=n}}),Vn=[ln("getSelection"),tn("root"),ln("bubble"),Dn(),pn("overrides",{}),pn("showAbove",!1),ba("placement",function(e,n,t){var o=Tt(n.root).dom,r=Qp(e,0,n),i=gg(o,n).bind(function(e){return lg(o,Ug.exactFromRange(e)).orThunk(function(){var n=Wn.fromText("\ufeff");return zt(e.start,n),lg(o,Ug.exact(n,0,n,1)).map(function(e){return Ti(n),e})}).bind(function(e){return eg(e.left,e.top,e.width,e.height)})}),e=gg(o,n).bind(function(e){return yi(e.start)?E.some(e.start):Si(e.start)}).getOr(e.element);return ng(i,r,n,t,e)})],Nr=[tn("item"),Dn(),pn("overrides",{}),ba("placement",function(e,n,t){t=hd(t,n.item.element),e=Zp(e.element,n,Og(),kg(),Og(),kg(),E.none());return E.some({anchorBox:t,bubble:Fd(),overrides:n.overrides,layouts:e,placer:E.none()})})],Gg=en("anchor",{selection:Vn,node:Ie,hotspot:Nn,submenu:Nr,makeshift:Pn}),Kg=function(e,n,t,o,r,i){i=i.map(ld);return qg(e,n,t,o,r,i)},qg=function(i,u,e,n,a,c){var s=Qe("positioning anchor.info",Gg,n);Sc(function(){Co(a.element,"position","fixed");var e=Do(a.element,"visibility");Co(a.element,"visibility","hidden");var n,t=u.useFixed()?(n=document.documentElement,Up(0,0,n.clientWidth,n.clientHeight)):(n=id((o=i).element),o=o.element.dom.getBoundingClientRect(),Hp(n.left,n.top,o.width,o.height)),o=s.placement,r=c.map(w).or(u.getBounds);o(i,s,t).each(function(e){e.placer.getOr(Cg)(i,t,e,r,a)}),e.fold(function(){Bo(a.element,"visibility")},function(e){Co(a.element,"visibility",e)}),Do(a.element,"left").isNone()&&Do(a.element,"top").isNone()&&Do(a.element,"right").isNone()&&Do(a.element,"bottom").isNone()&&Do(a.element,"position").is("fixed")&&Bo(a.element,"position")},a.element)},Nr=Object.freeze({__proto__:null,position:function(e,n,t,o,r){Kg(e,n,t,o,r,E.none())},positionWithin:Kg,positionWithinBounds:qg,getMode:function(e,n,t){return n.useFixed()?"fixed":"absolute"}}),Pn=[pn("useFixed",s),ln("getBounds")],Zg=xt({fields:Pn,name:"positioning",active:Ki,apis:Nr}),Jg=function(e,n,t){var o,r,i=n.getAttachPoint(e);Co(e.element,"position",Zg.getMode(i)),o=e,e="visibility",r=n.cloakVisibilityAttr,n="hidden",Do(o.element,e).fold(function(){Kt(o.element,r)},function(e){Ut(o.element,r,e)}),Co(o.element,e,n)},Yg=function(e,n,t){var o,r,i;o=e.element,d(["top","left","right","bottom"],function(e){return Do(o,e).isSome()})||Bo(e.element,"position"),r=e,i="visibility",n=n.cloakVisibilityAttr,Gt(r.element,n).fold(function(){return Bo(r.element,i)},function(e){return Co(r.element,i,e)})},Pn=Object.freeze({__proto__:null,cloak:Jg,decloak:Yg,open:Fg,openWhileCloaked:function(e,n,t,o,r){Jg(e,n),Fg(e,n,t,o),r(),Yg(e,n)},close:Tg,isOpen:Dg,isPartOf:function(n,t,e,o){return Dg(0,0,e)&&e.get().exists(function(e){return t.isPartOf(n,e,o)})},getState:function(e,n,t){return t.get()},setContent:function(e,n,t,o){return t.get().map(function(){return Lg(e,n,t,o)})}}),Ki=Object.freeze({__proto__:null,events:function(t,o){return ii([dt(Zr(),function(e,n){Tg(e,t,o)})])}}),Nr=[Tn("onOpen"),Tn("onClose"),tn("isPartOf"),tn("getAttachPoint"),pn("cloakVisibilityAttr","data-precloak-visibility")],Xg=xt({fields:Nr,name:"sandboxing",active:Ki,apis:Pn,state:Object.freeze({__proto__:null,init:function(){var n=kt(E.none()),e=w("not-implemented");return Un({readState:e,isOpen:function(){return n.get().isSome()},clear:function(){n.set(E.none())},set:function(e){n.set(E.some(e))},get:function(){return n.get()}})}})}),$g="alloy.item-hover",Qg="alloy.item-focus",eh=w($g),nh=w(Qg),Nr=[tn("data"),tn("components"),tn("dom"),pn("hasSubmenu",!1),ln("toggling"),lc("itemBehaviours",[ds,ap,_f,mp]),pn("ignoreFocus",!1),pn("domModification",{}),ba("builder",function(e){return{dom:e.dom,domModification:Gn(Gn({},e.domModification),{attributes:Gn(Gn(Gn({role:e.toggling.isSome()?"menuitemcheckbox":"menuitem"},e.domModification.attributes),{"aria-haspopup":e.hasSubmenu}),e.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:dc(e.itemBehaviours,[e.toggling.fold(ds.revoke,function(e){return ds.config(Gn({aria:{mode:"checked"}},e))}),ap.config({ignore:e.ignoreFocus,stopMousedown:e.ignoreFocus,onFocus:function(e){Mg(e)}}),_f.config({mode:"execution"}),mp.config({store:{mode:"memory",initialValue:e.data}}),Ot("item-type-events",qn(jl(),[dt(kr(),Bg),dt(Gr(),ap.focus)]))]),components:e.components,eventOrder:e.eventOrder}}),pn("eventOrder",{})],Ki=[tn("dom"),tn("components"),ba("builder",function(e){return{dom:e.dom,components:e.components,events:ii([(e=Gr(),dt(e,function(e,n){n.stop()}))])}})],th=w("item-widget"),oh=w([ic({name:"widget",overrides:function(n){return{behaviours:di([mp.config({store:{mode:"manual",getValue:function(e){return n.data},setValue:b}})])}}})]),Pn=[tn("uid"),tn("data"),tn("components"),tn("dom"),pn("autofocus",!1),pn("ignoreFocus",!1),lc("widgetBehaviours",[mp,ap,_f]),pn("domModification",{}),Ia(oh()),ba("builder",function(t){function o(e){return Da(e,t,"widget").map(function(e){return _f.focusIn(e),e})}var e=Fa(th(),t,oh()),n=Ta(th(),t,e.internals()),e=function(e,n){return Ms(n.event.target)||t.autofocus&&n.setSource(e.element),E.none()};return{dom:t.dom,components:n,domModification:t.domModification,events:ii([si(function(e,n){o(e).each(function(e){n.stop()})}),dt(kr(),Bg),dt(Gr(),function(e,n){t.autofocus?o(e):ap.focus(e)})]),behaviours:dc(t.widgetBehaviours,[mp.config({store:{mode:"memory",initialValue:t.data}}),ap.config({ignore:t.ignoreFocus,onFocus:function(e){Mg(e)}}),_f.config({mode:"special",focusIn:t.autofocus?function(e){o(e)}:gi(),onLeft:e,onRight:e,onEscape:function(e,n){return ap.isFocused(e)||t.autofocus?(t.autofocus&&n.setSource(e.element),E.none()):(ap.focus(e),E.some(!0))}})])}})],rh=en("type",{widget:Pn,item:Nr,separator:Ki}),ea=w([ea({factory:{sketch:function(e){e=Qe("menu.spec item",rh,e);return e.builder(e)}},name:"items",unit:"item",defaults:function(e,n){return n.hasOwnProperty("uid")?n:Gn(Gn({},n),{uid:Pi("item")})},overrides:function(e,n){return{type:n.type,ignoreFocus:e.fakeFocus,domModification:{classes:[e.markers.item]}}}})]),er=w([tn("value"),tn("items"),tn("dom"),tn("components"),pn("eventOrder",{}),P("menuBehaviours",[Ds,mp,wp,_f]),gn("movement",{mode:"menu",moveOnTab:!0},en("mode",{grid:[er(),ba("config",function(e,n){return{mode:"flatgrid",selector:"."+e.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:e.focusManager}})],matrix:[ba("config",function(e,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+e.markers.item},focusManager:e.focusManager}}),tn("rowSelector")],menu:[pn("moveOnTab",!0),ba("config",function(e,n){return{mode:"menu",selector:"."+e.markers.item,moveOnTab:n.moveOnTab,focusManager:e.focusManager}})]})),on("markers",qa()),pn("fakeFocus",!1),pn("focusManager",rs()),Tn("onHighlight")]),ih=w("alloy.menu-focus"),uh=A({name:"Menu",configFields:er(),partFields:ea(),factory:function(e,n,t,o){return{uid:e.uid,dom:e.dom,markers:e.markers,behaviours:za(e.menuBehaviours,[Ds.config({highlightClass:e.markers.selectedItem,itemClass:e.markers.item,onHighlight:e.onHighlight}),mp.config({store:{mode:"memory",initialValue:e.value}}),wp.config({find:E.some}),_f.config(e.movement.config(e,e.movement))]),events:ii([dt(nh(),function(n,t){var e=t.event;n.getSystem().getByDom(e.target).each(function(e){Ds.highlight(n,e),t.stop(),st(n,ih(),{menu:n,item:e})})}),dt(eh(),function(e,n){n=n.event.item;Ds.highlight(e,n)})]),components:n,eventOrder:e.eventOrder,domModification:{attributes:{role:"menu"}}}}}),ah=function(t,o,r,e){return ae(r,e).bind(function(e){return ae(t,e).bind(function(e){var n=ah(t,o,r,e);return E.some([e].concat(n))})}).getOr([])},ch=function(e){return"prepared"===e.type?E.some(e.menu):E.none()},sh={init:function(){function a(t){return function(e,n){for(var t=we(e),o=0,r=t.length;o<r;o++){var i=t[o],u=e[i];if(n(u,i,e))return E.some(u)}return E.none()}(r.get(),function(e,n){return e===t})}var r=kt({}),i=kt({}),c=kt({}),s=kt(E.none()),u=kt({}),f=function(e){return n(e).bind(ch)},n=function(e){return ae(i.get(),e)},t=function(e){return ae(r.get(),e)};return{setMenuBuilt:function(e,n){var t;i.set(Gn(Gn({},i.get()),((t={})[e]={type:"prepared",menu:n},t)))},setContents:function(e,n,t,o){s.set(E.some(e)),r.set(t),i.set(n),u.set(o);t=Ig(o,t);c.set(t)},expand:function(t){return ae(r.get(),t).map(function(e){var n=ae(c.get(),t).getOr([]);return[e].concat(n)})},refresh:function(e){return ae(c.get(),e)},collapse:function(e){return ae(c.get(),e).bind(function(e){return 1<e.length?E.some(e.slice(1)):E.none()})},lookupMenu:n,lookupItem:t,otherMenus:function(e){var n=u.get();return y(we(n),e)},getPrimary:function(){return s.get().bind(f)},getMenus:function(){return i.get()},clear:function(){r.set({}),i.set({}),c.set({}),s.set(E.none())},isClear:function(){return s.get().isNone()},getTriggeringPath:function(e,u){var n=C(t(e).toArray(),function(e){return f(e).isSome()});return ae(c.get(),e).bind(function(e){var i=T(n.concat(e));return function(e){for(var n=[],t=0;t<e.length;t++){var o=e[t];if(!o.isSome())return E.none();n.push(o.getOrDie())}return E.some(n)}(F(i,function(e,n){return t=e,o=u,r=i.slice(0,n+1),f(t).bind(function(n){return a(t).bind(function(e){return o(e).map(function(e){return{triggeredMenu:n,triggeringItem:e,triggeringPath:r}})})}).fold(function(){return s.get().is(e)?[]:[E.none()]},function(e){return[E.some(e)]});var t,o,r}))})}}},extractPreparedMenu:ch},fh=w("collapse-item"),lh=e({name:"TieredMenu",configFields:[Qo("onExecute"),Qo("onEscape"),$o("onOpenMenu"),$o("onOpenSubmenu"),Tn("onRepositionMenu"),Tn("onCollapseMenu"),pn("highlightImmediately",!0),fn("data",[tn("primary"),tn("menus"),tn("expansions")]),pn("fakeFocus",!1),Tn("onHighlight"),Tn("onHover"),Le(),tn("dom"),pn("navigateOnHover",!0),pn("stayInDom",!1),P("tmenuBehaviours",[_f,Ds,wp,ss]),pn("eventOrder",{})],apis:{collapseMenu:function(e,n){e.collapseMenu(n)},highlightPrimary:function(e,n){e.highlightPrimary(n)},repositionMenus:function(e,n){e.repositionMenus(n)}},factory:function(u,e){function t(e){var o,r,e=(o=e,r=u.data.primary,n=u.data.menus,oe(n,function(e,n){function t(){return uh.sketch(Gn(Gn({},e),{value:n,markers:u.markers,fakeFocus:u.fakeFocus,onHighlight:u.onHighlight,focusManager:(u.fakeFocus?is:rs)()}))}return n===r?{type:"prepared",menu:o.getSystem().build(t())}:{type:"notbuilt",nbMenu:t}})),n=p();return m.setContents(u.data.primary,e,u.data.expansions,n),m.getPrimary()}function a(e){return mp.getValue(e).value}function i(n,e){Ds.highlight(n,e),Ds.getHighlighted(e).orThunk(function(){return Ds.getFirst(e)}).each(function(e){lt(n,e.element,Gr())})}function c(n,e){return Xc(O(e,function(e){return n.lookupMenu(e).bind(function(e){return"prepared"===e.type?E.some(e.menu):E.none()})}))}function s(n,e,t){t=c(e,e.otherMenus(t)),k(t,function(e){wo(e.element,[u.markers.backgroundMenu]),u.stayInDom||ss.remove(n,e)})}function f(e,t){var n,e=(n=e,o.get().getOrThunk(function(){var t={},e=Ac(n.element,"."+u.markers.item),e=C(e,function(e){return"true"===Wt(e,"aria-haspopup")});return k(e,function(e){n.getSystem().getByDom(e).each(function(e){var n=a(e);t[n]=e})}),o.set(E.some(t)),t}));te(e,function(e,n){n=S(t,n);Ut(e.element,"aria-expanded",n)})}function l(t,o,r){return E.from(r[0]).bind(function(e){return o.lookupMenu(e).bind(function(e){if("notbuilt"===e.type)return E.none();var n=e.menu,e=c(o,r.slice(1));return k(e,function(e){go(e.element,u.markers.backgroundMenu)}),ji(n.element)||ss.append(t,Yi(n)),wo(n.element,[u.markers.backgroundMenu]),i(t,n),s(t,o,r),E.some(n)})})}var d,o=kt(E.none()),m=sh.init(),p=function(e){return oe(u.data.menus,function(e,n){return F(e.items,function(e){return"separator"===e.type?[]:[e.data.value]})})};(y=d=d||{})[y.HighlightSubmenu=0]="HighlightSubmenu",y[y.HighlightParent=1]="HighlightParent";function r(o,r,i){void 0===i&&(i=d.HighlightSubmenu);var e=a(r);return m.expand(e).bind(function(t){return f(o,t),E.from(t[0]).bind(function(n){return m.lookupMenu(n).bind(function(e){e=function(e,n,t){if("notbuilt"!==t.type)return t.menu;t=e.getSystem().build(t.nbMenu());return m.setMenuBuilt(n,t),t}(o,n,e);return ji(e.element)||ss.append(o,Yi(e)),u.onOpenSubmenu(o,r,e,T(t)),i===d.HighlightSubmenu?(Ds.highlightFirst(e),l(o,m,t)):(Ds.dehighlightAll(e),E.some(r))})})})}function g(n,t){var e=a(t);return m.collapse(e).bind(function(e){return f(n,e),l(n,m,e).map(function(e){return u.onCollapseMenu(n,t,e),e})})}function n(t){return function(n,e){return Vc(e.getSource(),"."+u.markers.item).bind(function(e){return n.getSystem().getByDom(e).toOptional().bind(function(e){return t(n,e).map(x)})})}}function h(e){return Ds.getHighlighted(e).bind(Ds.getHighlighted)}var v=ii([dt(ih(),function(n,t){var e=t.event.item;m.lookupItem(a(e)).each(function(){var e=t.event.menu;Ds.highlight(n,e);e=a(t.event.item);m.refresh(e).each(function(e){return s(n,m,e)})})}),si(function(n,e){e=e.event.target;n.getSystem().getByDom(e).each(function(e){0===a(e).indexOf("collapse-item")&&g(n,e),r(n,e,d.HighlightSubmenu).fold(function(){u.onExecute(n,e)},b)})}),ui(function(n,e){t(n).each(function(e){ss.append(n,Yi(e)),u.onOpenMenu(n,e),u.highlightImmediately&&i(n,e)})})].concat(u.navigateOnHover?[dt(eh(),function(e,n){n=n.event.item;!function(n,e){e=a(e);m.refresh(e).bind(function(e){return f(n,e),l(n,m,e)})}(e,n),r(e,n,d.HighlightParent),u.onHover(e,n)})]:[])),y={collapseMenu:function(n){h(n).each(function(e){g(n,e)})},highlightPrimary:function(n){m.getPrimary().each(function(e){i(n,e)})},repositionMenus:function(t){m.getPrimary().bind(function(n){return h(t).bind(function(e){var n=a(e),e=ue(m.getMenus()),t=Xc(O(e,sh.extractPreparedMenu));return m.getTriggeringPath(n,function(e){return n=e,I(t,function(e){if(!e.getSystem().isConnected())return E.none();e=Ds.getCandidates(e);return L(e,function(e){return a(e)===n})});var n})}).map(function(e){return{primary:n,triggeringPath:e}})}).fold(function(){var e;e=t,E.from(e.components()[0]).filter(function(e){return"menu"===Wt(e.element,"role")}).each(function(e){u.onRepositionMenu(t,e,[])})},function(e){var n=e.primary,e=e.triggeringPath;u.onRepositionMenu(t,n,e)})}};return{uid:u.uid,dom:u.dom,markers:u.markers,behaviours:za(u.tmenuBehaviours,[_f.config({mode:"special",onRight:n(function(e,n){return Ms(n.element)?E.none():r(e,n,d.HighlightSubmenu)}),onLeft:n(function(e,n){return Ms(n.element)?E.none():g(e,n)}),onEscape:n(function(e,n){return g(e,n).orThunk(function(){return u.onEscape(e,n).map(function(){return e})})}),focusIn:function(n,e){m.getPrimary().each(function(e){lt(n,e.element,Gr())})}}),Ds.config({highlightClass:u.markers.selectedMenu,itemClass:u.markers.menu}),wp.config({find:function(e){return Ds.getHighlighted(e)}}),ss.config({})]),eventOrder:u.eventOrder,apis:y,events:v}},extraApis:{tieredData:function(e,n,t){return{primary:e,menus:n,expansions:t}},singleData:function(e,n){return{primary:e,menus:wn(e,n),expansions:{}}},collapseItem:function(e){return{value:Yt(fh()),meta:{text:e}}}}}),dh=w("sink"),$o=w(Nu({name:dh(),overrides:w({dom:{tag:"div"},behaviours:di([Zg.config({useFixed:x})]),events:ii([pt(Fr()),pt(wr()),pt(Br())])})})),mh=w("dismiss.popups"),ph=w("reposition.popups"),gh=Ge([pn("isExtraPart",s),mn("fireEventInstead",[pn("event",Qr())])]),hh=Ge([mn("fireEventInstead",[pn("event",ei())]),cn("doReposition")]);(Qr=zg=zg||{})[Qr.HighlightFirst=0]="HighlightFirst",Qr[Qr.HighlightNone=1]="HighlightNone";function vh(e,n){var t=e.getHotspot(n).getOr(n),o=e.getAnchorOverrides();return e.layouts.fold(function(){return{anchor:"hotspot",hotspot:t,overrides:o}},function(e){return{anchor:"hotspot",hotspot:t,overrides:o,layouts:e}})}function yh(e,n,t,o,r,i,u){var a,c,s,f,l,d,m=vh(e,t);return(a=m,s=o,f=r,l=u,n=u=n,u=c=t,n=(0,(e=e).fetch)(u).map(n),d=Dy(c,e),n.map(function(e){return e.bind(function(e){return E.from(lh.sketch(Gn(Gn({},f.menu()),{uid:Pi(""),data:e,highlightImmediately:l===zg.HighlightFirst,onOpenMenu:function(e,n){var t=d().getOrDie();Zg.position(t,a,n),Xg.decloak(s)},onOpenSubmenu:function(e,n,t){var o=d().getOrDie();Zg.position(o,{anchor:"submenu",item:n},t),Xg.decloak(s)},onRepositionMenu:function(e,n,t){var o=d().getOrDie();Zg.position(o,a,n),k(t,function(e){Zg.position(o,{anchor:"submenu",item:e.triggeringItem},e.triggeredMenu)})},onEscape:function(){return ap.focus(c),Xg.close(s),E.some(!0)}})))})})).map(function(e){return e.fold(function(){Xg.isOpen(o)&&Xg.close(o)},function(e){Xg.cloak(o),Xg.open(o,e),i(o)}),o})}function bh(e,n,t,o,r,i,u){return Xg.close(o),$u(o)}function wh(e,n,t,o,r,i){var u=Lp.getCoupled(t,"sandbox");return(Xg.isOpen(u)?bh:yh)(e,n,t,u,o,r,i)}function xh(e,n,t){n=wp.getCurrent(n).getOr(n),e=ed(e.element),t?Co(n.element,"min-width",e+"px"):(n=n.element,e=e,kp.set(n,e))}function Sh(e){Xg.getState(e).each(function(e){lh.repositionMenus(e)})}function Oh(o,r,i){var n,e,t,u,a={id:n=Yt("aria-owns"),link:function(e){Ut(e,"aria-owns",n)},unlink:function(e){Kt(e,"aria-owns")}},c=Dy(r,o);return{dom:{tag:"div",classes:o.sandboxClasses,attributes:{id:a.id,role:"listbox"}},behaviours:dc(o.sandboxBehaviours,[mp.config({store:{mode:"memory",initialValue:r}}),Xg.config({onOpen:function(e,n){var t=vh(o,r);a.link(r.element),o.matchWidth&&xh(t.hotspot,n,o.useMinWidth),o.onOpen(t,e,n),void 0!==i&&void 0!==i.onOpen&&i.onOpen(e,n)},onClose:function(e,n){a.unlink(r.element),void 0!==i&&void 0!==i.onClose&&i.onClose(e,n)},isPartOf:function(e,n,t){return Cp(n,t)||Cp(r,t)},getAttachPoint:function(){return c().getOrDie()}}),wp.config({find:function(e){return Xg.getState(e).bind(function(e){return wp.getCurrent(e)})}}),pc.config({channels:Gn(Gn({},(u=Qe("Dismissal",gh,t={isExtraPart:s}),(t={})[mh()]={schema:Ge([tn("target")]),onReceive:function(n,e){Xg.isOpen(n)&&(Xg.isPartOf(n,e.target)||u.isExtraPart(n,e.target)||u.fireEventInstead.fold(function(){return Xg.close(n)},function(e){return ct(n,e.event)}))}},t)),(e=Qe("Reposition",hh,t={doReposition:Sh}),(t={})[ph()]={onReceive:function(n){Xg.isOpen(n)&&e.fireEventInstead.fold(function(){return e.doReposition(n)},function(e){return ct(n,e.event)})}},t))})])}}function kh(){return!window.matchMedia("only screen and (min-width:767px)").matches}function Ch(o){return function(e,n,t){kh()&&n.getSystem().getByUid(o).each(function(e){Kt(e.element,"style")})}}function Lh(e,n,t){return{type:"item",data:{meta:{text:n},value:t},dom:{tag:"div"},components:[ip.sketch({iconHtml:e,classes:[bm.MenuIcon]}),lp.sketch({text:n,classes:[bm.MenuLabel]})]}}function Fh(e,n){return{dom:{tag:"div",classes:[bm.AssetsHeaderTh].concat(n=void 0===n?[]:n)},components:[e]}}function Th(e,n){return cp.sketch({dom:{tag:"button",classes:[bm.AssetsHeaderButton,bm.FocusStop]},components:[{dom:{tag:"span"},components:[sp(e)]},{dom:{tag:"span"}}],action:(t=Lu(n),function(e){Du(e,t)}),buttonBehaviours:di([ss.config({})])});var t}function Dh(n,t){return function(e){ss.replaceAt(e,1,E.from(t?n:{dom:{tag:"span"}}))}}function Bh(o,r){return function(n,e,t){L(e().fileState.files,function(e){return e.uuid===o}).each(function(e){n(Ey(r,[e]))})}}function Mh(o){return function(e,n,t){n=n().selectedFiles;e(Ey(o,n)),e({type:"selectedFiles.clear",payload:{}})}}function Ih(e,n){var t,o=URL.createObjectURL(e);t=o,e=n,n=Wn.fromTag("a"),Ut(n,"href",t),Ut(n,"download",e),Fi(So(),n),n.dom.click(),Ti(n),URL.revokeObjectURL(o)}function _h(e,n){return Ay.isIE()||Ay.isEdge()?(t=e,o=n,void navigator.msSaveBlob(t,o)):Ih(e,n);var t,o}function Eh(e,n){var t;t=e,na.nu(function(e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onload=function(){200===this.status&&e($.value(this.response))},n.onerror=function(){e($.error("Error loading url"))},n.send()}).get(function(e){e.each(function(e){return _h(e,n)})})}function Ah(o,r){return function(e,n,t){o.each(function(e){return Eh(e,r)}),e({type:Wu.DownloadFiles,payload:{}})}}function zh(e,r){return function(n,t,o){o.rename(e,r).get(function(e){return e.fold(fu(n),function(e){return Su(n,t,o)})})}}function Ph(){return function(e,n,t){e({type:"selectedFiles.clear",payload:""}),e({type:Ku.Clear,payload:{}})}}function Nh(e){return function(n,t,o){function r(e){e.fold(fu(n),function(e){xu(n,t,o),Ph()(n,t,o)})}var i=O(e.files,function(e){return e.uuid});M(t().path).bind(function(e){return e.uuid}).fold(function(){return o.move(i).get(r)},function(e){return o.move(i,e).get(r)})}}function Vh(e){return function(n,t,o){function r(e){e.fold(fu(n),function(e){xu(n,t,o),Ph()(n,t,o)})}B(e.files).fold(function(){n(su("Failed to copy file"))},function(n){M(t().path).bind(function(e){return e.uuid}).fold(function(){return o.copy(n.uuid).get(r)},function(e){return o.copy(n.uuid,e).get(r)})})}}function Rh(e){return function(n,t,o){Yl()(n,t,o),o.remove([e]).get(function(e){return e.fold(fu(n),function(e){n({type:lu.Close,payload:{}}),xu(n,t,o)})})}}function Hh(){return function(n,t,o){var e=O(t().selectedFiles,function(e){return e.uuid});Yl()(n,t,o),o.remove(e).get(function(e){return e.fold(fu(n),function(e){return xu(n,t,o)})})}}function Uh(e){return{type:Gu.InsertFiles,payload:{files:e}}}function jh(e){return(Do(t=e,"position").is("fixed")?E.none():Bt(t)).orThunk(function(){var n=Wn.fromTag("span");return Dt(t).bind(function(e){Fi(e,n);e=Bt(n);return Ti(n),e})}).map(id).getOrThunk(function(){return Tp(0,0)});var t}function Wh(n){return function(e){return e.translate(-n.left,-n.top)}}function Gh(n){return function(e){return e.translate(n.left,n.top)}}function Kh(t){return function(e,n){return p(t,function(e,n){return n(e)},Tp(e,n))}}function qh(e,n,t){return e.fold(Kh([Gh(t),Wh(n)]),Kh([Wh(n)]),Kh([]))}function Zh(e,n,t){return e.fold(Kh([Gh(t)]),Kh([]),Kh([Gh(n)]))}function Jh(e,n,t){return e.fold(Kh([]),Kh([Wh(t)]),Kh([Gh(n),Wh(t)]))}function Yh(e,n,t){return e=e.fold(function(e,n){return{position:E.some("absolute"),left:E.some(e+"px"),top:E.some(n+"px")}},function(e,n){return{position:E.some("absolute"),left:E.some(e-t.left+"px"),top:E.some(n-t.top+"px")}},function(e,n){return{position:E.some("fixed"),left:E.some(e+"px"),top:E.some(n+"px")}}),Gn({right:E.none(),bottom:E.none()},e)}function Xh(e,i,u,a){function n(o,r){return function(e,n){var t=o(i,u,a);return r(e.getOr(t.left),n.getOr(t.top))}}return e.fold(n(Jh,Ny),n(Zh,Vy),n(qh,Ry))}function $h(e,n){return n=Wt(e,n),j(n)?NaN:parseInt(n,10)}function Qh(e,n,t,o){return r=n,e=(n=e).element,n=$h(e,r.leftAttr),r=$h(e,r.topAttr),(isNaN(n)||isNaN(r)?E.none():E.some(Tp(n,r))).fold(function(){return t},function(e){return Ry(e.left+o.left,e.top+o.top)});var r}function ev(e,n,t,o,r,i){var t=Qh(e,n,t,o),o=(n.mustSnap?Hy:Uy)(e,n,t,r,i),u=qh(t,r,i);return function(e,n,t){e=e.element;Ut(e,n.leftAttr,t.left+"px"),Ut(e,n.topAttr,t.top+"px")}(e,n,u),o.fold(function(){return{coord:Ry(u.left,u.top),extra:E.none()}},function(e){return{coord:e.output,extra:e.extra}})}function nv(e,n){!function(e,n){e=e.element;Kt(e,n.leftAttr),Kt(e,n.topAttr)}(e,n)}function tv(e,t,o,r){return I(e,function(e){var n=e.sensor;return function(e,n,t,o,r,i){e=Zh(e,r,i),i=Zh(n,r,i);return Math.abs(e.left-i.left)<=t&&Math.abs(e.top-i.top)<=o}(t,n,e.range.left,e.range.top,o,r)?E.some({output:Xh(e.output,t,o,r),extra:e.extra}):E.none()})}function ov(t,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r=setTimeout(function(){t.apply(null,e),r=null},o)}}}function rv(e,n){var t;e.getSystem().addToGui(n),Dt((t=n).element).filter(yi).each(function(n){Do(n,"z-index").each(function(e){Ut(n,jy,e)}),Co(n,"z-index",To(t.element,"z-index"))})}function iv(e){Dt(e.element).filter(yi).each(function(n){Gt(n,jy).fold(function(){return Bo(n,"z-index")},function(e){return Co(n,"z-index",e)}),Kt(n,jy)}),e.getSystem().removeFromGui(e)}function uv(e,n,t){return e.getSystem().build(mc.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:t}))}function av(n){return e=Do(n,"left"),t=Do(n,"top"),o=Do(n,"position"),r=function(e,n,t){return("fixed"===t?Ry:Ny)(parseInt(e,10),parseInt(n,10))},(e.isSome()&&t.isSome()&&o.isSome()?E.some(r(e.getOrDie(),t.getOrDie(),o.getOrDie())):E.none()).getOrThunk(function(){var e=id(n);return Vy(e.left,e.top)});var e,t,o,r}function cv(t,e,r,i,u,a,n){var o,c,s,f,l,d=e.fold(function(){var t,o,e=(e=r,t=a.left,o=a.top,e.fold(function(e,n){return Ny(e+t,n+o)},function(e,n){return Vy(e+t,n+o)},function(e,n){return Ry(e+t,n+o)})),e=qh(e,i,u);return Ry(e.left,e.top)},function(n){var e=ev(t,n,r,a,i,u);return e.extra.each(function(e){n.onSensor(t,e)}),e.coord});return o=d,c=i,s=u,e=(f=n).bounds,d=Zh(o,c,s),n=Yc(d.left,e.x,e.x+e.width-f.width),f=Yc(d.top,e.y,e.y+e.height-f.height),l=Vy(n,f),o.fold(function(){var e=Jh(l,c,s);return Ny(e.left,e.top)},function(){return l},function(){var e=qh(l,c,s);return Ry(e.left,e.top)})}function sv(e,n){return{bounds:e.getBounds(),height:_c(n.element),width:nd(n.element)}}function fv(c,s,e,n,t){var t=e.update(n,t),f=e.getStartData().getOrThunk(function(){return sv(s,c)});t.each(function(e){var n,t,o,r,i,u,a;n=c,o=f,r=e,a=(t=s).getTarget(n.element),t.repositionTarget&&(u=Lt(n.element),i=ud(u),e=jh(a),u=av(a),o=cv(n,t.snaps,u,i,e,r,o),e=Yh(o,0,e),Fo(a,e)),t.onDrag(n,a,r)})}function lv(n,e,t,o){e.each(iv),t.snaps.each(function(e){nv(n,e)}),e=t.getTarget(n.element),o.reset(),t.onDrop(n,e)}function dv(i,u,a){return[dt(wr(),function(n,e){var t,o,r;0===e.event.raw.button&&(e.stop(),e={drop:e=function(){return lv(n,E.some(o),i,u)},delayDrop:(t=ov(e,200)).schedule,forceDrop:e,move:function(e){t.cancel(),fv(n,i,u,Wy,e)}},o=uv(n,i.blockerClass,(r=e,ii([dt(wr(),r.forceDrop),dt(Or(),r.drop),dt(xr(),function(e,n){r.move(n.event)}),dt(Sr(),r.delayDrop)]))),a(n),rv(n,o))})]}function mv(r,i,u){var a=kt(E.none());return[dt(hr(),function(n,e){e.stop();var t,e=function(){lv(n,a.get(),r,i),a.set(E.none())},o=uv(n,r.blockerClass,(t={drop:e,delayDrop:b,forceDrop:e,move:function(e){fv(n,r,i,Gy,e)}},ii([dt(hr(),t.forceDrop),dt(yr(),t.drop),dt(br(),t.drop),dt(vr(),function(e,n){t.move(n.event)})])));a.set(E.some(o));u(n),rv(n,o)}),dt(vr(),function(e,n){n.stop(),fv(e,r,i,Gy,n.event)}),dt(yr(),function(e,n){n.stop(),lv(e,a.get(),r,i),a.set(E.none())}),dt(br(),function(e){lv(e,a.get(),r,i),a.set(E.none())})]}function pv(){return e=function(e){return e.destroy()},t=kt(E.none()),{clear:function(){n(),t.set(E.none())},isSet:function(){return t.get().isSome()},set:function(e){n(),t.set(E.some(e))}};function n(){return t.get().each(e)}var e,t}function gv(e){return"<alloy.field."+e+">"}function hv(e){return e=Ct(e),S($y,e)}function vv(e,n){var t=n.getRoot(e).getOr(e.element);vo(t,n.invalidClass),n.notify.each(function(n){hv(e.element)&&Ut(e.element,"aria-invalid",!1),n.getContainer(e).each(function(e){Rt(e,n.validHtml)}),n.onValid(e)})}function yv(n,e,t,o){var r=e.getRoot(n).getOr(n.element);go(r,e.invalidClass),e.notify.each(function(e){hv(n.element)&&Ut(n.element,"aria-invalid",!0),e.getContainer(n).each(function(e){Rt(e,o)}),e.onInvalid(n,o)})}function bv(n,e,t){return e.validator.fold(function(){return $u($.value(!0))},function(e){return e.validate(n)})}function wv(n,t,e){return t.notify.each(function(e){e.onValidate(n)}),bv(n,t).map(function(e){return n.getSystem().isConnected()?e.fold(function(e){return yv(n,t,0,e),$.error(e)},function(e){return vv(n,t),$.value(e)}):$.error("No longer in system")})}function xv(e){return e.element}function Sv(n){return function(e){return e&&""!==e?$.value(e):$.error(n)}}function Ov(n){return function(e){return e&&null===e.match(eb)?$.value(e):$.error(n)}}function kv(e){return function(t,o){return p(e,function(e,n){return e.isError()?e:n(t,o)},$.value(t))}}function Cv(e,n,t,o){var r=Zy.parts.title({dom:{tag:"div",classes:[bm.DialogTitle]},components:[sp(e.title)]}),i=Zy.parts.close(cp.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonIcon,bm.ButtonNaked]},action:function(e){o(e,"close")},components:[ip.sketch({iconHtml:Mm,classes:[]})],buttonBehaviours:di([pp.config({})])})),u=Zy.parts.body({dom:{tag:"div",classes:[bm.DialogBody]},components:n}),n=ie(e.buttons,function(e,n){return cp.sketch({dom:{tag:"button",classes:[bm.Button].concat(!0===e.primary?[]:[bm.ButtonSecondary])},components:[sp(e.text)],action:function(e){o(e,n)},buttonBehaviours:di([pp.config({})])})}),n=Zy.parts.footer({dom:{tag:"div",classes:[bm.DialogFooter]},components:n}),n=Ji(Zy.sketch({lazySink:e.lazySink,onEscape:function(e){return o(e,"close"),E.some(!0)},dom:{tag:"div",classes:[bm.Dialog]},components:[{dom:{tag:"div",classes:[bm.DialogDialog]},components:[{dom:{tag:"div",classes:[bm.DialogHeader]},components:[r,i]},u,n]}],parts:{blocker:{dom:{tag:"div",styles:{position:"fixed"},classes:[bm.Dialog,bm.DialogBackdrop]}}}}));return Zy.show(n),t&&Xy.getField(Zy.getBody(n).components()[0],"value").each(function(e){e.element.dom.focus()}),n}function Lv(e,n,t,o){Qy.run(t).get(function(){Qy.isInvalid(t)||(Zy.hide(n),e({action:"submit",value:o}))})}function Fv(e,u,a,c){void 0===c&&(c="");var s=Lc(mc.sketch({dom:{classes:[bm.InputMsgError]}}));return Xu(function(r){var n=Lc(Xy.sketch(function(e){return{dom:{tag:"div",classes:[bm.Form]},components:[e.field("value",xp.sketch({dom:{tag:"div",classes:[bm.FormGroup]},components:[xp.parts.label({dom:{tag:"label",classes:[bm.InputLabel]},components:[sp(u)]}),xp.parts.field({factory:Sp,data:c,inputClasses:[bm.InputField],inputBehaviours:di([pp.config({})])}),s.asSpec()]}))],formBehaviours:di([_f.config({mode:"special",onEnter:function(n){return mp.getValue(n).value.each(function(e){return Lv(r,i,n,e)}),E.some(!0)}}),(n=a,t=s,o=c,Qy.config({invalidClass:"tam-invalid-input",notify:{getContainer:function(e){return t.getOpt(e).map(xv)}},validator:{validate:function(e){e=mp.getValue(e).value;return $u(n(e.getOr(""),o))},validateOnLoad:!1}}))])};var n,t,o})),i=Cv(e,[n.asSpec()],!0,function(e,t){n.getOpt(i).each(function(n){mp.getValue(n).value.each(function(e){"submit"!==t?(Zy.hide(i),r({action:t,value:e})):Lv(r,i,n,e)})})})})}function Tv(e){return"submit"===e.action&&0<e.value.length?E.some(e.value):E.none()}function Dv(e,n){return Fv({title:"Rename",lazySink:e,buttons:{submit:{text:"Submit",primary:!0},cancel:{text:"Cancel"}}},"New name",kv([Sv("Filename cannot be empty."),Ov("Incorrect filename.")]),n).map(Tv)}function Bv(e,n,r){return Xu(function(t){var o=Cv({title:n,lazySink:e,buttons:{yes:{text:"Yes",primary:!0},no:{text:"No"}}},[{dom:{tag:"p"},components:[sp(r)]}],!1,function(e,n){Zy.hide(o),t("yes"===n)})})}function Mv(e){return Bv(e,"Delete item?","Are you sure you want to delete this item?")}function Iv(e){return Bv(e,"Delete selected items?","Are you sure you want to delete the selected items?")}function _v(){return{type:"separator",dom:{tag:"div",classes:[bm.MenuSeparator]},components:[]}}function Ev(e,n,t,o){return{type:"item",data:{value:o},dom:{tag:"div"},components:[ip.sketch({iconHtml:e,classes:[bm.MenuIcon]}),lp.sketch({text:n,classes:[bm.MenuLabel]})]}}function Av(e,n){var t=String(e);if(t.length<n)for(var o=0;o<n-t.length;o++)t="0"+t;return t}function zv(e){return n="%Y-%m-%d %H:%M:%S",t=e,o="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),r="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),i="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),e="January February March April May June July August September October November December".split(" "),n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=(n=n.replace("%D","%m/%d/%Y")).replace("%r","%I:%M:%S %p")).replace("%Y",""+t.getFullYear())).replace("%m",Av(t.getMonth()+1,2))).replace("%d",Av(t.getDate(),2))).replace("%H",""+Av(t.getHours(),2))).replace("%M",""+Av(t.getMinutes(),2))).replace("%S",""+Av(t.getSeconds(),2))).replace("%I",""+((t.getHours()+11)%12+1))).replace("%p",t.getHours()<12?"AM":"PM")).replace("%B",""+e[t.getMonth()])).replace("%b",""+i[t.getMonth()])).replace("%A",""+r[t.getDay()])).replace("%a",""+o[t.getDay()])).replace("%%","%");var n,t,o,r,i}function Pv(e,n){var r,i;Du(e,(r=n.file.uuid,i=n.file.name,function(n,e,t){var o=pu(t,e().viewType,gu(e(),{parentUuid:E.from(r)}));Yl()(n,e,t),wu(n,e(),o,function(e){n({type:ta.PushPathItem,payload:{pathItem:{name:i,uuid:E.from(r)}}}),n(hu(e))})}))}function Nv(e,n){var o;n.insert&&Du(e,(o=[n.file.uuid],function(e,n,t){n=C(n().fileState.files,function(e){return S(o,e.uuid)});e(Uh(n))}))}function Vv(n){return function(e){return("directory"===n.file.type?Pv:Nv)(e,n)}}function Rv(e){return{dom:{tag:"img",attributes:{src:e}}}}function Hv(e){return mc.sketch({dom:{tag:"div",classes:[bm.AssetThumbnailContainer]},components:[Rv(e)]})}function Uv(e){return e.file.thumbUrl.fold(function(){return cp.sketch({dom:{tag:"div",classes:[bm.AssetIconContainer]},components:[up.sketch({type:e.file.type})],action:Vv(e)})},(n=Vv(e),function(e){return cp.sketch({dom:{tag:"div",classes:[bm.AssetThumbnailContainer]},components:[Rv(e)],action:n})}));var n}function jv(e){return e.insert||"directory"===e.file.type}function Wv(e){return jv(e)?Uv(e):(n=e).file.thumbUrl.fold(function(){return mc.sketch({dom:{tag:"div",classes:[bm.AssetIconContainer]},components:[up.sketch({type:n.file.type})]})},Hv);var n}function Gv(e){return jv(e)?(n=e,lp.sketch({text:n.file.name,starred:n.file.starred,classes:[bm.AssetName,bm.FocusStop],action:Vv(n)})):(e=e,lp.sketch({text:e.file.name,starred:e.file.starred,classes:[bm.AssetName,bm.FocusStop]}));var n}function Kv(n,t,o,r,i){return function(e){return tb.sketch({lazySink:n,file:e,listType:t,viewType:o,isSearching:r,insert:i})}}function qv(e,n){ju(Bu(),"_pdfjs",e+"/pdf.min.js").get(function(e){e.fold(Hu,n)})}function Zv(e,n){return wl(function(){return e.getPage(n)})}function Jv(e,n){return wl(function(){return e.getDocument(n)})}function Yv(){var e=Wn.fromTag("iframe");return Lo(e,{position:"fixed",top:"-1px",left:"-1px",width:"1px",height:"1px",visibility:"hidden"}),Ut(e,"data-pdfprint-id",ib),e}function Xv(e){Pc(e,'[data-pdfprint-id="'+ib+'"]').each(function(e){!function(e){e=Ec(Wn.fromDom(e.dom.contentWindow.document.body),"img");k(e,function(e){Gt(e,"src").each(function(e){return URL.revokeObjectURL(e)})})}(e),Ti(e)})}function $v(e){return Wn.fromDom(e.dom.contentWindow)}function Qv(t,o,r){return na.nu(function(n){function e(e){H(e)?n($.error("Failed to get blob from canvas")):n($.value(e))}return Oe(t,"toBlob")?t.toBlob(e,o,r):function(e,n,t,o){for(var r=atob(e.toDataURL(t,o).split(",")[1]),i=new Uint8Array(r.length),u=0;u<r.length;u++)i[u]=r.charCodeAt(u);n(new Blob([i],{type:t}))}(t,e,o,r)})}function ey(o,e){return t=o,r=e,wl(function(){var e=r.getViewport(1);t.width=Math.floor(e.width*ab),t.height=Math.floor(e.height*ab);var n=t.getContext("2d");if(!n)return qu.reject("Failed to get canvas context");n.save(),n.fillStyle="rgb(255, 255, 255)",n.fillRect(0,0,t.width,t.height),n.restore();n={canvasContext:n,transform:[ab,0,0,ab,0,0],viewport:r.getViewport(1),intent:"print"};return r.render(n).promise.then(function(){return{width:Math.floor(e.width*(96/72)),height:Math.floor(e.height*(96/72))}})}).bindFuture(function(e){var n=e.width,t=e.height;return Qv(o,"image/png",1).mapResult(function(e){return{blob:e,width:n,height:t}})});var t,r}function ny(e,n){var r=document.createElement("canvas");return Jv(e,n).bindFuture(function(n){return t=r,o=n,na.wrap(Sl(function(e,n){for(var t=[],o=0;o<e;o++)t.push(n(o));return t}(o.numPages,function(e){return Zv(o,e+1).bindFuture(function(n){return ey(t,n).map(function(e){return n.cleanup(),e})})})).map(xl)).map(function(e){return n.cleanup(),e});var t,o})}function ty(e,t){return Xu(function(e){var n;Ho($v(t),"afterprint",function(){e(t)}),n=$v(t),ub.browser.isIE()?n.dom.document.execCommand("print",!1,null):n.dom.print()})}function oy(n,e,t){return ny(e,t).bindFuture(function(e){var t=Yv();Xv(n),Fi(n,t),function(e,n){n=n.dom.contentWindow.document;n.open(),n.write(e),n.close()}("\n<!DOCTYPE html>\n<html>\n<head>\n  <style>\n    @media print {\n      div {\n        position: relative;\n        top: 0;\n        left: 0;\n        width: 1px;\n        height: 1px;\n        overflow: visible;\n        page-break-after: always;\n        page-break-inside: avoid;\n      }\n\n      img {\n        display: block;\n      }\n    }\n  </style>\n</head>\n<body>\n</body>\n</html>\n",t);e=F(e,function(e){var o,r,n=t.dom.contentWindow;if(n){n=n.document.body;if(n)return[(o=e,r=n,na.nu(function(e){var n=URL.createObjectURL(o.blob),t=document.createElement("img");t.onload=function(){e($.value(t))},t.onerror=function(){e($.error("Failed to load image"))},t.width=o.width,t.height=o.height,t.src=n;n=document.createElement("div");n.appendChild(t),r.appendChild(n)}))]}return[]}),e=Sl(e);return na.wrap(e.map(xl)).mapResult(function(e){return t})}).bindFuture(function(e){return na.fromFuture(ty(0,e))})}function ry(e,n,t){return cb.browser.isFirefox()||cb.browser.isIE()?oy(e,n,t):(i=e,u=t,na.nu(function(n){function t(){e.unbind(),r.unbind()}var o=Yv(),e=Ho(o,"load",function(){t();var e=o.dom.contentWindow;e&&e.print(),n($.value(u))}),r=Ho(o,"error",function(){t(),n($.error("Failed to print PDF file"))});Ut(o,"src",u),Xv(i),Fi(i,o)}));var i,u}function iy(e){return e.scrollWidth-e.clientWidth}function uy(e){return e.scrollHeight-e.clientHeight}function ay(n,t,o,r){return wl(function(){return e=n,$.fromOption(E.from(e.dom.getContext("2d")),"Failed to get canvas context").fold(function(e){return qu.reject(e)},function(e){return Co(n,"opacity","0"),t.render({canvasContext:e,viewport:o}).promise.then(function(){return t.cleanup(),Bo(n,"opacity"),Ut(n,"data-zoom-factor",String(r)),n})});var e})}function cy(e,n,t,o){return t=e.dom["height"===o?"clientHeight":"clientWidth"]/n.getViewport(1)[o]*t,n.getViewport(t)}function sy(e,n,t,o,r){var i,u,a=(i=(a=n).dom,u=iy(i),a=uy(i),{horizontal:0===u?.5:i.scrollLeft/u,vertical:0===a?.5:i.scrollTop/a}),r=cy(n,t,o,r);return Ut(e,"height",r.height),Ut(e,"width",r.width),function(e,n){e=e.dom;e.scrollLeft=iy(e)*n.horizontal,e.scrollTop=uy(e)*n.vertical}(n,a),ay(e,t,r,o)}function fy(e,n,t){return cp.sketch({dom:{tag:"button",classes:[bm.PreviewControl],attributes:{type:"button","aria-label":t}},components:[ip.sketch({iconHtml:e})],buttonBehaviours:di([pp.config({})]),action:n})}function ly(t,e){return xp.sketch({dom:{tag:"div",classes:[bm.FormGroup]},components:[lp.sketch({text:e,classes:[bm.InputLabel]}),xp.parts.field({factory:Sp,tag:"textarea",inputClasses:[bm.InputField],inputBehaviours:di([pp.config({}),Ot("upload",[dt("focusout",function(e){var r,i,n=mp.getValue(e);Du(e,(r=t,i=n,function(n,t,o){n({type:lu.SetDescription,payload:{description:i}}),o.setMeta(r,{description:i,createdBy:E.none()}).get(function(e){return e.fold(fu(n),function(){return xu(n,t,o)})})}))})])])})]})}function dy(e,n){return[{dom:{tag:"span",classes:[bm.InputLabel]},components:[sp(e)]},lp.sketch({text:n,classes:[bm.StaticValue]})]}function my(t){return{dom:{tag:"div",classes:[bm.FormGroup]},components:dy(t,""),behaviours:di([ss.config({}),wp.config({find:E.some}),mp.config({store:{mode:"manual",getValue:b,setValue:function(e,n){ss.set(e,dy(t,n))}}})])}}function py(e,n){n=n.map(function(e){return e.width+" x "+e.height}).or(E.some("N/A")),Du(e,mu(n))}function gy(e){var n;return{dom:{tag:"img",classes:[bm.PreviewImage],attributes:{src:e}},eventOrder:((n={})[Xr()]=["allowbubbling","imagePreview"],n),behaviours:di([gp.config({events:[{native:"error",simulated:"bubbled.error"}]}),Ot("imagePreview",[ui(function(n){var o;o=e,na.nu(function(e){function n(){Ti(t)}var t=Wn.fromTag("img");jt(t,{src:o}),Lo(t,{position:"fixed",top:"0",left:"0",visibility:"hidden"}),Ho(t,"load",function(){e($.value({width:t.dom.naturalWidth,height:t.dom.naturalHeight})),n()}),Ho(t,"error",function(){e($.error("Could not load image")),n()}),Fi(So(),t)}).get(function(e){py(n,e.toOptional())})})])])}}function hy(e,n){return{dom:{tag:"video",classes:[bm.PreviewVideo],attributes:{controls:"true"}},components:[{dom:{tag:"source",attributes:{src:n,type:(t=e,L(we(dm),function(e){return S(dm[e],Il(t))}).getOr(""))}},behaviours:di([gp.config({events:[{native:"error",simulated:"bubbled.error"}]})])}],behaviours:di([gp.config({events:[{native:"loadedmetadata",simulated:"bubbled.loadedmetadata"},{native:"error",simulated:"bubbled.error"}]}),Ot("videoPreview",[dt("bubbled.loadedmetadata",function(e){var n=$c(E.from(e.element.dom.videoWidth),E.from(e.element.dom.videoHeight),function(e,n){return{width:e,height:n}});py(e,n)})])])};var t}function vy(e){return{dom:{tag:"div",classes:[bm.Asset,bm.AssetFile]},components:[up.sketch({type:e,classes:[bm.PreviewIcon]})]}}function yy(e,n){var t=p(n,function(e,n){return e+n.loaded},0),n=p(n,function(e,n){return e+n.total},0);hb.setStatus(e,"uploading"),hb.setText(e,"Uploading: "+String(Math.round(t/n*100))+"%"),hb.setProgress(e,Math.round(t/n*100))}function by(e){hb.setStatus(e,"done"),hb.setText(e,"Upload completed."),hb.setProgress(e,100)}function wy(e,n,t){e.getSystem().getByUid(t).fold(function(){n.getOpt(e).each(function(e){ss.append(e,hb.sketch({uid:t,uploadStatusBehaviours:di([Ot("upload",[ui(by)])])}))})},by)}function xy(e,t,n){e.getSystem().getByUid(n).each(function(n){t.getOpt(e).each(function(e){ss.remove(e,n)})})}function Sy(n,e,t,o){var r,i,u,a;e.preview.isNone()&&e.upload.lastUpdate.isSome()?0<e.upload.files.length?(r=n,i=e.upload.files,u=t,a=o,r.getSystem().getByUid(a).fold(function(){u.getOpt(r).each(function(e){ss.append(e,hb.sketch({uid:a,uploadStatusBehaviours:di([Ot("upload",[ui(function(e){yy(e,i)})])])}))})},function(e){return yy(e,i)})):e.upload.lastUpdate.fold(function(){return wy(n,t,o)},function(e){return(5e3<(new Date).getTime()-e.getTime()?xy:wy)(n,t,o)}):xy(n,t,o)}function Oy(o){return function(n,e,t){t=pu(t,o,gu(e(),{}));wu(n,e(),t,function(e){n({type:aa.SetViewType,payload:{viewType:o}}),n(hu(e))})}}function ky(e,n,t){return{type:"item",data:{meta:{text:n},value:t},dom:{tag:"div"},components:[ip.sketch({iconHtml:e,classes:[bm.MenuIcon]}),lp.sketch({text:n,classes:[bm.MenuLabel]})]}}function Cy(e){return e="starred"===e?"Starred":"Files",[{dom:{tag:"span",classes:[bm.LocationButtonLabel]},components:[sp(e)]},ip.sketch({iconHtml:Dm})]}function Ly(e){return[cp.sketch({dom:{tag:"a",classes:[bm.FocusStop]},components:[sp("Files")],action:function(e){Du(e,Xl(0))}})].concat(O(e,(o=e,function(e,n){var t=n===o.length-1;return cp.sketch({dom:{tag:t?"span":"a",attributes:{href:"#"},classes:t?[]:[bm.FocusStop]},components:[fp(e.name)],action:function(e){t||Du(e,Xl(n+1))}})})));var o}function Fy(e,n,t){var o=function(e,n){if(void 0===e)throw new Error("Cannot intersperse undefined");if(e.length<=1)return e;var t=[];t.push(e[0]);for(var o=1;o<e.length;o++)t.push(n()),t.push(e[o]);return t}(Zn([n[0],bb],n.slice(1)),t),t=Ji(mc.sketch({dom:{classes:[bm.Breadcrumb]},components:o}));return Fi(e.element,t.element),e=ed(e.element),t=O(t.components(),function(e,n){return{component:e,width:ed(e.element),spec:o[n]}}),O(function(e,n){if(3===n.length)return n.slice(0,1);if(5===n.length)return Zn(Zn([],n.slice(0,2)),n.slice(4));if(e<p(n,function(e,n){return e+n.width},0)){var t=Zn(Zn([],n.slice(0,2)),n.slice(4));return p(t,function(e,n){return e+n.width},0)<=e?Zn(Zn([],n.slice(0,2)),n.slice(4)):vb(e,Zn(Zn([],n.slice(0,4)),n.slice(6)))}return Zn(Zn([],n.slice(0,2)),n.slice(4))}(e,t),function(e){return e.spec})}var Ty,Dy=function(n,e){return n.getSystem().getByUid(e.uid+"-"+dh()).map(function(e){return function(){return $.value(e)}}).getOrThunk(function(){return e.lazySink.fold(function(){return function(){return $.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(e){return function(){return e(n)}})})},ei=w([tn("dom"),tn("fetch"),Tn("onOpen"),In("onExecute"),pn("getHotspot",E.some),pn("getAnchorOverrides",w({})),Dn(),P("dropdownBehaviours",[ds,Lp,_f,ap]),tn("toggleClass"),pn("eventOrder",{}),ln("lazySink"),pn("matchWidth",!1),pn("useMinWidth",!1),ln("role")].concat([pn("sandboxClasses",[]),lc("sandboxBehaviours",[wp,pc,Xg,mp])])),Qr=w([Pu({schema:[Le()],name:"menu",defaults:function(e){return{onExecute:e.onExecute}}}),$o()]),By=A({name:"Dropdown",configFields:ei(),partFields:Qr(),factory:function(n,e,t,o){function r(e){Xg.getState(e).each(function(e){lh.highlightPrimary(e)})}var i,u={expand:function(e){ds.isOn(e)||wh(n,function(e){return e},e,o,b,zg.HighlightNone).get(b)},open:function(e){ds.isOn(e)||wh(n,function(e){return e},e,o,b,zg.HighlightFirst).get(b)},isOpen:ds.isOn,close:function(e){ds.isOn(e)&&wh(n,function(e){return e},e,o,b,zg.HighlightFirst).get(b)},repositionMenus:function(e){ds.isOn(e)&&function(e){e=Lp.getCoupled(e,"sandbox");Sh(e)}(e)}},a=function(e,n){return ft(e),E.some(!0)};return{uid:n.uid,dom:n.dom,components:e,behaviours:za(n.dropdownBehaviours,[ds.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),Lp.config({others:{sandbox:function(e){return Oh(n,e,{onOpen:function(){return ds.on(e)},onClose:function(){return ds.off(e)}})}}}),_f.config({mode:"special",onSpace:a,onEnter:a,onDown:function(e,n){var t;return By.isOpen(e)?(t=Lp.getCoupled(e,"sandbox"),r(t)):By.open(e),E.some(!0)},onEscape:function(e,n){return By.isOpen(e)?(By.close(e),E.some(!0)):E.none()}}),ap.config({})]),events:Wl(E.some(function(e){wh(n,function(e){return e},e,o,r,zg.HighlightFirst).get(b)})),eventOrder:Gn(Gn({},n.eventOrder),((a={})[Wr()]=["disabling","toggling","alloy.base.behaviour"],a)),apis:u,domModification:{attributes:Gn(Gn({"aria-haspopup":"true"},n.role.fold(function(){return{}},function(e){return{role:e}})),"button"===n.dom.tag?{type:(i="type",ae(n.dom,"attributes").bind(function(e){return ae(e,i)}).getOr("button"))}:{})}}},apis:{open:function(e,n){return e.open(n)},expand:function(e,n){return e.expand(n)},close:function(e,n){return e.close(n)},isOpen:function(e,n){return e.isOpen(n)},repositionMenus:function(e,n){return e.repositionMenus(n)}}}),Dn=function(e,n){tt(e.element,n.event().target())&&ct(e,Zr())},My={markers:{item:bm.MenuItem,selectedItem:bm.MenuItemUnselected,menu:bm.Menu,selectedMenu:bm.MenuSelected,backgroundMenu:bm.MenuBackground},dom:{tag:"div",classes:[bm.MenuContainer,bm.MenuBackdrop]},tmenuBehaviours:di([Ot("events",[dt(hr(),Dn),dt(Br(),Dn)])])},Iy=e({name:"ListTypeDropdown",factory:function(e){var t=Yt("menu");return By.sketch({dom:{tag:"button",classes:[bm.AssetsHeaderTh,bm.AssetsHeaderButton,bm.FocusStop]},components:[{dom:{tag:"span"},components:[sp("list"===e.listType?"List":"Grid")]},ip.sketch({iconHtml:Dm,classes:[bm.AssetsHeaderButtonChevron]})],toggleClass:bm.ButtonSelected,parts:{menu:My},lazySink:e.lazySink,matchWidth:!0,fetch:function(){return $u(E.some(lh.singleData("basic-list",{uid:t,dom:{tag:"div",classes:[bm.Menu,bm.MenuHasIcons]},components:[uh.parts.items({})],items:[Lh(Km,"List","list"),Lh(Rm,"Grid","grid")]})))},onExecute:function(e,n){n=mp.getValue(n);st(e,t+"execute-event",{item:n})},onOpen:Ch(t),sandboxBehaviours:di([Ot("dropdown-sandbox-events",[dt(t+"execute-event",function(e,n){var t=n.event.item,n=mp.getValue(e);ap.focus(n),Du(e,Fu("grid"===t.value?"grid":"list")),ct(e,Zr())})])])})},configFields:[tn("listType"),tn("lazySink")]}),_y=e({name:"FileListHeader",factory:function(e){var n=e.lazySink,c=Lc(Op.sketch({classes:[bm.AssetActionSelect],onCheckedChange:function(e){Du(e,function(e,n,t){n().fileState.files.length===n().selectedFiles.length?e({type:"selectedFiles.clear",payload:""}):yp()(e,n,t)})},checkedIcon:ep,uncheckedIcon:op})),s=Lc(Th("Name","name")),f=Lc(Th("Size","size")),l=Lc(cp.sketch({dom:{tag:"button",classes:[bm.AssetsHeaderButton]},components:[sp("Location")]})),d=Lc(Th("Last modified","date")),m=Lc(Iy.sketch({lazySink:n,listType:"list"}));return{uid:e.uid,dom:{tag:"header",classes:[bm.AssetsHeader]},components:[Fh(c.asSpec()),Fh(s.asSpec(),[bm.AssetsHeaderThName]),Fh(f.asSpec()),Fh(d.asSpec()),Fh(m.asSpec())],behaviours:di([_f.config({mode:"flow",allowVertical:!1,selector:"."+bm.FocusStop}),pp.config({}),ss.config({}),pc.config({channels:((e={})["channel.main"]=Tu(function(e,n){var t=0!==n.state.selectedFiles.length&&n.state.selectedFiles.length===n.state.fileState.files.length,o=n.state,r=o.sortOrder,i=o.sortBy,u=o.listType,o=o.viewType,r=(r=r,ip.sketch({iconHtml:Sm,classes:"desc"===r?[bm.AssetsHeaderButtonArrowDesc]:[]}));"starred"===o||n.state.query.isSome()?ss.replaceAt(e,2,E.some(Fh(l.asSpec()))):ss.replaceAt(e,2,E.some(Fh(f.asSpec())));function a(){return ss.set(e,"grid"===n.state.listType?[Fh(s.asSpec(),[bm.AssetsHeaderThName]),Fh(m.asSpec())]:[Fh(c.asSpec()),Fh(s.asSpec(),[bm.AssetsHeaderThName]),Fh(f.asSpec()),Fh(d.asSpec()),Fh(m.asSpec())])}n.state.listType!==n.oldState.listType&&Ka(e.element).fold(a,function(){a(),m.getOpt(e).each(ap.focus)}),s.getOpt(e).each(Dh(r,"name"===i)),f.getOpt(e).each(Dh(r,"size"===i)),d.getOpt(e).each(Dh(r,"date"===i)),m.getOpt(e).each(function(e){Rt(e.components()[0].element,"list"===u?"List":"Grid")}),c.getOpt(e).each(function(e){xp.getField(e).each(function(e){e.element.dom.checked=t})})}),e)})])}},configFields:[tn("lazySink")]}),Ey=function(e,n){return{type:Ku.Push,payload:{operation:e,files:n}}},Ay=pr().browser,Le=function(r){return function(e){return function(n,t,o){(r?o.star:o.unstar)(e).get(function(e){return e.fold(fu(n),function(e){return Su(n,t,o)})})}}},zy=Le(!0),Py=Le(!1),$o=ke([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),Ny=$o.offset,Vy=$o.absolute,Ry=$o.fixed,Hy=function(e,n,r,i,u){var t=n.getSnapPoints(e);return tv(t,r,i,u).orThunk(function(){return p(t,function(n,t){var e=t.sensor,o=function(e,n,t,o){e=Zh(e,t,o),t=Zh(n,t,o),o=Math.abs(e.left-t.left),t=Math.abs(e.top-t.top);return Tp(o,t)}(r,e,(t.range.left,t.range.top,i),u);return n.deltas.fold(function(){return{deltas:E.some(o),snap:E.some(t)}},function(e){return(o.left+o.top)/2<=(e.left+e.top)/2?{deltas:E.some(o),snap:E.some(t)}:n})},{deltas:E.none(),snap:E.none()}).snap.map(function(e){return{output:Xh(e.output,r,i,u),extra:e.extra}})})},Uy=function(e,n,t,o,r){e=n.getSnapPoints(e);return tv(e,t,o,r)},ei=Object.freeze({__proto__:null,snapTo:function(e,n,t,o){var r,i=n.getTarget(e.element);n.repositionTarget&&(r=Lt(e.element),n=ud(r),e=jh(i),r=n,n=e,o={coord:Xh((o=o).output,o.output,r,n),extra:o.extra},e=Yh(o.coord,0,e),Fo(i,e))}}),jy="data-initial-z-index",Qr=mn("snaps",[tn("getSnapPoints"),Tn("onSensor"),tn("leftAttr"),tn("topAttr"),pn("lazyViewport",dd),pn("mustSnap",!1)]),Dn=[pn("useFixed",s),tn("blockerClass"),pn("getTarget",l),pn("onDrag",b),pn("repositionTarget",!0),pn("onDrop",b),Rn("getBounds",dd),Qr],Le=function(e){return function(n,t){function o(e){t.setStartData(sv(n,e))}return ii(qn([dt(Yr(),function(e){t.getStartData().each(function(){return o(e)})})],e(n,t,o)))}},Wy=Object.freeze({__proto__:null,getData:function(e){return E.from(Tp(e.x,e.y))},getDelta:function(e,n){return Tp(n.left-e.left,n.top-e.top)}}),$o=qn(Dn,[ba("dragger",{handlers:Le(dv)})]),Gy=Object.freeze({__proto__:null,getData:function(e){e=e.raw.touches;return 1===e.length?function(e){e=e[0];return E.some(Tp(e.clientX,e.clientY))}(e):E.none()},getDelta:function(e,n){return Tp(n.left-e.left,n.top-e.top)}}),Qr=qn(Dn,[ba("dragger",{handlers:Le(mv)})]),Le=qn(Dn,[ba("dragger",{handlers:Le(function(e,n,t){return qn(dv(e,n,t),mv(e,n,t))})})]),Ky=St({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:$o,touch:Qr,mouseOrTouch:Le}),name:"dragging",active:{events:function(e,n){return e.dragger.handlers(e,n)}},extra:{snap:function(e){return{sensor:e.sensor,range:e.range,output:e.output,extra:E.from(e.extra)}}},state:Object.freeze({__proto__:null,init:function(){var r=E.none(),n=E.none(),e=w({});return Un({readState:e,reset:function(){r=E.none(),n=E.none()},update:function(o,e){return o.getData(e).bind(function(e){return n=o,t=e,e=r.map(function(e){return n.getDelta(e,t)}),r=E.some(t),e;var n,t})},getStartData:function(){return n},setStartData:function(e){n=E.some(e)}})}}),apis:ei}),In=w([tn("lazySink"),ln("dragBlockClass"),Rn("getBounds",dd),pn("useTabstopAt",x),pn("eventOrder",{}),P("modalBehaviours",[_f]),In("onExecute"),Qo("onEscape")]),Qo={sketch:l},Nu=w([Nu({name:"draghandle",overrides:function(e,n){return{behaviours:di([Ky.config({mode:"mouse",getTarget:function(e){return zc(e,'[role="dialog"]').getOr(e)},blockerClass:e.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:e.getDragBounds})])}}}),ic({schema:[tn("dom")],name:"title"}),ic({factory:Qo,schema:[tn("dom")],name:"close"}),ic({factory:Qo,schema:[tn("dom")],name:"body"}),Nu({factory:Qo,schema:[tn("dom")],name:"footer"}),Pu({factory:{sketch:function(e,n){return Gn(Gn({},e),{dom:n.dom,components:n.components})}},schema:[pn("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),pn("components",[])],name:"blocker"})]),Qo=Object.freeze({__proto__:null,block:function(e,n,t,o){Ut(e.element,"aria-busy",!0);var r=n.getRoot(e).getOr(e),i=di([_f.config({mode:"special",onTab:function(){return E.some(!0)},onShiftTab:function(){return E.some(!0)}}),ap.config({})]),i=o(r,i),u=r.getSystem().build(i);ss.append(r,Yi(u)),u.hasConfigured(_f)&&_f.focusIn(u),t.isBlocked()||n.onBlock(e),t.blockWith(function(){return ss.remove(r,u)})},unblock:function(e,n,t){Kt(e.element,"aria-busy"),t.isBlocked()&&n.onUnblock(e),t.clear()}}),Pu=[Rn("getRoot",E.none),Tn("onBlock"),Tn("onUnblock")],qy=xt({fields:Pu,name:"blocking",apis:Qo,state:Object.freeze({__proto__:null,init:function(){var n=pv();return Un({readState:n.isSet,blockWith:function(e){n.set({destroy:e})},clear:n.clear,isBlocked:n.isSet})}})}),Zy=A({name:"ModalDialog",configFields:In(),partFields:Nu(),factory:function(i,e,n,o){var r=kt(E.none()),t=Yt("modal-events"),u=Gn(Gn({},i.eventOrder),((u={})[Xr()]=[t].concat(i.eventOrder["alloy.system.attached"]||[]),u));return{uid:i.uid,dom:i.dom,components:e,apis:{show:function(e){r.set(E.some(e));var n=i.lazySink(e).getOrDie(),t=o.blocker(),t=n.getSystem().build(Gn(Gn({},t),{components:t.components.concat([Yi(e)]),behaviours:di([ap.config({}),Ot("dialog-blocker-events",[(t=Cr(),mt(t)(function(){_f.focusIn(e)}))])])}));Va(n,t),_f.focusIn(e)},hide:function(n){r.set(E.none()),Dt(n.element).each(function(e){n.getSystem().getByDom(e).each(function(e){Ha(e)})})},getBody:function(e){return Ba(e,i,"body")},getFooter:function(e){return Ba(e,i,"footer")},setIdle:function(e){qy.unblock(e)},setBusy:function(e,n){qy.block(e,n)}},eventOrder:u,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:za(i.modalBehaviours,[ss.config({}),_f.config({mode:"cyclic",onEnter:i.onExecute,onEscape:i.onEscape,useTabstopAt:i.useTabstopAt}),qy.config({getRoot:r.get}),Ot(t,[ui(function(e){var n,t,o,r;n=e.element,t=Ba(e,i,"title").element,o=Gt(n,"id").fold(function(){var e=Yt("dialog-label");return Ut(t,"id",e),e},l),Ut(n,"aria-labelledby",o),o=e.element,r=Ba(e,i,"body").element,e=E.from(Wt(o,"id")).fold(function(){var e=Yt("dialog-describe");return Ut(r,"id",e),e},l),Ut(o,"aria-describedby",e)})])])}},apis:{show:function(e,n){e.show(n)},hide:function(e,n){e.hide(n)},getBody:function(e,n){return e.getBody(n)},getFooter:function(e,n){return e.getFooter(n)},setBusy:function(e,n,t){e.setBusy(n,t)},setIdle:function(e,n){e.setIdle(n)}}}),Jy=[P("formBehaviours",[mp])],Yy=function(o,e){return{uid:o.uid,dom:o.dom,components:e,behaviours:za(o.formBehaviours,[mp.config({store:{mode:"manual",getValue:function(e){var n,t,n=(n=o,t=e.getSystem(),oe(n.partUids,function(e,n){return w(t.getByUid(e))}));return oe(n,function(e,o){return e().bind(function(e){var n,t=wp.getCurrent(e);return t=t,n=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+Jt(e.element)),t.fold(function(){return $.error(n)},$.value)}).map(mp.getValue)})},setValue:function(t,e){te(e,function(n,e){Da(t,o,e).each(function(e){wp.getCurrent(e).each(function(e){mp.setValue(e,n)})})})}}})]),apis:{getField:function(e,n){return Da(e,o,n).bind(wp.getCurrent)}}}},Xy={getField:eo(function(e,n,t){return e.getField(n,t)}),sketch:function(e){var o,n=(o=[],{field:function(e,n){return o.push(e),t="form",e=gv(e),n=n,{uiType:ec(),owner:t,name:e,config:n,validated:{}};var t},record:function(){return o}}),e=e(n),n=n.record(),n=O(n,function(e){return ic({name:e,pname:gv(e)})});return Ea("form",Jy,n,Yy,e)}},$y=["input","textarea"],In=Object.freeze({__proto__:null,markValid:vv,markInvalid:yv,query:bv,run:wv,isInvalid:function(e,n){e=n.getRoot(e).getOr(e.element);return yo(e,n.invalidClass)}}),Nu=Object.freeze({__proto__:null,events:function(n,e){return n.validator.map(function(e){return ii([dt(e.onEvent,function(e){wv(e,n).get(l)})].concat(e.validateOnLoad?[ui(function(e){wv(e,n).get(b)})]:[]))}).getOr({})}}),Tn=[tn("invalidClass"),pn("getRoot",E.none),mn("notify",[pn("aria","alert"),pn("getContainer",E.none),pn("validHtml",""),Tn("onValid"),Tn("onInvalid"),Tn("onValidate")]),mn("validator",[tn("validate"),pn("onEvent","input"),pn("validateOnLoad",!0)])],Qy=xt({fields:Tn,name:"invalidating",active:Nu,apis:In,extra:{validation:function(n){return function(e){e=mp.getValue(e);return $u(n(e))}}}}),eb=/[<>:"\/\\|?*\x00-\x1F]/g,nb=e({name:"FileActions",factory:function(l){var t=Yt("menu");return By.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonNaked,bm.ButtonIcon,bm.AssetActionMore,bm.FocusStop]},components:[ip.sketch({iconHtml:Zm})],toggleClass:bm.ButtonSelected,parts:{menu:My},lazySink:l.lazySink,matchWidth:!0,fetch:function(){var e=h([l.insert?[Ev(Tm,"Insert",0,"insert")]:[],"grid"===l.listType||kh()?[Ev(Ym,"Preview",0,"preview")]:[]]),n=[0<e.length?e.concat([_v()]):[],l.file.starred?[Ev(tp,"Unstar",0,"unstar")]:[Ev(np,"Star",0,"star")],[Ev(Em,"Download",0,"download")],[Ev(Xm,"Rename",0,"rename")],[Ev(Im,"Copy",0,"copy")],[Ev(Jm,"Move",0,"move")],[_v()],[Ev(_m,"Delete",0,"delete")]],e=[[Ev(Xm,"Rename",0,"rename")],[Ev(Jm,"Move",0,"move")],[_v()],[Ev(_m,"Delete",0,"delete")]];return $u(E.some(lh.singleData("basic-list",{uid:t,dom:{tag:"div",classes:[bm.Menu,bm.MenuHasIcons]},components:[uh.parts.items({})],items:h("directory"===l.file.type?e:n)})))},onExecute:function(e,n){n=mp.getValue(n);st(e,t+"execute-event",{item:n})},onOpen:Ch(t),sandboxBehaviours:di([Ot("dropdown-sandbox-events",[dt(t+"execute-event",function(e,n){function t(e,n){Du(e,n),ap.focus(f)}var o,r,i,u,a,c,s=n.event.item,f=mp.getValue(e);"insert"===s.value?t(e,(c=l.file.uuid,function(n,e,t){L(e().fileState.files,function(e){return e.uuid===c}).each(function(e){n(Uh([e]))})})):"delete"===s.value?Mv(l.lazySink).get(function(e){e&&Du(f,Rh(l.file.uuid)),ap.focus(f)}):"star"===s.value?t(e,zy([l.file.uuid])):"unstar"===s.value?t(e,Py([l.file.uuid])):"rename"===s.value?(o=l.lazySink,r=f,i=l.file,u=Ml(i.name),n="directory"===i.type?i.name:Bl(i.name,u),a="directory"===i.type?"":u,Dv(o,n).get(function(e){e.each(function(e){Du(r,zh(i.uuid,e+a))}),ap.focus(r)})):"copy"===s.value?t(e,Bh(l.file.uuid,"copy")):"move"===s.value?t(e,Bh(l.file.uuid,"move")):"download"===s.value?t(e,Ah(l.file.url,l.file.name)):"preview"===s.value&&t(e,du(l.file.uuid)),ct(e,Zr())})])])})},configFields:[cn("lazySink"),tn("file"),tn("listType"),an("insert")]}),tb=e({name:"FileListItem",factory:function(n){var t,e,o,r,i=Lc(nb.sketch({lazySink:n.lazySink,file:n.file,listType:n.listType,insert:n.insert})),u=Lc(Op.sketch({classes:[bm.AssetActionSelect],onCheckedChange:function(e){var o;Du(e,(o=n.file.uuid,function(e,n,t){L(n().selectedFiles,function(e){return e.uuid===o}).fold(function(){return hp(o)(e,n,t)},function(){return vp(o)(e,n,t)})}))},checkedIcon:ep,uncheckedIcon:op}));return{uid:n.uid,dom:{tag:"li",classes:[bm.Asset].concat("directory"===n.file.type?[bm.AssetFolder]:[]).concat("directory"!==n.file.type&&n.file.thumbUrl.isNone?[bm.AssetFile]:[])},components:"grid"===n.listType?(o=u,r=i,[Wv(e=n),{dom:{tag:"div",classes:[bm.AssetMetadata]},components:[o.asSpec(),Gv(e),r.asSpec()]}]):(r=(t=n).isSearching,i=i,[u.asSpec(),Wv(t),{dom:{tag:"div",classes:[bm.AssetMetadata]},components:[Gv(t),{dom:{tag:"span",classes:[bm.AssetSize]},components:[sp("starred"===t.viewType||r?t.file.path.getOr(""):Tl(t.file.size))]},{dom:{tag:"span",classes:[bm.AssetDate]},components:[fp(zv(t.file.modificationDate))]}]},{dom:{tag:"div",classes:[bm.AssetActions]},components:h(["directory"!==t.file.type?[cp.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonSecondary,bm.AssetActionPrimary,bm.FocusStop]},components:[sp("Preview")],action:function(e){return Du(e,du(t.file.uuid))}})]:[],[i.asSpec()]])}]),behaviours:di([_f.config({mode:"flow",allowVertical:!1,selector:"."+bm.FocusStop}),mp.config({store:{mode:"memory",initialValue:n.file.uuid}}),ap.config({ignore:!0,onFocus:function(e){u.getOpt(e).each(ap.focus)}})]),apis:{selectFileListItem:function(e){u.getOpt(e).each(function(e){e.components()[0].element.dom.checked=!0}),go(e.element,bm.AssetSelected)},deselectFileListItem:function(e){u.getOpt(e).each(function(e){e.components()[0].element.dom.checked=!1}),vo(e.element,bm.AssetSelected)},focus:function(e){u.getOpt(e).each(function(e){xp.getLabel(e).each(ap.focus)})}}}},configFields:[un("listType"),un("viewType"),an("isSearching"),an("insert"),fn("file",[un("type"),un("uuid"),un("name"),rn("size"),tn("modificationDate"),tn("starred"),tn("url"),tn("thumbUrl"),tn("path")]),cn("lazySink")],apis:{selectFileListItem:function(e,n){e.selectFileListItem(n)},deselectFileListItem:function(e,n){e.deselectFileListItem(n)},focus:function(e,n){e.focus(n)}}}),ob={set:rs().set,get:function(e){return Ka(e.element).bind(function(e){return Vc(e,"li",s)})}},rb=e({name:"FileList",factory:function(u){function a(n){return o.getOpt(n).each(function(e){return ss.remove(n,e)})}function c(e,t){return B(e).fold(function(){return B(t.components()).each(ap.focus)},function(n){return L(t.components(),function(e){return mp.getValue(e)===n.uuid}).each(function(e){tb.focus(e)})})}var s=kt("list"),o=Lc({dom:{tag:"div",classes:[bm.InfiniteLoadingIndicator]},components:[{dom:{tag:"div",classes:[bm.Spinner]},components:[{dom:{tag:"div"}},{dom:{tag:"div"}},{dom:{tag:"div"}}]}],behaviours:di([ap.config({}),mp.config({store:{mode:"memory",initialValue:"spinner"}})])}),f=Lc({dom:{tag:"ul",classes:[bm.Assets]},components:[],behaviours:di([ss.config({}),_f.config({mode:"flow",selector:"li",focusManager:ob}),pp.config({})])});return{uid:u.uid,dom:{tag:"div",classes:[bm.AssetsContainer].concat("grid"===s.get()?bm.Grid:bm.List)},components:[_y.sketch({lazySink:u.lazySink}),f.asSpec()],behaviours:Fe(di([ds.config({toggleClass:bm.AssetsHidden,toggleOnExecute:!1}),gp.config({events:[{native:"scroll",simulated:"bubbled.scroll"}]}),Ot("events",[dt("bubbled.scroll",function(e){!function(e){e=e.dom;return e.scrollTop+e.clientHeight+400>=e.scrollHeight}(e.element)||Du(e,Ou)})])]),Aa(u.fileListBehaviours)),apis:{setFiles:function(e,t,n,o,r){var i=h([o?[]:[$l()],O(t,Kv(u.lazySink,s.get(),n,r,u.insert))]);f.getOpt(e).each(function(e){Ka(e.element).fold(function(){a(e),ss.set(e,i)},function(n){L(e.components(),function(e){return rt(e.element,n)}).fold(function(){a(e),ss.set(e,i),c(t,e)},function(n){a(e),ss.set(e,i),L(e.components(),function(e){return mp.getValue(e)===mp.getValue(n)}).fold(function(){return c(t,e)},tb.focus)})})})},appendFiles:function(e,n,t,o){var r=O(n,Kv(u.lazySink,s.get(),t,o,u.insert));f.getOpt(e).each(function(n){a(n),k(r,function(e){ss.append(n,e)})})},setListMode:function(e,n){s.set(n);e=e.element;"grid"===s.get()?(vo(e,bm.List),go(e,bm.Grid)):(vo(e,bm.Grid),go(e,bm.List))},selectFile:function(e,n){L(e.components()[1].components(),function(e){return mp.getValue(e)===n.uuid}).each(function(e){return tb.selectFileListItem(e)})},deselectFile:function(e,n){L(e.components()[1].components(),function(e){return mp.getValue(e)===n.uuid}).each(function(e){return tb.deselectFileListItem(e)})},hideList:function(e){return ds.on(e)},showList:function(e){return ds.off(e)},loading:function(e,t){f.getOpt(e).each(function(e){var n=Ka(e.element).isSome();"done"!==t&&"reload"!==t&&("new"===t&&ss.set(e,[]),ss.append(e,o.asSpec()),n&&"append"!==t&&B(e.components()).each(ap.focus))})}}}},configFields:[P("fileListBehaviours",[]),an("insert"),cn("lazySink")],apis:{setFiles:function(e,n,t,o,r,i){e.setFiles(n,t,o,r,i)},appendFiles:function(e,n,t,o,r){e.appendFiles(n,t,o,r)},setListMode:function(e,n,t){e.setListMode(n,t)},selectFile:function(e,n,t){e.selectFile(n,t)},deselectFile:function(e,n,t){e.deselectFile(n,t)},hideList:function(e,n){e.hideList(n)},showList:function(e,n){e.showList(n)},loading:function(e,n,t){e.loading(n,t)}}}),ib=Yt("printpdf"),ub=pr(),ab=150/72,cb=pr(),sb=e({name:"PdfCanvas",factory:function(e){var n=kt(!1),u=se(function(e,n,t){return cy(e,n,t,"height").width>e.dom.clientWidth?"width":"height"});return{uid:e.uid,dom:{tag:"div",classes:[bm.PdfViewerCanvasContainer]},components:[{dom:{tag:"canvas",classes:[bm.PdfViewerCanvas],attributes:{style:"opacity: 0"}}}],apis:{setPage:function(o,r,i){var e;n.get()||(n.set(!0),e=$.fromOption(B(o.components()).map(function(e){return e.element}),"Failed to get canvas"),na.fromResult(e).bindFuture(function(e){var n=o.element,t=u(n,r,i);return sy(e,n,r,i,t)}).get(function(e){e.fold(Hu,function(e){n.set(!1)})}))}}}},configFields:[],apis:{setPage:function(e,n,t,o){e.setPage(n,t,o)}}}),fb=e({name:"PdfViewerControls",factory:function(e){return{uid:e.uid,dom:{tag:"div",classes:[bm.PreviewControls]},components:[fy(Um,e.onPrev,"Previous"),fy(Hm,e.onNext,"Next"),fy(Wm,e.onZoomIn,"Zoom in"),fy(Gm,e.onZoomOut,"Zoom out"),fy(jm,e.onPrint,"Print")]}},configFields:[Rn("onPrev",b),Rn("onNext",b),Rn("onZoomIn",b),Rn("onZoomOut",b),Rn("onPrint",b)]}),lb=e({name:"PdfViewer",factory:function(o){function r(e){$c(u.get(),i.getOpt(e),function(e,n){Zv(e,a.get()).get(function(e){e.fold(Hu,function(e){sb.setPage(n,e,c.get())})})})}function n(n,t){u.get().each(function(e){0<t&&t<=e.numPages&&(a.set(t),r(n))})}function t(e,n){.2<=n&&n<=2.2&&(c.set(n),r(e))}var i=Lc(sb.sketch({})),u=kt(E.none()),a=kt(1),c=kt(.9);return{uid:o.uid,dom:{tag:"div",classes:[bm.PdfViewer]},components:[i.asSpec(),fb.sketch({onPrev:function(e){return n(e,a.get()-1)},onNext:function(e){return n(e,a.get()+1)},onZoomIn:function(e){return t(e,(100*c.get()+20)/100)},onZoomOut:function(e){return t(e,(100*c.get()-20)/100)},onPrint:function(e){e=e,i.getOpt(e).each(function(n){qv(o.baseUrl,function(e){ry(n.element,e,o.url).get(function(e){e.fold(Hu,b)})})})}})],behaviours:di([Ot("PdfViewer",[ui(function(t){qv(o.baseUrl,function(e){Jv(e,o.url).get(function(e){e.fold(Hu,function(e){var n;Du(t,mu(E.some("N/A"))),n=t,e=e,u.set(E.some(e)),r(n)})})})}),ai(function(){u.get().each(function(e){return e.cleanup()})})])])}},configFields:[tn("url"),un("baseUrl")]}),db=e({name:"PreviewForm",factory:function(t){return Xy.sketch(function(e){return{dom:{tag:"aside",classes:[bm.Details]},components:[{dom:{tag:"div",classes:bm.Form},components:Zn(Zn([e.field("description",ly(t.file.uuid,"Description")),e.field("fileName",my("File name")),e.field("type",my("Type"))],(n=t.file,_l(n.name).exists(function(e){return"image"===e||"video"===e})?[e.field("dimensions",my("Dimensions"))]:[])),[e.field("modificationDate",my("Modification date")),e.field("createdBy",my("Created by"))])}]};var n})},configFields:[tn("file")],apis:{set:function(e,n,t,o,r){mp.setValue(n,{dimensions:r.getOr("Loading..."),createdBy:o.createdBy.getOr("N/A"),description:o.description,fileName:t.name,modificationDate:zv(t.modificationDate),type:(o=t.name,_l(o).fold(w("File"),function(e){switch(e){case"image":return"Image file";case"document":return"Document file";case"audio":return"Audio file";case"video":return"Video file";case"archive":return"Archive file";default:return"Unknown file"}}))}),t.starred&&B(n.components()).bind(function(e){return D(e.components(),1)}).bind(function(e){return M(e.components())}).each(function(e){lp.setText(e,t.name,t.starred)})}}}),mb=e({name:"Preview",factory:function(n){var e,o=Lc(db.sketch({file:n.file}));return{uid:n.uid,dom:{tag:"div",classes:[bm.PreviewContainer]},components:[mc.sketch({dom:{tag:"div",classes:[bm.Preview]},components:[function(n,t){switch(n.type){case"image":return n.url.map(gy);case"video":return n.url.map(function(e){return hy(n.name,e)});case"document":return"pdf"===Il(n.name)?n.url.map(function(e){return lb.sketch({url:e,baseUrl:t})}):E.none();default:return E.none()}}(n.file,n.baseUrl).getOrThunk(function(){return vy(n.file.type)})],containerBehaviours:di([ss.config({}),Ot("mediaPreview",[dt("bubbled.error",function(e){ss.replaceBy(e,x,E.some(vy(n.file.type))),py(e,E.none())})])])}),o.asSpec()],behaviours:di([pc.config({channels:((e={})["channel.main"]=Tu(function(e,t){o.getOpt(e).each(function(n){t.state.preview.each(function(e){db.set(n,e.file,e.meta,e.dimensions)})})}),e)}),Ot("Preview",[ui(function(e){o.getOpt(e).each(function(e){db.set(e,n.file,n.meta,E.none())})})])])}},configFields:[un("uid"),tn("file"),tn("meta"),un("baseUrl")]}),In=function(t){return function(n,e){te(t,function(e){vo(n,e)}),ae(t,e).each(function(){return go(n,t[e])})}},pb=e({name:"ProgressBar",factory:function(e){return{uid:e.uid,dom:{tag:"div",classes:[bm.Progressbar]},components:[{dom:{tag:"div",attributes:{style:"width: "+e.percent+"%"},classes:[bm.ProgressbarProgress]},components:[]}],apis:{setPercent:function(e,n){_t(e.element).each(function(e){Co(e,"width",n+"%")})}},behaviours:Aa(e.progressBehaviours)}},configFields:[hn("percent",0),P("progressBehaviours",[])],apis:{setPercent:function(e,n,t){e.setPercent(n,t)}}}),gb=In(((Rn={}).done=bm.UploadDone,Rn.uploading=bm.UploadUploading,Rn.idle=bm.UploadIdle,Rn)),hb=e({name:"Upload",factory:function(e){var o=kt("idle"),t=Lc(lp.sketch({classes:[bm.UploadLabel],text:""})),r=Lc(pb.sketch({percent:0})),i=[t.asSpec(),r.asSpec()],u=[ip.sketch({iconHtml:Tm,classes:[bm.UploadIcon]}),t.asSpec(),r.asSpec()];return{uid:e.uid,dom:{tag:"div",classes:[bm.Upload]},components:[],behaviours:Fe(di([ss.config({})]),Aa(e.uploadStatusBehaviours)),apis:{setText:function(e,n){t.getOpt(e).each(function(e){lp.setText(e,n)})},setStatus:function(e,n){var t;n!==o.get()&&(t=n,gb((e=e).element,t),"uploading"===t?ss.set(e,i):"idle"===t?ss.set(e,[]):"done"===t&&ss.set(e,u),o.set(n))},setProgress:function(e,n){r.getOpt(e).each(function(e){pb.setPercent(e,n)})}}}},configFields:[P("uploadStatusBehaviours",[])],apis:{setText:function(e,n,t){e.setText(n,t)},setStatus:function(e,n,t){e.setStatus(n,t)},setProgress:function(e,n,t){e.setProgress(n,t)}}}),vb=function(e,n){if(5===n.length)return n;if(e<=p(n,function(e,n){return e+n.width},0)){var t=Zn(Zn([],n.slice(0,4)),n.slice(6));return p(t,function(e,n){return e+n.width},0)<=e?Zn(Zn([],n.slice(0,4)),n.slice(6)):vb(e,Zn(Zn([],n.slice(0,4)),n.slice(6)))}return n},yb=e({name:"BreadcrumbDropdown",factory:function(e){var t=Yt("menu"),n="starred"===e.viewType?ip.sketch({iconHtml:qm,classes:[bm.LocationIcon]}):ip.sketch({iconHtml:Nm,classes:[bm.LocationIcon]}),o=Lc(By.sketch({dom:{tag:"button",classes:[bm.LocationButton]},components:Cy(e.viewType),toggleClass:bm.ButtonSelected,parts:{menu:My},lazySink:e.lazySink,matchWidth:!0,dropdownBehaviours:di([pp.config({})]),fetch:function(){return $u(E.some(lh.singleData("basic-list",{uid:t,dom:{tag:"div",classes:[bm.Menu,bm.MenuHasIcons]},components:[uh.parts.items({})],items:[ky(Nm,"Files","all"),ky(np,"Starred","starred")]})))},onExecute:function(e,n){n=mp.getValue(n);st(e,t+"execute-event",{item:n})},onOpen:Ch(t),sandboxBehaviours:di([Ot("dropdown-sandbox-events",[dt(t+"execute-event",function(e,n){var t=n.event.item,n=mp.getValue(e);ap.focus(n),"all"===t.value?Du(e,Oy("all")):"starred"===t.value&&Du(e,Oy("starred")),ct(e,Zr())})])])}));return{uid:e.uid,dom:{tag:"div",classes:[bm.Location].concat("starred"===e.viewType?[bm.LocationStarred]:[bm.LocationFiles])},components:[n,o.asSpec()],behaviours:di([ap.config({onFocus:function(e){o.getOpt(e).each(ap.focus)}})])}},configFields:[tn("viewType"),tn("lazySink")]}),bb={dom:{tag:"span",innerHtml:"..."}},Rn=ip.sketch({iconHtml:Bm}),wb=e({name:"BreadCrumbs",factory:function(i){return{uid:i.uid,dom:{tag:"div",classes:[bm.NavbarContainer]},behaviours:Fe(di([ap.config({}),ss.config({})]),Aa(i.breadcrumbsBehaviours)),apis:{setItems:function(e,n,t){function o(){return ss.set(e,r)}var r=0===n.length?[yb.sketch({viewType:t,lazySink:i.lazySink})]:[(n=Fy(e,Ly(n),i.separator),{dom:{tag:"div",classes:[bm.Breadcrumb]},components:n,behaviours:di([pp.config({}),ap.config({onFocus:function(e){B(e.components()).each(ap.focus)}}),_f.config({mode:"flow",allowVertical:!1,selector:"."+bm.FocusStop}),ss.config({})])})];Ka(e.element).fold(o,function(){o(),B(e.components()).each(ap.focus)})}}}},configFields:[pn("separator",Rn),sn("components","no!!"),tn("lazySink"),P("breadcrumbsBehaviours",[])],apis:{setItems:function(e,n,t,o){e.setItems(n,t,o)}}});(Rn=Ty=Ty||{}).JSON="json",Rn.Blob="blob",Rn.Text="text",Rn.FormData="formdata",Rn.MultipartFormData="multipart/form-data";function xb(t){return Xu(function(n){var e=new FileReader;e.onload=function(e){e=e.target?e.target.result:"";n(e)},e.readAsText(t)})}function Sb(e){try{var n=JSON.parse(e);return $.value(n)}catch(e){return $.error("Response was not JSON.")}}function Ob(e){return $u(e.response)}function kb(e,n){switch(e){case Ty.JSON:return Sb(n.response).fold(function(){return Ob(n)},$u);case Ty.Blob:return t=n,E.from(t.response).map(xb).getOr($u("no response content"));case Ty.Text:default:return Ob(n)}var t}function Cb(e,n){function t(){return na.pure(n.response)}function o(e){return na.error({message:e,status:n.status,responseText:n.responseText})}switch(e){case Ty.JSON:return Sb(n.response).fold(o,na.pure);case Ty.Blob:case Ty.Text:return t();default:return o("unknown data type")}}function Lb(e){var n=(r=e.body,E.from(r).bind(function(e){switch(e.type){case Ty.JSON:return E.some("application/json");case Ty.FormData:return E.some("application/x-www-form-urlencoded; charset=UTF-8");case Ty.MultipartFormData:return E.none();case Ty.Text:default:return E.some("text/plain")}})),t=!0===e.credentials?E.some(!0):E.none(),o=function(e){switch(e){case Ty.Blob:return"application/octet-stream";case Ty.JSON:return"application/json, text/javascript";case Ty.Text:return"text/plain";default:return""}}(e.responseType)+", */*; q=0.01",r=void 0!==e.headers?e.headers:{};return{contentType:n,responseType:function(e){switch(e){case Ty.JSON:return E.none();case Ty.Blob:return E.some("blob");case Ty.Text:return E.some("text");default:return E.none()}}(e.responseType),credentials:t,accept:o,headers:r,progress:W(e.progress)?E.some(e.progress):E.none()}}function Fb(e){var t=new FormData;return te(e,function(e,n){t.append(n,e)}),t}function Tb(u){return na.nu(function(o){var t,r=new XMLHttpRequest;r.open(u.method,(t=u.url,E.from(u.query).map(function(e){var n=ie(e,function(e,n){return encodeURIComponent(n)+"="+encodeURIComponent(e)}),e=Xn(t,"?")?"&":"?";return 0<n.length?t+e+n.join("&"):t}).getOr(t)),!0);var i,e=Lb(u);i=r,(e=e).contentType.each(function(e){return i.setRequestHeader("Content-Type",e)}),i.setRequestHeader("Accept",e.accept),e.credentials.each(function(e){return i.withCredentials=e}),e.responseType.each(function(e){return i.responseType=e}),e.progress.each(function(n){return i.upload.addEventListener("progress",function(e){return n(e.loaded,e.total)})}),te(e.headers,function(e,n){return i.setRequestHeader(n,e)});function n(){var n,e,t;n=u.url,e=u.responseType,kb(e,t=r).map(function(e){return{message:0===t.status?"Unknown HTTP error (possible cross-domain request)":"Could not load url "+n+": "+t.statusText,status:t.status,responseText:e}}).get(function(e){return o($.error(e))})}r.onerror=n,r.onload=function(){var e;0===r.status&&(e=u.url,!Yn(e,"file:",0))||r.status<100||400<=r.status?n():Cb(u.responseType,r).get(o)},e=u.body,E.from(e).map(function(e){return e.type===Ty.JSON?JSON.stringify(e.data):e.type===Ty.FormData||e.type===Ty.MultipartFormData?Fb(e.data):e.data}).fold(function(){return r.send()},function(e){r.send(e)})})}function Db(){return{type:Ty.Text,data:""}}function Bb(e){return Tb(Gn(Gn({},e),{method:"get",body:Db()}))}function Mb(e,n){W(e.progress)&&e.progress(n)}function Ib(f){return na.nu(function(a){function c(e,n){a($.error({message:e,status:n,responseText:""}))}function s(e){c("Could not load url "+f.url,500)}function n(e){var n,t,o=e.body,r=[],i=0,u=(e=e.headers,E.from(e.get("content-type")).map(function(e){return e.split(";")[0]}));Mb(f,0),o?(n=o.getReader(),t=function(e){e.done?a($.value(new Blob(r,{type:u.getOr("")}))):(r.push(e.value),i+=e.value.length,Mb(f,i),n.read().then(t).catch(s))},n.read().then(t).catch(s)):c("Failed to get response body",500)}window.fetch(f.url,{method:"get",headers:f.headers,credentials:f.credentials?"include":"omit"}).then(function(e){e.status<100||400<=e.status?c("Could not load url "+f.url,e.status):n(e)}).catch(s)})}function _b(e){return ae(hi,"fetch").exists(W)?Ib(e):(Mb(n=e,0),Bb({url:n.url,responseType:Ty.Blob,headers:n.headers}).mapResult(function(e){return Mb(n,e.size),e}));var n}function Eb(n){return{name:n.name,downloadSize:n.bytes,uploadSize:n.bytes,getBlob:function(e){return _b({url:n.link,progress:e})},uuid:Yt("googledrive")}}function Ab(n,e,t,o){var r;r=e,Jb.set(Jb.get().fold(function(){return E.some(Uu("https://www.dropbox.com/static/api/2/dropins.js",{id:"dropboxjs","data-app-key":r}).toLazy())},E.some)),Jb.get().each(function(e){e.get(function(e){e.fold(function(e){return o([e])},function(e){ae(hi,"Dropbox").fold(function(){return o(["Failed to get dropbox chooser"])},function(e){e.choose({success:function(e){Vl(n,O(e,Eb)).fold(o,t)},cancel:b,linkType:"direct",extensions:zl(n),multiselect:!0,folderselect:!1,sizeLimit:cm})})})})})}function zb(n){return na.nu(function(e){gapi.load("picker",function(){e($.value(n))})})}function Pb(n,r){return e=Yb.get().getOrThunk(function(){var e=Uu("https://apis.google.com/js/api.js",{}).mapError(function(e){return"failed_api_load"}).toLazy();return Yb.set(E.some(e)),e}),na.nu(function(n){e.get(function(e){return n(e)})}).bindFuture(function(e){return t=n,o=r,na.nu(function(n){gapi.load("auth2",function(){Xb.get().fold(function(){gapi.auth2.authorize({client_id:t,scope:o.join(" ")},function(e){e.error?n($.error(e.error)):(Xb.set(E.some(e.access_token)),n($.value(e.access_token)))})},function(e){n($.value(e))})})});var t,o}).bindFuture(zb);var e}function Nb(e){return E.from(function(e,n){for(var t=null!=n?n:hi,o=0;o<e.length&&null!=t;++o)t=t[e[o]];return t}(["exportLinks","application/pdf"],e))}function Vb(e){return ae(e,"size").getOr(0)}function Rb(n){k(nt(".picker"),function(e){return Co(e,"z-index",String(n+1)),0})}function Hb(n,t,e,o,r){return(new google.picker.PickerBuilder).addView(google.picker.ViewId.DOCS).enableFeature(google.picker.Feature.NAV_HIDDEN).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setTitle("Pick a file to import to Tiny Drive").setOAuthToken(t).setDeveloperKey(e).setCallback(function(e){"loaded"===e.action&&Rb(n),e.action===google.picker.Action.PICKED&&Af(e.docs,function(e){return n=t,e=e.id,Bb({url:"https://www.googleapis.com/drive/v3/files/"+e+"?fields=id,name,size,exportLinks,mimeType",responseType:Ty.JSON,headers:{Authorization:"Bearer "+n}}).mapError(function(e){return e.message}).mapResult(function(e){return Qb(n,e)});var n}).get(function(e){Dl(e).fold(r,o)})})}function Ub(u){Pb(u.clientId,$b).get(function(e){var n,t,o,r,i;e.fold(function(e){"popup_closed_by_user"===e?u.success([]):"failed_api_load"===e?u.failure(["Failed to load google drive api."]):u.failure(["Failed to authenticate against google drive."])},(n=u.zIndex,t=u.fileTypes,o=u.developerKey,r=function(e){return Vl(u.fileTypes,e).fold(u.failure,u.success)},i=u.failure,function(e){(0===t.length||S(t,"document")?Hb(n,e,o,r,i):Hb(n,e,o,r,i).setSelectableMimeTypes(Pl(t).join(","))).build().setVisible(!0),Rb(n)}))})}function jb(e,n,t){return{type:"item",data:{meta:{text:n},value:t},dom:{tag:"div"},components:[ip.sketch({iconHtml:e,classes:[bm.MenuIcon]}),lp.sketch({text:n,classes:[bm.MenuLabel]})]}}function Wb(n,t,o){return function(e){Du(n,Ul(e,t,o)),ap.focus(n)}}function Gb(t){return function(e){k(e,function(e){var n;Du(t,(n=e,function(e){return e(su(n))}))}),ap.focus(t)}}function Kb(e,n,t,o){!function(n,e,t,o){ew.get().each(Ti);var r=Wn.fromHtml('<input type="file" multiple>');ew.set(E.some(r)),Ut(r,"accept",zl(n).join(",")),Lo(r,{opacity:"0",position:"fixed",top:"0",left:"0"}),Ho(r,"change",function(){var e=r.dom.files,e=J(e||[]);Vl(n,Hl(e)).fold(o,t)}),Fi(e,r),r.dom.click()}(t,e,Wb(n,t,o),Gb(n))}function qb(e,n,t){return{type:"item",data:{meta:{text:n},value:t},dom:{tag:"div"},components:[ip.sketch({iconHtml:e,classes:[bm.MenuIcon]}),lp.sketch({text:n,classes:[bm.MenuLabel]})]}}var Zb,Jb=kt(E.none()),Yb=kt(E.none()),Xb=kt(E.none()),$b=["https://www.googleapis.com/auth/drive.readonly"],Qb=function(n,t){var e,o=Nb(t).orThunk(function(){return e=t,E.from("https://www.googleapis.com/drive/v3/files/"+e.id+"?alt=media");var e});return{name:Nb(e=t).fold(w(e.name),w(e.name+".pdf")),downloadSize:Vb(t),uploadSize:Vb(t),getBlob:function(e){return e(0),_b({url:o.getOr(""),progress:e,headers:{Authorization:"Bearer "+n}})},uuid:Yt("googledrive")}},ew=kt(E.none()),nw=e({name:"InsertDropdown",factory:function(e){var r=e.lazySink,i=e.maxImageDimension,u=e.fileTypes,a=e.googleDriveClientId,c=e.googleDriveDeveloperKey,s=e.dropboxAppKey,f=e.zIndex,t=Yt("menu");return By.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonIcon],attributes:{title:"Upload/Create"}},components:[ip.sketch({iconHtml:wm,classes:[]})],toggleClass:bm.ButtonSelected,parts:{menu:My},lazySink:r,dropdownBehaviours:di([pp.config({})]),matchWidth:!0,fetch:function(){return $u(E.some(lh.singleData("basic-list",{uid:t,dom:{tag:"div",classes:[bm.Menu,bm.MenuHasIcons]},components:[uh.parts.items({})],items:Zn(Zn(Zn([jb(rp,"Upload file","upload")],s.fold(function(){return[]},function(e){return[jb(zm,"Dropbox","dropbox")]})),$c(a,c,l).fold(function(){return[]},function(e){return[jb(Vm,"Google Drive","googledrive")]})),[jb(xm,"Create folder","createFolder")])})))},onExecute:function(e,n){n=mp.getValue(n);st(e,t+"execute-event",{item:n})},onOpen:Ch(t),sandboxBehaviours:di([Ot("dropdown-sandbox-events",[dt(t+"execute-event",function(e,n){var t=n.event.item,o=mp.getValue(e);r(e).each(function(e){var n;"upload"===t.value?Kb(e.element,o,u,i):"dropbox"===t.value?Ab((n={hotspot:o,maxImageDimension:i,dropboxAppKey:s,fileTypes:u}).fileTypes,n.dropboxAppKey.getOr(""),Wb(n.hotspot,n.fileTypes,n.maxImageDimension),Gb(n.hotspot)):"googledrive"===t.value?Ub({zIndex:(n={hotspot:o,maxImageDimension:i,googleDriveClientId:a,googleDriveDeveloperKey:c,fileTypes:u,zIndex:f}).zIndex,fileTypes:n.fileTypes,clientId:n.googleDriveClientId.getOr(""),developerKey:n.googleDriveDeveloperKey.getOr(""),success:Wb(n.hotspot,n.fileTypes,n.maxImageDimension),failure:Gb(n.hotspot)}):"createFolder"===t.value&&Fv({title:"Create folder",lazySink:r,buttons:{submit:{text:"Submit",primary:!0},cancel:{text:"Cancel"}}},"Folder name",kv([Sv("Folder name cannot be empty."),Ov("Incorrect folder name.")])).map(Tv).get(function(e){e.each(function(e){var r;Du(o,(r=e,function(n,t,o){nu(t().path).fold(function(){o.mkdir(r).get(function(e){return e.fold(fu(n),function(e){return xu(n,t,o)})})},function(e){o.mkdir(r,e).get(function(e){return e.fold(fu(n),function(e){return xu(n,t,o)})})})}))}),ap.focus(o)})}),ct(e,Zr())})])])})},configFields:[tn("lazySink"),tn("maxImageDimension"),tn("dropboxAppKey"),tn("googleDriveDeveloperKey"),tn("googleDriveClientId"),tn("fileTypes"),tn("zIndex")]});(Rn=Zb=Zb||{}).Rename="rename",Rn.Download="download",Rn.Delete="delete",Rn.Star="star",Rn.Unstar="unstar";function tw(){return cp.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonIcon,bm.ButtonNaked],attributes:{title:"Close"}},buttonBehaviours:di([pp.config({})]),components:[ip.sketch({iconHtml:Mm,classes:[]})],action:function(e){Du(e,function(e,n,t){e({type:Wu.Exit,payload:{}})})}})}function ow(){return cp.sketch({dom:{tag:"button",classes:[bm.Button]},components:[sp("Insert")],action:function(e){return Du(e,function(e,n,t){e(Uh(n().preview.map(function(e){return[e.file]}).getOr([])))})},buttonBehaviours:di([pp.config({})])})}function rw(e,n,t){return cp.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonNaked,bm.ButtonIcon,bm.NavbarToolbarButton,bm.FocusStop],attributes:{title:e}},components:[ip.sketch({iconHtml:n})],action:t})}function iw(n){return function(e){return Du(e,n)}}function uw(e,n){return{dom:{tag:"div",classes:[bm.NavbarActions]},components:Zn([e.asSpec(),nw.sketch({maxImageDimension:n.maxImageDimension,dropboxAppKey:n.dropboxAppKey,googleDriveClientId:n.googleDriveClientId,googleDriveDeveloperKey:n.googleDriveDeveloperKey,lazySink:n.lazySink,fileTypes:n.fileTypes,zIndex:n.zIndex})],n.close?[tw()]:[]),behaviours:di([ap.config({})])}}function aw(e,n){return[e,{dom:{tag:"div",classes:[bm.NavbarToolbar]},components:n,behaviours:di([_f.config({mode:"flow",allowVertical:!1,selector:"."+bm.FocusStop}),pp.config({})])},{dom:{tag:"div",classes:[bm.NavbarActions]},components:[cp.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonSecondary]},buttonBehaviours:di([pp.config({})]),components:[sp("Unselect all")],action:iw(Yl())})]}]}function cw(e,n){return aw(n,[rw("Star",np,iw(function(e,n,t){var o=O(n().selectedFiles,function(e){return e.uuid});zy(o)(e,n,t)})),rw("Move",Jm,iw(Mh("move"))),rw("Download",Em,iw(function(e,n,t){k(n().selectedFiles,function(n){return n.url.each(function(e){return Eh(e,n.name)})}),e({type:Wu.DownloadFiles,payload:{}})})),rw("Delete",_m,function(n){Iv(e.lazySink).get(function(e){e&&Du(n,Hh())})})])}function sw(e){return[e,{dom:{tag:"div",classes:[bm.NavbarActions]},components:[cp.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonPrimary]},components:[sp("Place Here")],action:iw(function(n,t,o){t().clipboard.each(function(e){("move"===e.operation?Nh:Vh)(e)(n,t,o)})}),buttonBehaviours:di([pp.config({})])}),cp.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonSecondary]},components:[sp("Cancel")],action:iw(Ph()),buttonBehaviours:di([pp.config({})])})],behaviours:di([ap.config({})])}]}function fw(e,n,t,o){return[{dom:{tag:"div",classes:[bm.NavbarNav]},components:[cp.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonNaked,bm.ButtonIcon,bm.NavbarNavBack]},components:[ip.sketch({iconHtml:Fm})],action:function(e){Du(e,function(e,n,t){e({type:lu.Close,payload:{}})})},buttonBehaviours:di([pp.config({})])}),n.asSpec()]},{dom:{tag:"div",classes:[bm.NavbarActions]},components:Zn(Zn([],e.insert?[ow()]:[]),[_w.sketch({uid:t,lazySink:e.lazySink,file:o.file})])}]}function lw(e,o){return function(t){e.getOpt(t).each(function(e){var n=o||Qy.isInvalid(e)?go:vo;n(t.element,bm.SearchExpanded),n(e.element,bm.InputFieldSearchExpanded)})}}function dw(n){return function(e){n.getOpt(e).each(ap.focus)}}function mw(e){var n=e.selectedFiles.length,t=0!==n&&d(e.selectedFiles,function(e){return"directory"===e.type});return e.preview.isSome()?"preview":0<n&&e.clipboard.isNone()?t?"selectMixed":"select":e.clipboard.isSome()?e.clipboard.fold(function(){return"main"},function(e){return"copy"===e.operation?"copy":"move"}):e.query.isSome()?"search":"main"}function pw(e){return L(e.components(),function(e){return yo(e.element,bm.NavbarActions)}).each(function(e){B(e.components()).each(function(e){return Wa(e.element)})})}function gw(t,e,n){return{dom:{tag:"div",classes:[bm.Status,bm.StatusError]},components:[{dom:{tag:"p"},components:[sp(n)]},cp.sketch({dom:{tag:"button",classes:[bm.Button,bm.ButtonNaked,bm.ButtonIcon,bm.StatusDismiss]},components:[ip.sketch({iconHtml:Mm})],action:function(e){var n;Du(e,(n={type:cu.Remove,payload:{uid:t.uid}},function(e){return e(n)}))}})],behaviours:di([ss.config({})]),apis:{setNotifications:function(e,n){ss.set(e,[])}}}}function hw(e,n,t){var o,r,i,u,a,c,s,f,l,d;s=e,f=t,n.fileState.loading!==f.fileState.loading&&rb.loading(s,f.fileState.loading),o=e,r=n,u=(i=t).fileState.hash!==r.fileState.hash,a=i.listType!==r.listType,c=i.query.isSome(),s=0===i.path.length||c,f=tu(i.path,r.path),(u||a)&&(rb.setListMode(o,i.listType),f&&0<r.fileState.offset&&i.fileState.offset>r.fileState.offset?(r=i.fileState.files.slice(r.fileState.offset),rb.appendFiles(o,r,i.viewType,c)):rb.setFiles(o,i.fileState.files,i.viewType,s,c)),l=e,t.preview.fold(function(){return rb.showList(l)},function(){return rb.hideList(l)}),d=e,n=n,k((t=t).selectedFiles,function(e){return rb.selectFile(d,e)}),k(y(n.selectedFiles,t.selectedFiles),function(e){return rb.deselectFile(d,e)})}function vw(e){return void 0===(e=e.raw).touches||1!==e.touches.length?E.none():E.some(e.touches[0])}function yw(t){var r=kt(E.none()),o=kt(!1),i=ov(function(e){t.triggerEvent(qr(),e),o.set(!0)},400),u=ze([{key:hr(),value:function(n){return vw(n).each(function(e){i.cancel();e={x:e.clientX,y:e.clientY,target:n.target};i.schedule(n),o.set(!1),r.set(E.some(e))}),E.none()}},{key:vr(),value:function(e){return i.cancel(),vw(e).each(function(o){r.get().each(function(e){var n,t;n=o,t=e,e=Math.abs(n.clientX-t.x),t=Math.abs(n.clientY-t.y),(5<e||5<t)&&r.set(E.none())})}),E.none()}},{key:yr(),value:function(n){i.cancel();return r.get().filter(function(e){return tt(e.target,n.target)}).map(function(e){return o.get()?(n.prevent(),!1):t.triggerEvent(Kr(),n)})}}]);return{fireIfReady:function(n,e){return ae(u,e).bind(function(e){return e(n)})}}}function bw(e){var n;return e.raw.which===ps[0]&&!S(["input","textarea"],Ct(e.target))&&(e=e.target,!Vc(e,'[contenteditable="true"]',n).isSome())}function ww(){return pr().browser.isFirefox()}function xw(n,e){var t,o=Qe("Getting GUI events settings",Rw,e),r=yw(o),i=O(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(e){return Ho(n,e,function(n){r.fireIfReady(n,e).each(function(e){e&&n.kill()}),o.triggerEvent(e,n)&&n.kill()})}),u=kt(E.none()),a=Ho(n,"paste",function(n){r.fireIfReady(n,"paste").each(function(e){e&&n.kill()}),o.triggerEvent("paste",n)&&n.kill(),u.set(E.some(setTimeout(function(){o.triggerEvent(Ur(),n)},0)))}),c=Ho(n,"keydown",function(e){o.triggerEvent("keydown",e)?e.kill():!0===o.stopBackspace&&bw(e)&&e.prevent()}),s=(t=n,e=function(e){o.triggerEvent("focusin",e)&&e.kill()},ww()?Uo(t,"focus",e):Ho(t,"focusin",e)),f=kt(E.none()),l=(t=n,e=function(e){o.triggerEvent("focusout",e)&&e.kill(),f.set(E.some(setTimeout(function(){o.triggerEvent(Hr(),e)},0)))},ww()?Uo(t,"blur",e):Ho(t,"focusout",e));return{unbind:function(){k(i,function(e){e.unbind()}),c.unbind(),s.unbind(),l.unbind(),a.unbind(),u.get().each(clearTimeout),f.get().each(clearTimeout)}}}function Sw(e,n){return n=ae(e,"target").getOr(n),kt(n)}function Ow(e,o,n,t,r,i){var u,a,e=e(o,t),c=(n=n,r=r,u=kt(!1),a=kt(!1),{stop:function(){u.set(!0)},cut:function(){a.set(!0)},isStopped:u.get,isCut:a.get,event:n,setSource:r.set,getSource:r.get});return e.fold(function(){return i.logEventNoHandlers(o,t),Hw.complete()},function(n){var t=n.descHandler;return ro(t)(c),c.isStopped()?(i.logEventStopped(o,n.element,t.purpose),Hw.stopped()):c.isCut()?(i.logEventCut(o,n.element,t.purpose),Hw.complete()):Dt(n.element).fold(function(){return i.logNoParent(o,n.element,t.purpose),Hw.complete()},function(e){return i.logEventResponse(o,n.element,t.purpose),Hw.resume(e)})})}function kw(e,n,t){var o,r=(n=n,o=kt(!1),{stop:function(){o.set(!0)},cut:b,isStopped:o.get,isCut:s,event:n,setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")});return k(e,function(e){e=e.descHandler;ro(e)(r)}),r.isStopped()}function Cw(){var u={};return{registerId:function(r,i,e){te(e,function(e,n){var t,o=void 0!==u[n]?u[n]:{};o[i]=(t=r,{cHandler:f.apply(void 0,[(e=e).handler].concat(t)),purpose:e.purpose}),u[n]=o})},unregisterId:function(t){te(u,function(e,n){e.hasOwnProperty(t)&&delete e[t]})},filterByType:function(e){return ae(u,e).map(function(e){return ie(e,function(e,n){return{id:n,descHandler:e}})}).getOr([])},find:function(e,n,t){var r=ae(u,n);return bn(t,function(e){return t=r,Xt(o=e).fold(function(){return E.none()},function(n){return t.bind(function(e){return ae(e,n)}).map(function(e){return{element:o,descHandler:e}})});var t,o},e)}}}function Lw(){function t(e){var n=e.element;return Xt(n).fold(function(){return function(e,n){e=Yt(Ei+e);return zi(n,e),e}("uid-",e.element)},function(e){return e})}var o=Cw(),r={},i=function(e){Xt(e.element).each(function(e){delete r[e],o.unregisterId(e)})};return{find:function(e,n,t){return o.find(e,n,t)},filter:function(e){return o.filterByType(e)},register:function(e){var n=t(e);ce(r,n)&&function(e,n){var t=r[n];if(t!==e)throw new Error('The tagId "'+n+'" is already used by: '+Jt(t.element)+"\nCannot use it for: "+Jt(e.element)+"\nThe conflicting element is"+(ji(t.element)?" ":" not ")+"already in the DOM");i(e)}(e,n),o.registerId([e],n,e.events),r[n]=e},unregister:i,getById:function(e){return ae(r,e)}}}function Fw(e){var n,t=(n=Ji(mc.sketch({dom:{tag:"div"}})),Ww(n));return go(t.element,bm.AssetmanagerRoot),go(t.element,bm.Wrap),e.fold(function(){return go(So(),Vw),ja(So(),t),$.value(t)},function(e){var n=Nc(So(),e);return $.fromOption(n,"Failed to find target by selector: "+e).map(function(e){return ja(e,t),t})})}var Tw,Dw,Bw,Mw,Iw,_w=e({name:"PreviewDropdown",factory:function(r){var t=Yt("menu");return By.sketch({uid:r.uid,dom:{tag:"button",classes:[bm.Button,bm.ButtonSecondary,bm.ButtonIcon],attributes:{title:"Actions"}},components:[ip.sketch({iconHtml:Zm})],toggleClass:bm.ButtonSelected,parts:{menu:My},lazySink:r.lazySink,matchWidth:!0,dropdownBehaviours:di([pp.config({}),mp.config({store:{mode:"memory",initialValue:r.file.starred}})]),fetch:function(e){e=mp.getValue(e);return $u(E.some(lh.singleData("basic-list",{uid:t,dom:{tag:"div",classes:[bm.Menu,bm.MenuHasIcons]},components:[uh.parts.items({})],items:h([[qb(Xm,"Rename",Zb.Rename)],e?[qb(tp,"Unstar",Zb.Unstar)]:[qb(np,"Star",Zb.Star)],[qb(Em,"Download",Zb.Download)],[qb(_m,"Delete",Zb.Delete)]])})))},onExecute:function(e,n){n=mp.getValue(n);st(e,t+"execute-event",{item:n})},onOpen:Ch(t),sandboxBehaviours:di([Ot("dropdown-sandbox-events",[dt(t+"execute-event",function(e,n){var t,n=n.event.item,o=mp.getValue(e);n.value===Zb.Rename?(t=Ml(r.file.name),Dv(r.lazySink,Bl(r.file.name,t)).get(function(e){e.each(function(e){Du(o,zh(r.file.uuid,e+t))}),ap.focus(o)})):n.value===Zb.Download?(Du(o,Ah(r.file.url,r.file.name)),ap.focus(o)):n.value===Zb.Delete?Mv(r.lazySink).get(function(e){e?Du(o,Rh(r.file.uuid)):ap.focus(o)}):n.value===Zb.Star?(Du(o,zy([r.file.uuid])),ap.focus(o)):n.value===Zb.Unstar&&(Du(o,Py([r.file.uuid])),ap.focus(o)),ct(e,Zr())})])])})},configFields:[tn("uid"),tn("lazySink"),tn("file")],apis:{setStarred:function(e,n,t){mp.setValue(n,t)}}}),Ew=e({name:"SearchBox",factory:function(e){var t=Lc({dom:{tag:"span",classes:[bm.SearchErrorMsg],innerHtml:"Use at least 3 characters"}}),o=Lc(Sp.sketch({inputAttributes:{type:"search",placeholder:"Search"},inputClasses:[bm.InputField,bm.InputFieldSearch],inputBehaviours:di([pp.config({}),Qy.config({invalidClass:"tam-invalid-input",notify:{onInvalid:function(n){r.getOpt(n).each(function(e){t.getOpt(n).fold(function(){ss.append(e,t.asSpec())},b)})},onValid:function(e){r.getOpt(e).each(function(n){t.getOpt(e).each(function(e){ss.remove(n,e)})})}},validator:{validate:function(e){e=mp.getValue(e);return 0===e.length||3<=e.length?na.pure(e):na.error("You need to enter at least 3 characters")},validateOnLoad:!1}})])})),r=Lc({uid:e.uid,dom:{tag:"div",classes:[bm.Search]},components:[o.asSpec(),ip.sketch({iconHtml:$m,classes:[bm.SearchIcon]})],behaviours:Fe(di([ss.config({}),_f.config({mode:"special",onEnter:function(n){return o.getOpt(n).each(function(e){!1===Qy.isInvalid(e)&&(e=mp.getValue(e),Du(n,ku(e)))}),E.some(!0)}}),Ot("searchbox-expanding",[dt(Cr(),lw(o,!0)),dt(Lr(),lw(o,!1)),dt(Br(),dw(o)),dt(hr(),dw(o))]),Ot("searchbox-input",[dt(Dr(),function(t){o.getOpt(t).each(function(e){var n=mp.getValue(e);!1===Qy.isInvalid(e)&&""===n&&Du(t,ku(n))})})])]),Aa(e.searchBoxBehaviours)),apis:{setValue:function(e,n){o.getOpt(e).each(function(e){mp.setValue(e,n)})},focus:function(e){o.getOpt(e).each(function(e){ap.focus(e)})}}});return r.asSpec()},configFields:[P("searchBoxBehaviours",[])],apis:{setValue:function(e,n,t){e.setValue(n,t)},focus:function(e,n){e.focus(n)}}}),Aw=In(((In={}).main=bm.NavbarMainMode,In.copy=bm.NavbarCopyMode,In.move=bm.NavbarMoveMode,In.select=bm.NavbarSelectMode,In.selectMixed=bm.NavbarSelectMode,In.search=bm.NavbarMainMode,In.preview=bm.NavbarMainMode,In.none=bm.NavbarMainMode,In)),zw=e({name:"NavBar",factory:function(a){function c(n,e,t,o){var r,i,u;"select"===e?ss.set(n,cw(a,m)):"selectMixed"===e?ss.set(n,(u=a,aw(m,[rw("Move",Jm,iw(Mh("move"))),rw("Delete",_m,function(n){Iv(u.lazySink).get(function(e){e&&Du(n,Hh())})})]))):"main"===e?(r=a,i=d,i=[f.asSpec(),uw(i,r)],"search"===t?ss.replaceAt(n,0,B(i)):ss.set(n,i)):"search"===e?(r=d,i=a,i=[{dom:{tag:"div",classes:[bm.NavbarContainer]},components:[{dom:{tag:"div",classes:[bm.Location,bm.LocationSearchResult]},components:[ip.sketch({iconHtml:Qm,classes:[bm.LocationIcon]}),{dom:{tag:"span",classes:[bm.LocationLabel],innerHtml:"Search results"}}]}]},uw(r,i)],"main"===t?ss.replaceAt(n,0,B(i)):ss.set(n,i)):"move"===e||"copy"===e?ss.set(n,sw(m)):"preview"===e&&o.each(function(e){return ss.set(n,fw(a,l,s,e))})}var e,s=Yt("preview"),f=Lc(wb.sketch({separator:function(){return ip.sketch({iconHtml:Bm,classes:[bm.BreadcrumbSeparator]})},lazySink:a.lazySink})),t=Lc(lp.sketch({text:""})),l=Lc(lp.sketch({text:"",classes:[bm.NavbarNavFilename]})),d=Lc(Ew.sketch({})),m={dom:{tag:"div",classes:[bm.Breadcrumb]},components:[t.asSpec()]};return{uid:a.uid,dom:{tag:"div",classes:[bm.Navbar]},behaviours:Fe(di([ss.config({}),pc.config({channels:((e={})["channel.main"]=Tu(function(o,n){var e=n.state,t=mw(n.state),r=mw(n.oldState);zw.setMode(o,t,r,e.preview),e.preview.each(function(e){zw.setFileName(o,e.file.name,e.file.starred)}),"select"===t||"selectMixed"===t?zw.setText(o,e.selectedFiles.length+" Selected"):"copy"!==t&&"move"!==t||e.clipboard.each(function(e){var n,t;zw.setText(o,(t=(n=e).files.length,e=n.files[0].name,"move"===n.operation?1===t?'Move "'+e+'"':"Move "+t+" Items":1===t?'Copy "'+n.files[0].name+'"':"Copy "+t+" Items"))}),f.getOpt(o).each(function(e){wb.setItems(e,n.state.path,n.state.viewType)}),d.getOpt(o).each(function(n){e.query.each(function(e){return Ew.setValue(n,e)})})}),e)})]),Aa(a.navBarBehaviours)),components:[],apis:{setBreadcrumbs:function(e,n,t){f.getOpt(e).each(function(e){wb.setItems(e,n,t)})},setMode:function(r,i,u,a){u!==i&&(Aw(r.element,i),Ka(r.element).fold(function(){c(r,i,u,a),"preview"===i&&pw(r)},function(o){f.getOpt(r).fold(function(){var n,e,t;c(r,i,u,a),n=r,t=o,"select"===(e=i)||"selectMixed"===e||("main"===e?d.getOpt(n).each(function(e){rt(e.element,t)?Ew.focus(e):f.getOpt(n).each(function(e){ap.focus(e)})}):"search"===e?d.getOpt(n).each(Ew.focus):"move"!==e&&"copy"!==e&&"preview"!==e||pw(n))},function(e){c(r,i,u,a),rt(e.element,o)&&ap.focus(e)})}))},setText:function(e,n){t.getOpt(e).each(function(e){lp.setText(e,n)})},setFileName:function(e,n,t){l.getOpt(e).each(function(e){lp.setText(e,n,t)}),e.getSystem().getByUid(s).each(function(e){_w.setStarred(e,t)})}}}},configFields:[P("navBarBehaviours",[]),tn("lazySink"),tn("dropboxAppKey"),tn("maxImageDimension"),tn("googleDriveDeveloperKey"),tn("googleDriveClientId"),tn("fileTypes"),rn("zIndex"),an("insert"),an("close")],apis:{setBreadcrumbs:function(e,n,t,o){e.setBreadcrumbs(n,t,o)},setMode:function(e,n,t,o,r){e.setMode(n,t,o,r)},setText:function(e,n,t){e.setText(n,t)},setFileName:function(e,n,t,o){e.setFileName(n,t,o)}}}),Pw=e({name:"Notifications",factory:function(e){return{uid:e.uid,dom:{tag:"div",classes:[bm.Notifications]},components:[],behaviours:Fe(di([ss.config({})]),Aa(e.notificationBehaviours)),apis:{setNotifications:function(e,n){n=O(n,function(e){return gw(e.data,e.status,e.text)});ss.set(e,n)}}}},configFields:[P("notificationBehaviours",[])],apis:{setNotifications:function(e,n,t){e.setNotifications(n,t)}}}),Nw=e({name:"MainView",factory:function(c){var e,s=Yt("preview"),n=Yt("upload"),t=Lc(dp.sketch({})),f=Lc(mc.sketch({dom:{classes:[bm.AssetmanagerContainer],styles:{}},components:[zw.sketch({maxImageDimension:c.maxImageDimension,dropboxAppKey:c.dropboxAppKey,googleDriveDeveloperKey:c.googleDriveDeveloperKey,googleDriveClientId:c.googleDriveClientId,lazySink:c.lazySink,fileTypes:c.fileTypes,zIndex:c.zIndex,insert:c.close&&c.insert,close:c.close,navBarBehaviours:di([Ot("navbar",[ui(function(e){zw.setMode(e,"main","none",E.none())})])])}),Pw.sketch({notificationBehaviours:di([pc.config({channels:((e={})["channel.main"]=Tu(function(e,n){y(n.oldState.notifications,n.state.notifications)&&Pw.setNotifications(e,n.state.notifications)}),e)})])}),rb.sketch({insert:c.close&&c.insert,lazySink:c.lazySink,fileListBehaviours:di([pc.config({channels:((e={})["channel.main"]=Tu(function(e,n){return hw(e,n.oldState,n.state),0}),e)})])})],containerBehaviours:di([ss.config({}),Ef.config({mode:"drop",onDragenter:function(e){t.getOpt(e).isNone()&&ss.append(e,t.asSpec())},onDrop:function(n,e){t.getOpt(n).each(function(e){ss.remove(n,e)});e=Hl(e.files);Du(n,Ul(e,c.fileTypes,c.maxImageDimension))},onDragleave:function(n,e){yo(e.event.target,bm.DropAreaShim)&&t.getOpt(n).each(function(e){ss.remove(n,e)})}})])}));return{uid:c.uid,dom:{tag:"div",classes:(e=c.renderMode,h([[bm.Assetmanager,bm.AssetmanagerOpen],"modal"===e?[bm.AssetmanagerModal]:[],"fullscreen"===e?[bm.AssetmanagerFullscreen]:[]])),styles:{"z-index":String(c.zIndex)}},components:[f.asSpec()],behaviours:Fe(di([_f.config({mode:"cyclic"}),ss.config({}),pc.config({channels:((e={})["channel.main"]=Tu(function(a,e){e.state.preview.fold(function(){var e,t,n;t=f,n=s,(e=a).getSystem().getByUid(n).each(function(n){t.getOpt(e).each(function(e){ss.remove(e,n)})})},function(e){var n,t,o,r,i,u;n=a,t=e.file,o=e.meta,r=f,i=s,u=c.baseUrl,n.getSystem().getByUid(i).fold(function(){r.getOpt(n).each(function(e){ss.append(e,mb.sketch({baseUrl:u,uid:i,file:t,meta:o}))})},b)}),0!==e.state.selectedFiles.length?ds.on(a):ds.off(a),Sy(a,e.state,f,n)}),e)}),ds.config({toggleClass:bm.AssetmanagerHasToolbar,toggleOnExecute:!1})]),Aa(c.mainViewBehaviours))}},configFields:[hn("zIndex",1),P("mainViewBehaviours",[]),cn("lazySink"),pn("styles",{}),pn("maxImageDimension",E.none()),tn("dropboxAppKey"),tn("googleDriveDeveloperKey"),tn("googleDriveClientId"),tn("fileTypes"),an("insert"),an("close"),(Dw=["inline","fullscreen","modal"],Fn(Tw="renderMode",Tw,Be(),nn(Dw))),un("baseUrl")]}),Vw=bm.AssetmanagerBody,Rw=Ge([cn("triggerEvent"),pn("stopBackspace",!0)]),Hw=ke([{stopped:[]},{resume:["element"]},{complete:[]}]),Uw=function(n,t,o,e,r,i){return Ow(n,t,o,e,r,i).fold(x,function(e){return Uw(n,t,o,e,r,i)},s)},jw=function(e,n,t,o,r){var i=Sw(t,o);return Uw(e,n,t,o,i,r)},Ww=function(t){function o(n){return Dt(t.element).fold(x,function(e){return tt(n,e)})}function c(e,n){return i.find(o,e,n)}function r(n){var e=i.filter(jr());k(e,function(e){e=e.descHandler;ro(e)(n)})}var i=Lw(),e=xw(t.element,{triggerEvent:function(t,o){return da(t,o.target,function(e){return n=e,jw(c,t,e=o,e.target,n);var n})}}),u={debugInfo:w("real"),triggerEvent:function(n,t,o){da(n,t,function(e){return jw(c,n,o,t,e)})},triggerFocus:function(u,a){Xt(u).fold(function(){Wa(u)},function(e){da(Rr(),u,function(e){var n,t,o,r,i;return n=c,t=Rr(),i=e,e=Sw(o={originator:a,kill:b,prevent:b,target:u},r=u),Ow(n,t,o,r,e,i),!1})})},triggerEscape:function(e,n){u.triggerEvent("keydown",e.element,n.event)},getByUid:function(e){return p(e)},getByDom:function(e){return g(e)},build:Ji,addToGui:function(e){s(e)},removeFromGui:function(e){f(e)},addToWorld:function(e){n(e)},removeFromWorld:function(e){a(e)},broadcast:function(e){l(e)},broadcastOn:function(e,n){d(e,n)},broadcastEvent:function(e,n){m(e,n)},isConnected:x},n=function(e){e.connect(u),bi(e.element)||(i.register(e),k(e.components(),n),u.triggerEvent(Jr(),e.element,{target:e.element}))},a=function(e){bi(e.element)||(k(e.components(),a),i.unregister(e)),e.disconnect()},s=function(e){Va(t,e)},f=function(e){Ha(e)},l=function(e){r({universal:!0,data:e})},d=function(e,n){r({universal:!1,channels:e,data:n})},m=function(e,n){e=i.filter(e);return kw(e,n)},p=function(e){return i.getById(e).fold(function(){return $.error(new Error('Could not find component with uid: "'+e+'" in system.'))},$.value)},g=function(e){e=Xt(e).getOr("not found");return p(e)};return n(t),{root:t,element:t.element,destroy:function(){e.unbind(),Ti(t.element)},add:s,remove:f,getByUid:p,getByDom:g,addToWorld:n,removeFromWorld:a,broadcast:l,broadcastOn:d,broadcastEvent:m}};Bw=Bu(),Iw=function(e,n,o){var t,r=Fw(n.target).getOrDie(),i=Mu(fa,(h=n.fileTypes,{fileState:{offset:0,complete:!0,loading:"done",files:[],hash:""},selectedFiles:[],sortBy:"name",sortOrder:"asc",upload:{lastUpdate:E.none(),files:[]},viewType:"all",listType:"list",notifications:[],path:[],clipboard:E.none(),preview:E.none(),query:E.none(),fileTypes:h}),e,function(e,n,t){t.type===Wu.Exit?o([]):t.type===Gu.InsertFiles?o(t.payload.files):(t="channel.main",e=e,n=n,r.broadcastOn([t],{state:e,oldState:n}))}),u=Ho(Wn.fromDom(document),"mousedown",function(e){0===e.raw.button&&r.broadcastOn(["dismiss.popups"],{target:e.target})}),a=(t=i,Ji(mc.sketch({dom:{tag:"div",styles:{position:"relative","z-index":"10000000000"},classes:[bm.AssetmanagerAux]},containerBehaviours:di([Zg.config({useFixed:x}),Ot("mainevents",[dt("action",function(e,n){n=n.event.data;t.dispatch(n)})])])})));r.add(a);var c=n.zIndex,s=n.maxImageDimension,f=n.googleDriveClientId,l=n.googleDriveDeveloperKey,d=n.dropboxAppKey,m=n.fileTypes,p=n.target,g=n.insert,h=n.close,e=n.fullscreen,n=n.baseUrl,e=Nw.sketch({lazySink:function(){return $.value(a)},zIndex:c,maxImageDimension:s,dropboxAppKey:d,googleDriveDeveloperKey:l,googleDriveClientId:f,fileTypes:m,insert:g,close:h,baseUrl:n,renderMode:(p=p.isSome(),e=e,p?"inline":e?"fullscreen":"modal"),mainViewBehaviours:di([Ot("mainevents",[ui(function(){var e,n;i.dispatch(Fu((n=["directory","image","video","audio"],v(e=m,function(e){return S(n,e)})&&0<e.length?"grid":"list")))}),ai(function(){u.unbind()}),dt("action",function(e,n){n=n.event.data;i.dispatch(n)})])])});return r.add(Ji(e)),function(){vo(So(),Vw),r.destroy()}},j(Bw[Mw="_assetManagerProvider"])?Bw[Mw]=Iw:Hu("Property "+Mw+" is already defined in the given namespace")}();